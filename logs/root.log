2025-03-08 13:39:16,533 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:44:36,532 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:44:36,533 - trading_system - INFO - Starting in backtest mode
2025-03-08 13:48:27,088 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:48:27,089 - trading_system - INFO - Starting in backtest mode
2025-03-08 13:48:27,114 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 13:48:27,115 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 13:51:00,585 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:51:00,590 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 13:51:00,590 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 13:52:15,727 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:52:15,737 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 13:52:15,738 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 13:52:49,878 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:52:49,885 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 13:52:49,886 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 13:52:49,888 - trading_system - INFO - Available trading modes: {'backtest': '历史数据回测', 'paper': '模拟交易（使用真实市场数据但不使用真实资金）', 'live': '实盘交易（在交易所使用真实资金）', 'custom_mode': '自定义交易模式'}Trading core initialized | Mode: unknown | Version: Starting in backtest mode
2025-03-08 13:53:30,513 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 13:53:30,517 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 13:53:30,517 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 13:53:30,518 - trading_system - INFO - Available trading modes: {'backtest': '历史数据回测', 'paper': '模拟交易（使用真实市场数据但不使用真实资金）', 'live': '实盘交易（在交易所使用真实资金）', 'custom_mode': '自定义交易模式'}Trading core initialized | Mode: unknown | Version: Starting in backtest mode
2025-03-08 14:03:23,574 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:03:23,622 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:03:23,623 - trading_system - INFO - Trading system initializing...
2025-03-08 14:03:23,624 - AsyncExecutor - ERROR - Error in task task_2959339699424_0: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 36, in async_main
    available_modes = TradingModeFactory.get_available_modes()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
2025-03-08 14:03:23,629 - AsyncExecutor - ERROR - Error during execution: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 153, in run
    return loop.run_until_complete(self.submit(wrapper))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 36, in async_main
    available_modes = TradingModeFactory.get_available_modes()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
2025-03-08 14:05:17,202 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:05:17,236 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:05:17,237 - trading_system - INFO - Trading system initializing...
2025-03-08 14:05:17,238 - AsyncExecutor - ERROR - Error in task task_2229091415552_0: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 36, in async_main
    available_modes = TradingModeFactory.get_available_modes()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
2025-03-08 14:05:17,241 - AsyncExecutor - ERROR - Error during execution: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 153, in run
    return loop.run_until_complete(self.submit(wrapper))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 36, in async_main
    available_modes = TradingModeFactory.get_available_modes()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: TradingModeFactory.get_available_modes() missing 1 required positional argument: 'self'
2025-03-08 14:05:51,387 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:05:51,424 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:05:51,424 - trading_system - INFO - Trading system initializing...
2025-03-08 14:05:51,430 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:05:51,432 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:05:51,433 - trading_system - INFO - Available trading modes: {'backtest': '历史数据回测', 'paper': '模拟交易（使用真实市场数据但不使用真实资金）', 'live': '实盘交易（在交易所使用真实资金）', 'custom_mode': '自定义交易模式'}Trading core initialized | Mode: unknown | Version: Starting in backtest mode
2025-03-08 14:05:51,433 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:05:51,434 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:05:51,435 - trading_system - ERROR - Error in trading pipeline: 'TradingModeFactory' object has no attribute 'create_mode'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 61, in run_pipeline
    self.trading_mode = await self.mode_factory.create_mode(self.mode)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'TradingModeFactory' object has no attribute 'create_mode'
2025-03-08 14:05:51,437 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:05:51,438 - AsyncExecutor - ERROR - Error in task task_1843625833504_0: 'str' object has no attribute 'shutdown'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 40, in async_main
    result = await core.run_pipeline()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\core\core.py", line 76, in run_pipeline
    await self.shutdown()
  File "D:\jacky\crypto_py\src\core\core.py", line 88, in shutdown
    await self.trading_mode.shutdown()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shutdown'
2025-03-08 14:05:51,439 - AsyncExecutor - ERROR - Error during execution: 'str' object has no attribute 'shutdown'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 153, in run
    return loop.run_until_complete(self.submit(wrapper))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 40, in async_main
    result = await core.run_pipeline()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\core\core.py", line 76, in run_pipeline
    await self.shutdown()
  File "D:\jacky\crypto_py\src\core\core.py", line 88, in shutdown
    await self.trading_mode.shutdown()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shutdown'
2025-03-08 14:06:40,167 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:06:40,202 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:06:40,204 - trading_system - INFO - Trading system initializing...
2025-03-08 14:06:40,209 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:06:40,210 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:06:40,211 - trading_system - INFO - Available trading modes: {'backtest': '历史数据回测', 'paper': '模拟交易（使用真实市场数据但不使用真实资金）', 'live': '实盘交易（在交易所使用真实资金）', 'custom_mode': '自定义交易模式'}Trading core initialized | Mode: unknown | Version: Starting in backtest mode
2025-03-08 14:06:40,211 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:06:40,212 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:06:40,212 - trading_system - ERROR - Error in trading pipeline: 'TradingModeFactory' object has no attribute 'create_mode'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 61, in run_pipeline
    self.trading_mode = await self.mode_factory.create_mode(self.mode)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'TradingModeFactory' object has no attribute 'create_mode'
2025-03-08 14:06:40,214 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:06:40,215 - AsyncExecutor - ERROR - Error in task task_3056431330336_0: 'str' object has no attribute 'shutdown'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 40, in async_main
    result = await core.run_pipeline()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\core\core.py", line 76, in run_pipeline
    await self.shutdown()
  File "D:\jacky\crypto_py\src\core\core.py", line 88, in shutdown
    await self.trading_mode.shutdown()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shutdown'
2025-03-08 14:06:40,217 - AsyncExecutor - ERROR - Error during execution: 'str' object has no attribute 'shutdown'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 153, in run
    return loop.run_until_complete(self.submit(wrapper))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\bin\main.py", line 40, in async_main
    result = await core.run_pipeline()
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\core\core.py", line 76, in run_pipeline
    await self.shutdown()
  File "D:\jacky\crypto_py\src\core\core.py", line 88, in shutdown
    await self.trading_mode.shutdown()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'shutdown'
2025-03-08 14:08:55,489 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:08:55,538 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:08:55,539 - trading_system - INFO - Trading system initializing...
2025-03-08 14:08:55,547 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:08:55,548 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:08:55,549 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:08:55,550 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:08:55,551 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:08:55,551 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:08:55,553 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:08:55,554 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:08:55,555 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:08:56,536 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:08:56,540 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:08:56,541 - system.strategyfactory - INFO - 自动注册 example_strategy (src.strategy.strategy_factory.ExampleStrategy)
2025-03-08 14:08:56,547 - system.strategyfactory - WARNING - 加载模块 src.strategy.strategy_loader 时出错: No module named 'strategy'
2025-03-08 14:08:56,549 - system.strategyfactory - INFO - 自动发现完成，注册了 3 个项目
2025-03-08 14:08:56,550 - system.tradingmodefactory - ERROR - 创建 backtest 失败: Can't instantiate abstract class BaseRiskManager with abstract methods check_position_limits, execute_risk_control, validate_signals
2025-03-08 14:08:56,550 - system.tradingmodefactory - ERROR - 创建失败: 创建 backtest 失败: Can't instantiate abstract class BaseRiskManager with abstract methods check_position_limits, execute_risk_control, validate_signals
2025-03-08 14:08:56,551 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: Can't instantiate abstract class BaseRiskManager with abstract methods check_position_limits, execute_risk_control, validate_signals
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 213, in _get_or_create
    instance = class_type(self.config, merged_params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 49, in __init__
    self.risk_manager = risk_manager or self._create_risk_manager()
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 84, in _create_risk_manager
    return BaseRiskManager(config=self.config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Can't instantiate abstract class BaseRiskManager with abstract methods check_position_limits, execute_risk_control, validate_signals

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: Can't instantiate abstract class BaseRiskManager with abstract methods check_position_limits, execute_risk_control, validate_signals
2025-03-08 14:08:56,554 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:08:56,555 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 14:08:56,555 - AsyncExecutor - INFO - Task task_1869352268672_0 cancelled
2025-03-08 14:08:56,557 - AsyncExecutor - INFO - Task task_1869352268672_0 was cancelled
2025-03-08 14:19:53,237 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:19:53,279 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:19:53,280 - trading_system - INFO - Trading system initializing...
2025-03-08 14:19:53,289 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:19:53,291 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:19:53,293 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:19:53,294 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:19:53,295 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:19:53,297 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:19:53,298 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:19:53,300 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:19:53,302 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:19:54,010 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:19:54,024 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:19:54,025 - system.strategyfactory - INFO - 自动注册 example_strategy (src.strategy.strategy_factory.ExampleStrategy)
2025-03-08 14:19:54,026 - system.strategyfactory - WARNING - 加载模块 src.strategy.strategy_loader 时出错: No module named 'strategy'
2025-03-08 14:19:54,028 - system.strategyfactory - INFO - 自动发现完成，注册了 3 个项目
2025-03-08 14:19:54,030 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:19:54,031 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:19:54,032 - system.strategyfactory - ERROR - 创建失败: 未知类型: simple
2025-03-08 14:19:54,033 - system.tradingmodefactory - ERROR - 创建 backtest 失败: 未知类型: simple
2025-03-08 14:19:54,034 - system.tradingmodefactory - ERROR - 创建失败: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:19:54,035 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知类型: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 61, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:19:54,039 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:19:54,040 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 14:19:54,041 - AsyncExecutor - INFO - Task task_2234421933088_0 cancelled
2025-03-08 14:19:54,044 - AsyncExecutor - INFO - Task task_2234421933088_0 was cancelled
2025-03-08 14:22:20,796 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:22:20,832 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:22:20,833 - trading_system - INFO - Trading system initializing...
2025-03-08 14:22:20,842 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:22:20,842 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:22:20,843 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:22:20,843 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:22:20,844 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:22:20,844 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:22:20,844 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:22:20,845 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:22:20,846 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:22:21,333 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:22:21,336 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:22:21,336 - system.strategyfactory - INFO - 自动注册 example_strategy (src.strategy.strategy_factory.ExampleStrategy)
2025-03-08 14:22:21,339 - system.strategyfactory - WARNING - 加载模块 src.strategy.strategy_loader 时出错: No module named 'strategy'
2025-03-08 14:22:21,340 - system.strategyfactory - INFO - 自动发现完成，注册了 3 个项目
2025-03-08 14:22:21,340 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:22:21,341 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:22:21,341 - system.strategyfactory - ERROR - 创建失败: 未知类型: simple
2025-03-08 14:22:21,342 - system.tradingmodefactory - ERROR - 创建 backtest 失败: 未知类型: simple
2025-03-08 14:22:21,342 - system.tradingmodefactory - ERROR - 创建失败: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:22:21,342 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知类型: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 61, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:22:21,345 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:22:21,345 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 14:22:21,348 - AsyncExecutor - INFO - Task task_1826998645792_0 cancelled
2025-03-08 14:22:21,350 - AsyncExecutor - INFO - Task task_1826998645792_0 was cancelled
2025-03-08 14:23:40,033 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:23:40,069 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:23:40,070 - trading_system - INFO - Trading system initializing...
2025-03-08 14:23:40,077 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:23:40,077 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:23:40,078 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:23:40,079 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:23:40,079 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:23:40,081 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:23:40,082 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:23:40,083 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:23:40,084 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:23:40,577 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:23:40,580 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:23:40,581 - system.strategyfactory - INFO - 自动注册 example_strategy (src.strategy.strategy_factory.ExampleStrategy)
2025-03-08 14:23:40,583 - system.strategyfactory - WARNING - 加载模块 src.strategy.strategy_loader 时出错: No module named 'strategy'
2025-03-08 14:23:40,584 - system.strategyfactory - INFO - 自动发现完成，注册了 3 个项目
2025-03-08 14:23:40,586 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:23:40,587 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:23:40,588 - system.strategyfactory - ERROR - 创建失败: 未知类型: simple
2025-03-08 14:23:40,588 - system.tradingmodefactory - ERROR - 创建 backtest 失败: 未知类型: simple
2025-03-08 14:23:40,589 - system.tradingmodefactory - ERROR - 创建失败: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:23:40,589 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知类型: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 61, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知类型: simple
2025-03-08 14:23:40,594 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:23:40,595 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 14:23:40,596 - AsyncExecutor - INFO - Task task_2641911608032_0 cancelled
2025-03-08 14:23:40,599 - trading_system - INFO - Shutting down trading system...
2025-03-08 14:23:40,600 - AsyncExecutor - INFO - Task task_2641911608032_0 was cancelled
2025-03-08 14:28:24,461 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:28:24,532 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:28:24,532 - trading_system - INFO - Trading system initializing...
2025-03-08 14:28:24,540 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:28:24,541 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:28:24,541 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:28:24,542 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:28:24,542 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:28:24,543 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:28:24,544 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:28:24,545 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:28:24,545 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:28:25,164 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:28:25,167 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:28:25,167 - system.strategyfactory - INFO - 自动注册 example_strategy (src.strategy.strategy_factory.ExampleStrategy)
2025-03-08 14:28:25,171 - system.strategyfactory - WARNING - 加载模块 src.strategy.strategy_loader 时出错: No module named 'strategy'
2025-03-08 14:28:25,173 - system.strategyfactory - INFO - 自动发现完成，注册了 3 个项目
2025-03-08 14:28:25,175 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:28:25,176 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:28:25,186 - system.strategyfactory - INFO - 创建新的 dual_ma 实例
2025-03-08 14:28:25,187 - system.strategyfactory - ERROR - 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
2025-03-08 14:28:25,188 - system.strategyfactory - ERROR - 创建失败: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
2025-03-08 14:28:25,189 - system.tradingmodefactory - ERROR - 创建 backtest 失败: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
2025-03-08 14:28:25,190 - system.tradingmodefactory - ERROR - 创建失败: 创建 backtest 失败: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
2025-03-08 14:28:25,191 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 213, in _get_or_create
    instance = class_type(self.config, merged_params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 创建 dual_ma 失败: Can't instantiate abstract class DualMAStrategy with abstract method _generate_signals
2025-03-08 14:28:25,195 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:28:25,195 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 14:28:25,197 - AsyncExecutor - INFO - Task task_3012377244544_0 cancelled
2025-03-08 14:28:25,199 - trading_system - INFO - Shutting down trading system...
2025-03-08 14:28:25,199 - AsyncExecutor - INFO - Task task_3012377244544_0 was cancelled
2025-03-08 14:36:53,671 - AsyncExecutor - ERROR - Error in task task_1940011726144_2: name 'DataUtils' is not defined
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 117, in initialize
    await self._preload_historical_data()
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 148, in _preload_historical_data
    cleaned_df = DataUtils.clean_ohlcv(df)
                 ^^^^^^^^^
NameError: name 'DataUtils' is not defined
2025-03-08 14:36:53,674 - AsyncExecutor - ERROR - Error in task task_1939978650240_1: name 'DataUtils' is not defined
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\strategy\DualMA.py", line 46, in initialize
    await self.executor.submit(super().initialize)
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 117, in initialize
    await self._preload_historical_data()
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 148, in _preload_historical_data
    cleaned_df = DataUtils.clean_ohlcv(df)
                 ^^^^^^^^^
NameError: name 'DataUtils' is not defined
2025-03-08 14:36:53,675 - AsyncExecutor - INFO - Task task_1940011497280_0 cancelled
2025-03-08 14:36:53,676 - AsyncExecutor - INFO - Task task_1940011497280_0 was cancelled
2025-03-08 14:37:05,477 - AsyncExecutor - ERROR - Error in task task_1849341359168_2: name 'DataUtils' is not defined
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 117, in initialize
    await self._preload_historical_data()
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 148, in _preload_historical_data
    cleaned_df = DataUtils.clean_ohlcv(df)
                 ^^^^^^^^^
NameError: name 'DataUtils' is not defined
2025-03-08 14:37:05,481 - AsyncExecutor - ERROR - Error in task task_1849341358592_1: name 'DataUtils' is not defined
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "d:\jacky\crypto_py\src\strategy\DualMA.py", line 46, in initialize
    await self.executor.submit(super().initialize)
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 115, in submit
    return await task
           ^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 117, in initialize
    await self._preload_historical_data()
  File "D:\jacky\crypto_py\src\strategy\base_strategy.py", line 148, in _preload_historical_data
    cleaned_df = DataUtils.clean_ohlcv(df)
                 ^^^^^^^^^
NameError: name 'DataUtils' is not defined
2025-03-08 14:37:05,492 - AsyncExecutor - INFO - Task task_1849341130560_0 cancelled
2025-03-08 14:37:05,494 - AsyncExecutor - INFO - Task task_1849341130560_0 was cancelled
2025-03-08 14:44:28,764 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:44:28,804 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:44:28,804 - trading_system - INFO - Trading system initializing...
2025-03-08 14:44:28,811 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:44:28,812 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:44:28,812 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:44:28,813 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:44:28,814 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:44:28,814 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:44:28,815 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:44:28,817 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:44:28,817 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:44:28,819 - system.strategyfactory - INFO - 注册了2个默认策略
2025-03-08 14:44:28,824 - system.strategyfactory - INFO - 自动注册 dual_ma (src.strategy.DualMA.DualMAStrategy)
2025-03-08 14:44:29,330 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:44:29,333 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:44:29,337 - system.strategyfactory - INFO - 自动发现完成，注册了 0 个项目
2025-03-08 14:44:29,342 - system.strategyfactory - WARNING - 处理文件 rotation.py 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:44:29,344 - system.strategyfactory - WARNING - 处理文件 spbbt.py 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:44:29,346 - system.strategyfactory - INFO - 自动发现完成，共注册3个策略
2025-03-08 14:44:29,347 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:44:29,348 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:44:29,349 - system.strategyfactory - WARNING - 使用标准方法加载策略 dual_ma 失败: 未知类型: dual_ma，尝试替代方法
2025-03-08 14:44:29,350 - system.strategyfactory - INFO - 创建新的 dual_ma 实例
2025-03-08 14:44:29,351 - system.strategy.dualmastrategy - INFO - 策略 DualMAStrategy 初始化完成
2025-03-08 14:44:29,353 - system.strategy.dualmastrategy - INFO - Initialized DualMAStrategy with short_window=10, long_window=30
2025-03-08 14:44:29,354 - mode.backtesttradingmode - INFO - Backtest mode initialization complete
2025-03-08 14:44:29,355 - mode.backtesttradingmode - INFO - Starting backtest mode | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:44:29,356 - mode.backtesttradingmode - INFO - State initialized with 100000 initial capital
2025-03-08 14:44:29,357 - trading_system - WARNING - 本地文件未找到: db/historical/BTC_USDT_1h.csv
2025-03-08 14:44:29,360 - trading_system - WARNING - 获取的历史数据为空: BTC/USDT|1h|2022-01-01|2023-12-31
2025-03-08 14:44:29,361 - mode.backtesttradingmode - WARNING - BTC/USDT has no historical data
2025-03-08 14:44:29,361 - mode.backtesttradingmode - ERROR - backtest mode error: Failed to get historical data
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 135, in run
    await self._pre_run_setup(symbols, timeframe)
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 171, in _pre_run_setup
    await self._prepare_run(symbols, timeframe)
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 50, in _prepare_run
    raise ValueError("Failed to get historical data")
ValueError: Failed to get historical data
2025-03-08 14:44:29,364 - mode.backtesttradingmode - INFO - Shutting down backtest mode
2025-03-08 14:44:29,366 - system.strategy.dualmastrategy - INFO - 策略 DualMAStrategy 已关闭
2025-03-08 14:44:29,367 - system.strategy.dualmastrategy - INFO - DualMAStrategy shutdown complete
2025-03-08 14:44:29,368 - system.execution - INFO - Execution engine closed
2025-03-08 14:44:29,369 - mode.backtesttradingmode - INFO - Backtest mode shutdown complete
2025-03-08 14:44:29,369 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:44:29,370 - mode.backtesttradingmode - INFO - Shutting down backtest mode
2025-03-08 14:44:29,371 - system.strategy.dualmastrategy - WARNING - 策略 DualMAStrategy 未初始化，跳过关闭
2025-03-08 14:44:29,372 - system.strategy.dualmastrategy - INFO - DualMAStrategy shutdown complete
2025-03-08 14:44:29,372 - mode.backtesttradingmode - INFO - Backtest mode shutdown complete
2025-03-08 14:44:29,373 - AsyncExecutor - INFO - Task task_2100230567904_0 cancelled
2025-03-08 14:44:29,375 - trading_system - INFO - Shutting down trading system...
2025-03-08 14:44:29,376 - AsyncExecutor - INFO - Task task_2100230567904_0 was cancelled
2025-03-08 14:45:16,653 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:45:16,692 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:45:16,692 - trading_system - INFO - Trading system initializing...
2025-03-08 14:45:16,700 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:45:16,701 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:45:16,701 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:45:16,702 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:45:16,702 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:45:16,703 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:45:16,705 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:45:16,707 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:45:16,707 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:45:16,708 - system.strategyfactory - INFO - 注册了2个默认策略
2025-03-08 14:45:16,710 - system.strategyfactory - INFO - 自动注册 dual_ma (src.strategy.DualMA.DualMAStrategy)
2025-03-08 14:45:17,192 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:45:17,194 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:45:17,198 - system.strategyfactory - INFO - 自动发现完成，注册了 0 个项目
2025-03-08 14:45:17,203 - system.strategyfactory - WARNING - 处理文件 rotation.py 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:45:17,205 - system.strategyfactory - WARNING - 处理文件 spbbt.py 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:45:17,206 - system.strategyfactory - INFO - 自动发现完成，共注册3个策略
2025-03-08 14:45:17,208 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:45:17,208 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:45:17,209 - system.strategyfactory - WARNING - 使用标准方法加载策略 dual_ma 失败: 未知类型: dual_ma，尝试替代方法
2025-03-08 14:45:17,210 - system.strategyfactory - INFO - 创建新的 dual_ma 实例
2025-03-08 14:45:17,212 - system.strategy.dualmastrategy - INFO - 策略 DualMAStrategy 初始化完成
2025-03-08 14:45:17,223 - system.strategy.dualmastrategy - INFO - Initialized DualMAStrategy with short_window=10, long_window=30
2025-03-08 14:45:17,224 - mode.backtesttradingmode - INFO - Backtest mode initialization complete
2025-03-08 14:45:17,224 - mode.backtesttradingmode - INFO - Starting backtest mode | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:45:17,224 - mode.backtesttradingmode - INFO - State initialized with 100000 initial capital
2025-03-08 14:45:48,781 - trading_system - WARNING - 本地文件未找到: db/historical/BTC_USDT_1h.csv
2025-03-08 14:45:51,660 - trading_system - WARNING - 获取的历史数据为空: BTC/USDT|1h|2022-01-01|2023-12-31
2025-03-08 14:45:54,041 - mode.backtesttradingmode - WARNING - BTC/USDT has no historical data
2025-03-08 14:46:23,916 - AsyncExecutor - INFO - AsyncExecutor started
2025-03-08 14:46:23,952 - ConfigManager - INFO - Configuration loaded from d:\jacky\crypto_py\conf\bt_config.yaml
2025-03-08 14:46:23,953 - trading_system - INFO - Trading system initializing...
2025-03-08 14:46:23,959 - system.tradingmodefactory - INFO - 自动注册 custom_mode (src.mode.trading_mode_factory.CustomTradingMode)
2025-03-08 14:46:23,960 - system.tradingmodefactory - INFO - 自动发现完成，注册了 4 个项目
2025-03-08 14:46:23,960 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 14:46:23,961 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 14:46:23,961 - trading_system - INFO - Starting trading pipeline...
2025-03-08 14:46:23,962 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:46:23,962 - system.tradingmodefactory - INFO - 创建新的 backtest 实例
2025-03-08 14:46:23,963 - trading_system - INFO - LocalSource initialized with data_path=db/historical/
2025-03-08 14:46:23,964 - trading_system - INFO - DataManager initialized with source_type=local, cache_enabled=True
2025-03-08 14:46:23,966 - system.strategyfactory - INFO - 注册了2个默认策略
2025-03-08 14:46:23,968 - system.strategyfactory - INFO - 自动注册 dual_ma (src.strategy.DualMA.DualMAStrategy)
2025-03-08 14:46:24,461 - system.strategyfactory - WARNING - 加载模块 src.strategy.rotation 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:46:24,464 - system.strategyfactory - WARNING - 加载模块 src.strategy.spbbt 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:46:24,467 - system.strategyfactory - INFO - 自动发现完成，注册了 0 个项目
2025-03-08 14:46:24,473 - system.strategyfactory - WARNING - 处理文件 rotation.py 时出错: module 'ccxt' has no attribute 'okex'
2025-03-08 14:46:24,476 - system.strategyfactory - WARNING - 处理文件 spbbt.py 时出错: cannot import name 'factors_lib' from 'lib' (unknown location)
2025-03-08 14:46:24,478 - system.strategyfactory - INFO - 自动发现完成，共注册3个策略
2025-03-08 14:46:24,479 - mode.backtesttradingmode - INFO - Initializing backtest trading mode
2025-03-08 14:46:24,479 - mode.backtesttradingmode - INFO - Initializing backtest mode
2025-03-08 14:46:24,481 - system.strategyfactory - WARNING - 使用标准方法加载策略 dual_ma 失败: 未知类型: dual_ma，尝试替代方法
2025-03-08 14:46:24,482 - system.strategyfactory - INFO - 创建新的 dual_ma 实例
2025-03-08 14:46:24,483 - system.strategy.dualmastrategy - INFO - 策略 DualMAStrategy 初始化完成
2025-03-08 14:46:24,486 - system.strategy.dualmastrategy - INFO - Initialized DualMAStrategy with short_window=10, long_window=30
2025-03-08 14:46:24,487 - mode.backtesttradingmode - INFO - Backtest mode initialization complete
2025-03-08 14:46:24,488 - mode.backtesttradingmode - INFO - Starting backtest mode | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 14:46:24,488 - mode.backtesttradingmode - INFO - State initialized with 100000 initial capital
2025-03-08 14:46:28,691 - trading_system - WARNING - 本地文件未找到: db/historical/BTC_USDT_1h.csv
2025-03-08 14:46:28,696 - trading_system - WARNING - 获取的历史数据为空: BTC/USDT|1h|2022-01-01|2023-12-31
2025-03-08 14:46:28,698 - mode.backtesttradingmode - WARNING - BTC/USDT has no historical data
2025-03-08 14:46:43,608 - mode.backtesttradingmode - ERROR - backtest mode error: Failed to get historical data
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 135, in run
    await self._pre_run_setup(symbols, timeframe)
  File "D:\jacky\crypto_py\src\mode\base_trading_mode.py", line 171, in _pre_run_setup
    await self._prepare_run(symbols, timeframe)
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 50, in _prepare_run
    raise ValueError("Failed to get historical data")
ValueError: Failed to get historical data
2025-03-08 14:46:43,614 - mode.backtesttradingmode - INFO - Shutting down backtest mode
2025-03-08 14:46:43,615 - system.strategy.dualmastrategy - INFO - 策略 DualMAStrategy 已关闭
2025-03-08 14:46:43,616 - system.strategy.dualmastrategy - INFO - DualMAStrategy shutdown complete
2025-03-08 14:46:43,618 - system.execution - INFO - Execution engine closed
2025-03-08 14:46:43,619 - mode.backtesttradingmode - INFO - Backtest mode shutdown complete
2025-03-08 14:46:43,621 - trading_system - INFO - Initiating system shutdown...
2025-03-08 14:46:43,621 - mode.backtesttradingmode - INFO - Shutting down backtest mode
2025-03-08 14:46:43,622 - system.strategy.dualmastrategy - WARNING - 策略 DualMAStrategy 未初始化，跳过关闭
2025-03-08 14:46:43,623 - system.strategy.dualmastrategy - INFO - DualMAStrategy shutdown complete
2025-03-08 14:46:43,624 - mode.backtesttradingmode - INFO - Backtest mode shutdown complete
2025-03-08 14:46:43,624 - AsyncExecutor - INFO - Task task_1616289904768_0 cancelled
2025-03-08 14:46:43,630 - trading_system - INFO - Shutting down trading system...
2025-03-08 14:46:43,631 - AsyncExecutor - INFO - Task task_1616289904768_0 was cancelled
