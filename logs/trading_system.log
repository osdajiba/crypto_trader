2025-03-08 16:32:30,808 - trading_system - INFO - Trading system initializing...
2025-03-08 16:32:30,835 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:32:30,837 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:32:30,849 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:32:30,851 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:32:30,857 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:32:30,859 - trading_system - INFO - 创建了local数据源
2025-03-08 16:32:30,865 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:32:30,869 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:32:30,870 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:32:30,870 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:32:31,529 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:32:31,530 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2022-01-01-2023-12-31
2025-03-08 16:32:31,541 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:32:31,549 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:33:31,506 - trading_system - INFO - Trading system initializing...
2025-03-08 16:33:31,519 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:33:31,520 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:33:31,520 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:33:31,521 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:33:31,524 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:33:31,525 - trading_system - INFO - 创建了local数据源
2025-03-08 16:33:31,527 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:33:31,529 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:33:31,530 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:33:31,531 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:33:32,088 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:33:32,090 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2022-01-01-2023-12-31
2025-03-08 16:33:32,101 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:33:32,108 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:34:16,414 - trading_system - INFO - Trading system initializing...
2025-03-08 16:34:16,437 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:34:16,438 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:34:16,439 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:34:16,440 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:34:16,442 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:34:16,442 - trading_system - INFO - 创建了local数据源
2025-03-08 16:34:16,446 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:34:16,448 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:34:16,449 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:34:16,450 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:34:37,314 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:34:37,317 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2022-01-01-2023-12-31
2025-03-08 16:34:37,336 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:34:37,348 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:34:43,137 - trading_system - INFO - Trading system initializing...
2025-03-08 16:34:43,149 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:34:43,149 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:34:43,151 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:34:43,152 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:34:43,153 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:34:43,154 - trading_system - INFO - 创建了local数据源
2025-03-08 16:34:43,158 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:34:43,161 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:34:43,162 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:34:43,163 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:41:11,350 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:41:24,386 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2022-01-01-2023-12-31
2025-03-08 16:41:30,831 - trading_system - INFO - Trading system initializing...
2025-03-08 16:41:30,843 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:41:30,845 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:41:30,845 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:41:30,846 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:41:30,848 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:41:30,849 - trading_system - INFO - 创建了local数据源
2025-03-08 16:41:30,852 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:41:30,854 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:41:30,855 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:41:30,856 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:42:24,075 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:45:06,067 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2022-01-01-2023-12-31
2025-03-08 16:45:06,088 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:45:06,099 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:45:11,698 - trading_system - INFO - Trading system initializing...
2025-03-08 16:45:11,708 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:45:11,709 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:45:11,710 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:45:11,711 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:45:11,714 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:45:11,714 - trading_system - INFO - 创建了local数据源
2025-03-08 16:46:13,283 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:46:13,290 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:46:13,292 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:46:13,294 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:46:34,557 - trading_system - INFO - Trading system initializing...
2025-03-08 16:46:34,570 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:46:34,571 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:46:34,572 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:46:34,572 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:46:34,573 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:46:34,573 - trading_system - INFO - 创建了local数据源
2025-03-08 16:48:12,824 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:48:12,830 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:48:12,833 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:48:12,834 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:48:41,612 - trading_system - INFO - Trading system initializing...
2025-03-08 16:48:41,624 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:48:41,625 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:48:41,626 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:48:41,626 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:48:41,628 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:48:41,629 - trading_system - INFO - 创建了local数据源
2025-03-08 16:49:35,484 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:49:35,491 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:49:35,493 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:49:35,494 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:49:45,849 - trading_system - INFO - Trading system initializing...
2025-03-08 16:49:45,875 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:49:45,876 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:49:45,878 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:49:45,879 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:49:45,882 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:49:45,883 - trading_system - INFO - 创建了local数据源
2025-03-08 16:50:03,807 - trading_system - ERROR - 连接Binance失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:50:03,813 - trading_system - ERROR - 创建exchange数据源失败: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 53, in __init__
    self._connect_exchange()
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 90, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-08 16:50:03,814 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-08 16:50:03,815 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:50:10,266 - trading_system - INFO - Trading system initializing...
2025-03-08 16:50:10,277 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:50:10,278 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:50:10,279 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:50:10,279 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:50:10,281 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:50:10,282 - trading_system - INFO - 创建了local数据源
2025-03-08 16:51:12,461 - trading_system - INFO - Trading system initializing...
2025-03-08 16:51:38,688 - trading_system - INFO - Trading system initializing...
2025-03-08 16:51:58,113 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:51:58,114 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:51:58,117 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:51:58,118 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:51:58,122 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:51:58,122 - trading_system - INFO - 创建了local数据源
2025-03-08 16:52:30,420 - trading_system - INFO - Trading system initializing...
2025-03-08 16:52:30,432 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:52:30,433 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:52:30,434 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:52:30,434 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:52:30,437 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:52:30,437 - trading_system - INFO - 创建了local数据源
2025-03-08 16:52:53,358 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:52:53,380 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:52:53,384 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:52:53,385 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:52:53,387 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:52:53,388 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:52:53,389 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:53:18,579 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:53:24,323 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2022-01-01-2023-12-31，尝试从交易所下载
2025-03-08 16:53:24,324 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2022-01-01 - 2023-12-31
2025-03-08 16:53:24,576 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为18个部分
2025-03-08 16:53:24,577 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2022-01-01 16:00:00+08:00 - 2022-02-11 04:00:00+08:00
2025-03-08 16:53:24,578 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:53:24,780 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:26,792 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:30,794 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:30,796 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:30,798 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:32,810 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:36,824 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:36,826 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:36,828 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2022-01-01 16:00:00+08:00 - 2022-02-11 04:00:00+08:00
2025-03-08 16:53:39,844 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2022-02-11 04:00:00+08:00 - 2022-03-23 16:00:00+08:00
2025-03-08 16:53:39,846 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:53:39,848 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:41,855 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:45,872 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:45,874 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:45,877 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:47,897 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:51,895 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:51,897 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:51,898 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2022-02-11 04:00:00+08:00 - 2022-03-23 16:00:00+08:00
2025-03-08 16:53:54,892 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2022-03-23 16:00:00+08:00 - 2022-05-03 04:00:00+08:00
2025-03-08 16:53:54,894 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:53:54,896 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:53:56,902 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:00,930 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:00,932 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:00,933 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:02,951 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:06,975 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:06,976 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:06,977 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2022-03-23 16:00:00+08:00 - 2022-05-03 04:00:00+08:00
2025-03-08 16:54:09,975 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2022-05-03 04:00:00+08:00 - 2022-06-12 16:00:00+08:00
2025-03-08 16:54:09,978 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:54:09,980 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:12,001 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:16,024 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:16,025 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:16,028 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:18,052 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:22,068 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:22,071 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:22,073 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2022-05-03 04:00:00+08:00 - 2022-06-12 16:00:00+08:00
2025-03-08 16:54:27,774 - trading_system - INFO - Trading system initializing...
2025-03-08 16:54:27,784 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:54:27,784 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:54:27,786 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:54:27,786 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:54:27,789 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:54:27,790 - trading_system - INFO - 创建了local数据源
2025-03-08 16:54:32,967 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:54:32,989 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:54:32,991 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:54:32,992 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:54:32,994 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:54:32,996 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:54:32,997 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:54:33,557 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:54:38,382 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:54:38,384 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:54:38,593 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:54:38,594 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:54:38,595 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:54:38,884 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:40,896 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:44,902 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:44,904 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:44,906 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:46,914 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:50,916 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:50,918 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:54:50,921 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:54:50,924 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 16:54:50,926 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 16:54:50,928 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 16:54:50,956 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:54:50,963 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:55:04,582 - trading_system - INFO - Trading system initializing...
2025-03-08 16:55:04,597 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:55:04,597 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:55:04,597 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:55:04,599 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:55:04,601 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:55:04,602 - trading_system - INFO - 创建了local数据源
2025-03-08 16:55:04,621 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:55:04,645 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:55:04,646 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:55:04,647 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:55:04,648 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:55:04,648 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:55:04,649 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:55:05,168 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:55:05,168 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:55:05,170 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:55:05,379 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:55:05,380 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:55:05,381 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:55:05,560 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:07,574 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:11,581 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:11,583 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:11,584 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:13,598 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:17,617 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:17,620 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:17,621 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:55:17,623 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 16:55:17,627 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 16:55:17,628 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 16:55:17,646 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:55:17,652 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:55:23,311 - trading_system - INFO - Trading system initializing...
2025-03-08 16:55:23,323 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:55:23,324 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:55:23,324 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:55:23,325 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:55:23,328 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:55:23,329 - trading_system - INFO - 创建了local数据源
2025-03-08 16:55:23,360 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:55:23,401 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:55:23,403 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:55:23,405 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:55:23,406 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:55:23,407 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:55:23,409 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:55:24,103 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:55:24,104 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:55:24,105 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:55:24,310 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:55:24,311 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:55:24,312 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:55:24,516 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:26,544 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:30,548 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:30,550 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:30,552 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:32,578 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:55:37,461 - trading_system - INFO - Trading system initializing...
2025-03-08 16:55:37,474 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:55:37,474 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:55:37,474 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:55:37,475 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:55:37,476 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:55:37,477 - trading_system - INFO - 创建了local数据源
2025-03-08 16:55:37,504 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:55:37,541 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:55:37,542 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:55:37,542 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:55:37,543 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:55:37,543 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:55:37,545 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:55:38,070 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:55:38,071 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:55:41,647 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:56:03,744 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:56:18,583 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:56:18,584 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:56:18,820 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:20,826 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:24,846 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:24,848 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:24,849 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:26,867 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:30,888 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:30,891 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:56:30,893 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:56:30,895 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 16:56:30,897 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 16:56:30,898 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 16:56:30,911 - trading_system - INFO - Initiating system shutdown...
2025-03-08 16:56:30,915 - trading_system - INFO - Shutting down trading system...
2025-03-08 16:56:39,159 - trading_system - INFO - Trading system initializing...
2025-03-08 16:56:39,173 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:56:39,174 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:56:39,174 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:56:39,176 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:56:39,179 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:56:39,179 - trading_system - INFO - 创建了local数据源
2025-03-08 16:56:39,200 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:56:39,223 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:56:39,224 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:56:39,226 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:56:39,226 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:56:39,227 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:56:39,228 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:56:39,720 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:56:39,721 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:56:50,917 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:56:51,113 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:57:37,814 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:57:37,816 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:58:24,402 - trading_system - INFO - Trading system initializing...
2025-03-08 16:58:24,413 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 16:58:24,413 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 16:58:24,414 - trading_system - INFO - Starting trading pipeline...
2025-03-08 16:58:24,414 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 16:58:24,416 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 16:58:24,416 - trading_system - INFO - 创建了local数据源
2025-03-08 16:58:24,438 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 16:58:24,458 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 16:58:24,458 - trading_system - INFO - Binance接口初始化完成
2025-03-08 16:58:24,460 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 16:58:24,461 - trading_system - INFO - 创建了exchange数据源
2025-03-08 16:58:24,462 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 16:58:24,462 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 16:58:24,950 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 16:58:24,951 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 16:58:33,833 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 16:58:34,010 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 16:58:49,708 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 16:58:49,711 - trading_system - INFO - 将请求分为2个块
2025-03-08 16:59:34,348 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 16:59:48,601 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:24,019 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:24,020 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:24,021 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:26,034 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:30,045 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:30,047 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:00:30,049 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 17:00:30,052 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 17:00:30,055 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 17:00:30,057 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 17:00:30,075 - trading_system - INFO - Initiating system shutdown...
2025-03-08 17:00:30,080 - trading_system - INFO - Shutting down trading system...
2025-03-08 17:00:47,747 - trading_system - INFO - Trading system initializing...
2025-03-08 17:00:47,762 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 17:00:47,762 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 17:00:47,763 - trading_system - INFO - Starting trading pipeline...
2025-03-08 17:00:47,764 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 17:00:47,766 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 17:00:47,767 - trading_system - INFO - 创建了local数据源
2025-03-08 17:00:47,794 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 17:00:47,817 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 17:00:47,818 - trading_system - INFO - Binance接口初始化完成
2025-03-08 17:00:47,819 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 17:00:47,821 - trading_system - INFO - 创建了exchange数据源
2025-03-08 17:00:47,821 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 17:00:47,822 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 17:00:48,361 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 17:00:48,362 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 17:00:48,363 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 17:00:48,538 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 17:01:10,349 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 17:01:10,351 - trading_system - INFO - 将请求分为2个块
2025-03-08 17:01:10,597 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:12,603 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:16,597 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:16,599 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:16,601 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:18,602 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:22,614 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:22,616 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:01:22,618 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 17:01:22,620 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 17:01:22,623 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 17:01:22,624 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 17:01:22,637 - trading_system - INFO - Initiating system shutdown...
2025-03-08 17:01:22,644 - trading_system - INFO - Shutting down trading system...
2025-03-08 17:02:01,899 - trading_system - INFO - Trading system initializing...
2025-03-08 17:02:01,911 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 17:02:01,911 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 17:02:01,912 - trading_system - INFO - Starting trading pipeline...
2025-03-08 17:02:01,912 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 17:02:01,914 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 17:02:01,915 - trading_system - INFO - 创建了local数据源
2025-03-08 17:02:01,942 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 17:02:01,989 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 17:02:01,991 - trading_system - INFO - Binance接口初始化完成
2025-03-08 17:02:01,993 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 17:02:01,995 - trading_system - INFO - 创建了exchange数据源
2025-03-08 17:02:01,996 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 17:02:01,997 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 17:02:02,616 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 17:02:02,616 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 17:02:02,617 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 17:02:02,784 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 17:02:29,748 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 17:02:29,750 - trading_system - INFO - 将请求分为2个块
2025-03-08 17:03:37,790 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:03:57,425 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:04:06,438 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:04:06,440 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 17:04:10,512 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:47:53,114 - trading_system - INFO - Trading system initializing...
2025-03-08 18:47:53,178 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:47:53,178 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:47:53,179 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:47:53,179 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:47:53,179 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:47:53,179 - trading_system - INFO - 创建了local数据源
2025-03-08 18:47:53,185 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:47:53,190 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:47:53,190 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:47:53,190 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:47:53,191 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:47:53,191 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:47:53,191 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:47:57,928 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: simple
2025-03-08 18:47:57,931 - trading_system - INFO - Initiating system shutdown...
2025-03-08 18:47:57,931 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 18:47:57,931 - trading_system - INFO - Shutting down trading system...
2025-03-08 18:48:48,566 - trading_system - INFO - Trading system initializing...
2025-03-08 18:48:48,575 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:48:48,576 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:48:48,576 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:48:48,577 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:48:48,580 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:48:48,581 - trading_system - INFO - 创建了local数据源
2025-03-08 18:48:48,601 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:48:48,621 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:48:48,622 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:48:48,623 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:48:48,623 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:48:48,625 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:48:48,626 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:48:49,252 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: simple
2025-03-08 18:48:49,257 - trading_system - INFO - Initiating system shutdown...
2025-03-08 18:48:49,258 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-08 18:48:49,261 - trading_system - INFO - Shutting down trading system...
2025-03-08 18:50:27,551 - trading_system - INFO - Trading system initializing...
2025-03-08 18:50:27,555 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:50:27,555 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:50:27,555 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:50:27,557 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:50:27,557 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:50:27,557 - trading_system - INFO - 创建了local数据源
2025-03-08 18:50:27,564 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:50:27,570 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:50:27,570 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:50:27,570 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:50:27,571 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:50:27,571 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:50:27,571 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:50:27,919 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:50:27,919 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:50:27,920 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:50:30,748 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:50:30,749 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:50:30,750 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:50:31,053 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:50:33,055 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:50:58,963 - trading_system - INFO - Trading system initializing...
2025-03-08 18:50:58,974 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:50:58,975 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:50:58,976 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:50:58,976 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:50:58,979 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:50:58,979 - trading_system - INFO - 创建了local数据源
2025-03-08 18:50:59,000 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:50:59,024 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:50:59,025 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:50:59,025 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:50:59,026 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:50:59,027 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:50:59,027 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:50:59,533 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:50:59,535 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:50:59,536 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:50:59,738 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:51:31,381 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:51:31,383 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:51:38,779 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:51:43,555 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:54:17,976 - trading_system - INFO - Trading system initializing...
2025-03-08 18:54:17,986 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:54:17,987 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:54:17,987 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:54:17,988 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:54:17,991 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:54:17,992 - trading_system - INFO - 创建了local数据源
2025-03-08 18:54:18,013 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:54:18,033 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:54:18,035 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:54:18,036 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:54:18,037 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:54:18,038 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:54:18,038 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:54:18,529 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:54:18,530 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:54:18,531 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:54:18,666 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:54:58,859 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:54:58,860 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:55:46,923 - trading_system - INFO - Trading system initializing...
2025-03-08 18:55:46,933 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:55:46,934 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:55:46,935 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:55:46,935 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:55:46,938 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:55:46,938 - trading_system - INFO - 创建了local数据源
2025-03-08 18:55:46,961 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:55:46,988 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:55:46,990 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:55:46,991 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:55:46,992 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:55:46,993 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:55:46,994 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:55:47,624 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:55:47,625 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:55:47,626 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:55:47,807 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:55:50,858 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:55:50,860 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:55:52,714 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:56:33,666 - trading_system - INFO - Trading system initializing...
2025-03-08 18:56:33,676 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:56:33,677 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:56:33,678 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:56:33,678 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:56:33,680 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:56:33,681 - trading_system - INFO - 创建了local数据源
2025-03-08 18:56:33,704 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:56:33,725 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:56:33,726 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:56:33,726 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:56:33,728 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:56:33,729 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:56:33,730 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:56:34,228 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:56:34,229 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:56:34,230 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:56:34,366 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:56:37,773 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:56:37,774 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:56:47,496 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 18:57:02,383 - trading_system - INFO - Trading system initializing...
2025-03-08 18:57:02,393 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 18:57:02,394 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 18:57:02,394 - trading_system - INFO - Starting trading pipeline...
2025-03-08 18:57:02,395 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 18:57:02,396 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 18:57:02,397 - trading_system - INFO - 创建了local数据源
2025-03-08 18:57:02,418 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 18:57:02,438 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 18:57:02,439 - trading_system - INFO - Binance接口初始化完成
2025-03-08 18:57:02,439 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 18:57:02,440 - trading_system - INFO - 创建了exchange数据源
2025-03-08 18:57:02,441 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 18:57:02,441 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 18:57:02,947 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 18:57:02,948 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 18:57:02,948 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 18:57:03,096 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 18:57:03,097 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 18:57:03,098 - trading_system - INFO - 将请求分为2个块
2025-03-08 18:57:14,465 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 19:03:59,986 - trading_system - INFO - Trading system initializing...
2025-03-08 19:04:00,004 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 19:04:00,006 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 19:04:00,006 - trading_system - INFO - Starting trading pipeline...
2025-03-08 19:04:00,009 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 19:04:00,013 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 19:04:00,014 - trading_system - INFO - 创建了local数据源
2025-03-08 19:04:00,039 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 19:04:00,063 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 19:04:00,064 - trading_system - INFO - Binance接口初始化完成
2025-03-08 19:04:00,065 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 19:04:00,065 - trading_system - INFO - 创建了exchange数据源
2025-03-08 19:04:00,066 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 19:04:00,068 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 19:04:00,620 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 19:04:00,621 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 19:04:00,622 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 19:04:00,787 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 19:04:00,788 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 19:04:00,789 - trading_system - INFO - 将请求分为2个块
2025-03-08 19:08:07,496 - trading_system - INFO - Trading system initializing...
2025-03-08 19:08:07,515 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 19:08:07,516 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 19:08:07,517 - trading_system - INFO - Starting trading pipeline...
2025-03-08 19:08:07,518 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 19:08:07,522 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 19:08:07,523 - trading_system - INFO - 创建了local数据源
2025-03-08 19:08:07,551 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 19:08:07,580 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 19:08:07,582 - trading_system - INFO - Binance接口初始化完成
2025-03-08 19:08:07,583 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 19:08:07,584 - trading_system - INFO - 创建了exchange数据源
2025-03-08 19:08:07,585 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 19:08:07,585 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 19:08:08,304 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 19:08:08,305 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 19:08:08,305 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 19:08:08,645 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 19:08:08,648 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 19:08:08,649 - trading_system - INFO - 将请求分为2个块
2025-03-08 19:08:10,773 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 19:08:21,784 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-08 19:08:30,342 - trading_system - INFO - Initiating system shutdown...
2025-03-08 19:08:30,344 - trading_system - INFO - Shutting down trading system...
2025-03-08 21:57:07,774 - trading_system - INFO - Trading system initializing...
2025-03-08 21:57:07,785 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 21:57:07,785 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 21:57:07,786 - trading_system - INFO - Starting trading pipeline...
2025-03-08 21:57:07,786 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 21:57:07,788 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 21:57:07,789 - trading_system - INFO - 创建了local数据源
2025-03-08 21:57:07,812 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 21:57:07,833 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 21:57:07,834 - trading_system - INFO - Binance接口初始化完成
2025-03-08 21:57:07,835 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 21:57:07,835 - trading_system - INFO - 创建了exchange数据源
2025-03-08 21:57:07,837 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 21:57:07,838 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 21:57:08,837 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 21:57:08,838 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 21:57:08,839 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 21:57:09,170 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 21:57:09,171 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 16:00:00+08:00 - 2023-12-31 16:00:00+08:00
2025-03-08 21:57:09,172 - trading_system - INFO - 将请求分为2个块
2025-03-08 22:45:14,923 - trading_system - INFO - Trading system initializing...
2025-03-08 22:45:14,937 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 22:45:14,938 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 22:45:14,940 - trading_system - INFO - Starting trading pipeline...
2025-03-08 22:45:14,940 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 22:45:14,943 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 22:45:14,943 - trading_system - INFO - 创建了local数据源
2025-03-08 22:45:14,950 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 22:45:14,951 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 22:45:14,953 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 22:45:15,952 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 22:45:15,953 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 22:45:15,964 - trading_system - INFO - Initiating system shutdown...
2025-03-08 22:45:15,971 - trading_system - INFO - Shutting down trading system...
2025-03-08 22:45:38,793 - trading_system - INFO - Trading system initializing...
2025-03-08 22:45:38,800 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 22:45:38,802 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 22:45:38,803 - trading_system - INFO - Starting trading pipeline...
2025-03-08 22:45:38,803 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 22:45:38,805 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 22:45:38,806 - trading_system - INFO - 创建了local数据源
2025-03-08 22:45:38,811 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 22:45:38,812 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 22:45:38,813 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 22:45:39,351 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 22:45:39,352 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 22:45:39,363 - trading_system - INFO - Initiating system shutdown...
2025-03-08 22:45:39,373 - trading_system - INFO - Shutting down trading system...
2025-03-08 22:45:57,093 - trading_system - INFO - Trading system initializing...
2025-03-08 22:45:57,101 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 22:45:57,102 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 22:45:57,102 - trading_system - INFO - Starting trading pipeline...
2025-03-08 22:45:57,103 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 22:45:57,106 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 22:45:57,107 - trading_system - INFO - 创建了local数据源
2025-03-08 22:45:57,111 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 22:45:57,113 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 22:45:57,114 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 22:45:57,646 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 22:45:57,648 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 22:45:57,657 - trading_system - INFO - Initiating system shutdown...
2025-03-08 22:45:57,665 - trading_system - INFO - Shutting down trading system...
2025-03-08 22:46:16,523 - trading_system - INFO - Trading system initializing...
2025-03-08 22:46:16,530 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 22:46:16,531 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 22:46:16,532 - trading_system - INFO - Starting trading pipeline...
2025-03-08 22:46:16,533 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 22:46:16,536 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 22:46:16,537 - trading_system - INFO - 创建了local数据源
2025-03-08 22:46:16,541 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 22:46:16,543 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 22:46:16,544 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 22:46:17,140 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 22:46:17,141 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 22:46:17,149 - trading_system - INFO - Initiating system shutdown...
2025-03-08 22:46:17,156 - trading_system - INFO - Shutting down trading system...
2025-03-08 22:47:09,842 - trading_system - INFO - Trading system initializing...
2025-03-08 22:47:09,849 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 22:47:09,849 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 22:47:09,851 - trading_system - INFO - Starting trading pipeline...
2025-03-08 22:47:09,852 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 22:47:09,854 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 22:47:09,855 - trading_system - INFO - 创建了local数据源
2025-03-08 22:47:09,859 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 22:47:09,860 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 22:47:09,861 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 22:47:10,407 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 22:47:10,408 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 22:47:10,420 - trading_system - INFO - Initiating system shutdown...
2025-03-08 22:47:10,427 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:05:46,636 - trading_system - INFO - Trading system initializing...
2025-03-08 23:05:46,646 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:05:46,647 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:05:46,647 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:05:46,649 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:05:46,652 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:05:46,653 - trading_system - INFO - 创建了local数据源
2025-03-08 23:05:46,658 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:05:46,659 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:05:46,661 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:05:47,239 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:05:47,241 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:05:47,249 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:05:47,258 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:06:51,212 - trading_system - INFO - Trading system initializing...
2025-03-08 23:06:51,224 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:06:51,225 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:06:51,226 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:06:51,227 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:06:51,230 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:06:51,231 - trading_system - INFO - 创建了local数据源
2025-03-08 23:06:51,235 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:06:51,236 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:06:51,238 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:06:51,924 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:06:51,925 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:06:51,937 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:06:51,943 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:07:52,633 - trading_system - INFO - Trading system initializing...
2025-03-08 23:07:52,640 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:07:52,641 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:07:52,643 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:07:52,644 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:07:52,647 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:07:52,648 - trading_system - INFO - 创建了local数据源
2025-03-08 23:07:52,652 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:07:52,654 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:07:52,655 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:07:53,219 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:07:53,220 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:07:53,233 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:07:53,243 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:07:59,547 - trading_system - INFO - Trading system initializing...
2025-03-08 23:07:59,558 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:07:59,559 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:07:59,560 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:07:59,561 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:07:59,564 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:07:59,565 - trading_system - INFO - 创建了local数据源
2025-03-08 23:07:59,570 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:07:59,571 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:07:59,573 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:08:00,234 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:08:00,236 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:08:00,248 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:08:00,255 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:18:30,490 - trading_system - INFO - Trading system initializing...
2025-03-08 23:18:30,508 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:18:30,510 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:18:30,511 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:18:30,512 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:18:30,516 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:18:30,518 - trading_system - INFO - 创建了local数据源
2025-03-08 23:18:30,543 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:18:30,566 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:18:46,920 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:18:46,923 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:18:46,924 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:18:46,927 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:18:46,927 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:18:47,525 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:18:47,526 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:18:58,706 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:19:01,805 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:19:01,807 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:19:01,807 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:19:01,809 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:19:01,810 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:19:01,822 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:19:01,831 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:19:08,167 - trading_system - INFO - Trading system initializing...
2025-03-08 23:19:08,176 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:19:08,177 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:19:08,177 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:19:08,178 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:19:08,181 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:19:08,182 - trading_system - INFO - 创建了local数据源
2025-03-08 23:19:08,206 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:19:08,229 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:19:08,230 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:19:08,231 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:19:08,232 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:19:08,233 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:19:08,234 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:19:08,787 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:19:08,788 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:26:31,447 - trading_system - INFO - Trading system initializing...
2025-03-08 23:26:31,458 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:26:31,459 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:26:31,460 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:26:31,461 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:26:31,463 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:26:31,464 - trading_system - INFO - 创建了local数据源
2025-03-08 23:26:31,490 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:26:31,514 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:26:31,515 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:26:31,516 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:26:31,517 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:26:31,517 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:26:31,518 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:26:32,078 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:26:32,081 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:27:27,794 - trading_system - INFO - Trading system initializing...
2025-03-08 23:27:27,803 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:27:27,805 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:27:27,806 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:27:27,807 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:27:27,809 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:27:27,810 - trading_system - INFO - 创建了local数据源
2025-03-08 23:27:27,837 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:27:27,860 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:27:27,863 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:27:27,864 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:27:27,864 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:27:27,866 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:27:27,867 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:27:28,491 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:27:28,492 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:27:39,977 - trading_system - INFO - Trading system initializing...
2025-03-08 23:27:39,989 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:27:39,990 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:27:39,991 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:27:39,993 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:27:39,995 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:27:39,996 - trading_system - INFO - 创建了local数据源
2025-03-08 23:27:40,023 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:27:40,050 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:27:40,051 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:27:40,052 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:27:40,053 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:27:40,055 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:27:40,056 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:27:40,599 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:27:40,601 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:27:54,451 - trading_system - INFO - Trading system initializing...
2025-03-08 23:27:54,460 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:27:54,461 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:27:54,462 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:27:54,462 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:27:54,465 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:27:54,465 - trading_system - INFO - 创建了local数据源
2025-03-08 23:27:54,487 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:27:54,508 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:27:54,510 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:27:54,511 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:27:54,512 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:27:54,512 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:27:54,513 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:27:55,077 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:27:55,078 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:28:19,074 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:28:19,303 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:28:29,107 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:28:29,108 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:28:29,114 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:28:29,115 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:28:29,133 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:28:29,142 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:28:34,580 - trading_system - INFO - Trading system initializing...
2025-03-08 23:28:34,588 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:28:34,589 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:28:34,590 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:28:34,590 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:28:34,593 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:28:34,594 - trading_system - INFO - 创建了local数据源
2025-03-08 23:28:34,617 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:28:34,642 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:28:34,644 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:28:34,645 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:28:34,645 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:28:34,646 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:28:34,647 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:28:35,186 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:28:35,187 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:28:42,231 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:28:42,445 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:29:03,860 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:29:07,954 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:29:12,162 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:29:12,163 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:29:12,179 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:29:12,191 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:29:17,120 - trading_system - INFO - Trading system initializing...
2025-03-08 23:29:17,131 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:29:17,132 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:29:17,133 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:29:17,134 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:29:17,136 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:29:17,137 - trading_system - INFO - 创建了local数据源
2025-03-08 23:29:17,161 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:29:17,185 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:29:17,186 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:29:17,187 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:29:17,187 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:29:17,188 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:29:17,189 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:29:17,750 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:29:17,751 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:29:17,751 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:29:17,917 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:29:30,125 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:29:30,126 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:29:30,133 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:29:30,134 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:29:30,152 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:29:30,162 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:29:35,473 - trading_system - INFO - Trading system initializing...
2025-03-08 23:29:35,481 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:29:35,482 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:29:35,482 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:29:35,483 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:29:35,485 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:29:35,485 - trading_system - INFO - 创建了local数据源
2025-03-08 23:29:35,508 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:29:35,529 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:29:35,531 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:29:35,532 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:29:35,533 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:29:35,534 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:29:35,534 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:29:36,055 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:29:36,056 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:29:36,057 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:29:36,243 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:29:54,501 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:29:54,502 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:29:54,508 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:29:54,509 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:29:54,531 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:29:54,541 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:29:59,907 - trading_system - INFO - Trading system initializing...
2025-03-08 23:29:59,915 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:29:59,916 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:29:59,916 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:29:59,917 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:29:59,920 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:29:59,921 - trading_system - INFO - 创建了local数据源
2025-03-08 23:29:59,941 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:29:59,961 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:29:59,962 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:29:59,963 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:29:59,964 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:29:59,964 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:29:59,965 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:30:00,485 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:30:00,486 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:30:00,487 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:30:00,639 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:30:15,110 - trading_system - INFO - Trading system initializing...
2025-03-08 23:30:15,122 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:30:15,123 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:30:15,123 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:30:15,124 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:30:15,126 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:30:15,127 - trading_system - INFO - 创建了local数据源
2025-03-08 23:30:15,151 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:30:15,178 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:30:15,179 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:30:15,180 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:30:15,181 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:30:15,182 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:30:15,184 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:30:15,832 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:30:15,833 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:30:15,834 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:30:15,974 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:30:19,600 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:30:19,601 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:30:19,605 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:30:19,605 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:30:19,615 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:30:19,623 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:30:28,612 - trading_system - INFO - Trading system initializing...
2025-03-08 23:30:28,621 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:30:28,622 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:30:28,622 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:30:28,623 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:30:28,625 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:30:28,626 - trading_system - INFO - 创建了local数据源
2025-03-08 23:30:28,648 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:30:28,669 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:30:28,670 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:30:28,671 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:30:28,672 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:30:28,673 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:30:28,674 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:30:29,188 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:30:29,189 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:30:29,190 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:30:29,332 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:30:51,487 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-08 23:30:51,488 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-08 23:30:51,496 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-08 23:30:51,497 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:30:51,515 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:30:51,525 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:35:17,163 - trading_system - INFO - Trading system initializing...
2025-03-08 23:35:17,171 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:35:17,171 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:35:17,172 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:35:17,173 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:35:17,175 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:35:17,176 - trading_system - INFO - 创建了local数据源
2025-03-08 23:35:17,179 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:35:17,180 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:35:17,181 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:35:17,734 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:35:17,736 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:35:17,747 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:35:17,756 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:35:27,489 - trading_system - INFO - Trading system initializing...
2025-03-08 23:35:27,497 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:35:27,497 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:35:27,498 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:35:27,498 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:35:27,500 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:35:27,501 - trading_system - INFO - 创建了local数据源
2025-03-08 23:35:27,504 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:35:27,505 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:35:27,507 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:35:28,108 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:35:28,109 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:35:28,118 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:35:28,123 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:35:37,622 - trading_system - INFO - Trading system initializing...
2025-03-08 23:35:37,629 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:35:37,630 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:35:37,631 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:35:37,631 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:35:37,634 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:35:37,634 - trading_system - INFO - 创建了local数据源
2025-03-08 23:35:37,638 - trading_system - ERROR - 创建exchange数据源失败: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 478, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 310, in __init__
    self.exchange = Binance(config=config)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 22, in __init__
    self.local_database = os.path.join(self.base_dir, config.get('data', 'path')) if self.config else None
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\ntpath.py", line 147, in join
    genericpath._check_arg_types('join', path, *paths)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\genericpath.py", line 152, in _check_arg_types
    raise TypeError(f'{funcname}() argument must be str, bytes, or '
TypeError: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'

2025-03-08 23:35:37,639 - trading_system - WARNING - 无法创建备用交易所数据源: join() argument must be str, bytes, or os.PathLike object, not 'NoneType'
2025-03-08 23:35:37,640 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:35:38,221 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:35:38,222 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-08 23:35:38,230 - trading_system - INFO - Initiating system shutdown...
2025-03-08 23:35:38,236 - trading_system - INFO - Shutting down trading system...
2025-03-08 23:36:17,762 - trading_system - INFO - Trading system initializing...
2025-03-08 23:36:17,772 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:36:17,772 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:36:17,773 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:36:17,774 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:36:17,776 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:36:17,777 - trading_system - INFO - 创建了local数据源
2025-03-08 23:36:17,798 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:36:17,817 - trading_system - INFO - 异步客户端初始化成功
2025-03-08 23:36:17,818 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:36:17,819 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:36:17,820 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:36:17,821 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:36:17,821 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:36:18,367 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:36:18,367 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:36:34,134 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-08 23:37:06,471 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-08 23:42:34,221 - trading_system - INFO - Trading system initializing...
2025-03-08 23:42:34,231 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:42:34,231 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:42:34,232 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:42:34,233 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:42:34,236 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:42:34,236 - trading_system - INFO - 创建了local数据源
2025-03-08 23:42:34,256 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:42:34,275 - trading_system - ERROR - 获取IP地址失败: argument of type 'ConfigManager' is not iterable
2025-03-08 23:42:34,276 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: None
2025-03-08 23:42:34,277 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:42:34,278 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:42:34,279 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:42:34,280 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:42:34,280 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:42:34,785 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:42:34,786 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:44:18,773 - trading_system - INFO - Trading system initializing...
2025-03-08 23:44:18,783 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:44:18,784 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:44:18,784 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:44:18,785 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:44:18,787 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:44:18,788 - trading_system - INFO - 创建了local数据源
2025-03-08 23:44:18,811 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:44:30,496 - trading_system - ERROR - 获取IP地址失败: argument of type 'ConfigManager' is not iterable
2025-03-08 23:44:39,564 - trading_system - INFO - Trading system initializing...
2025-03-08 23:44:39,575 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:44:39,576 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:44:39,577 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:44:39,578 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:44:39,580 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:44:39,581 - trading_system - INFO - 创建了local数据源
2025-03-08 23:44:39,605 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:47:03,671 - trading_system - INFO - Trading system initializing...
2025-03-08 23:47:03,682 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:47:03,683 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:47:03,684 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:47:03,685 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:47:03,687 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:47:03,688 - trading_system - INFO - 创建了local数据源
2025-03-08 23:47:03,719 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:47:21,335 - trading_system - ERROR - 获取IP地址失败: 'ConfigManager' object is not subscriptable
2025-03-08 23:47:21,337 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: None
2025-03-08 23:47:21,341 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:47:21,344 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:47:21,346 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:47:21,349 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:47:21,350 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:47:22,043 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:47:22,044 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:47:28,645 - trading_system - INFO - Trading system initializing...
2025-03-08 23:47:28,661 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:47:28,662 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:47:28,663 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:47:28,664 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:47:28,667 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:47:28,668 - trading_system - INFO - 创建了local数据源
2025-03-08 23:47:28,695 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:47:28,723 - trading_system - ERROR - 获取IP地址失败: 'ConfigManager' object is not subscriptable
2025-03-08 23:47:28,724 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: None
2025-03-08 23:47:28,725 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:47:28,726 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:47:28,726 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:47:28,727 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:47:28,728 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:47:29,371 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:47:29,372 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:47:37,742 - trading_system - INFO - Trading system initializing...
2025-03-08 23:47:37,752 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:47:37,753 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:47:37,754 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:47:37,754 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:47:37,757 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:47:37,758 - trading_system - INFO - 创建了local数据源
2025-03-08 23:47:37,779 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:47:37,815 - trading_system - ERROR - 获取IP地址失败: 'ConfigManager' object is not subscriptable
2025-03-08 23:47:37,818 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: None
2025-03-08 23:47:37,820 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:47:37,821 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:47:37,822 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:47:37,823 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:47:37,824 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:47:38,370 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:47:38,371 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-08 23:47:57,296 - trading_system - INFO - Trading system initializing...
2025-03-08 23:47:57,312 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:47:57,313 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:47:57,313 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:47:57,314 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:47:57,317 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:47:57,318 - trading_system - INFO - 创建了local数据源
2025-03-08 23:47:57,346 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:48:49,088 - trading_system - INFO - Trading system initializing...
2025-03-08 23:48:49,097 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-08 23:48:49,098 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-08 23:48:49,099 - trading_system - INFO - Starting trading pipeline...
2025-03-08 23:48:49,100 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-08 23:48:49,102 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-08 23:48:49,104 - trading_system - INFO - 创建了local数据源
2025-03-08 23:48:49,125 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-08 23:49:20,204 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-08 23:49:31,773 - trading_system - INFO - Binance接口初始化完成
2025-03-08 23:49:31,776 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-08 23:49:31,778 - trading_system - INFO - 创建了exchange数据源
2025-03-08 23:49:31,780 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-08 23:49:31,782 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-08 23:49:32,337 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-08 23:49:32,338 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:07:05,500 - trading_system - INFO - Trading system initializing...
2025-03-09 00:07:05,513 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:07:05,514 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:07:05,515 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:07:05,517 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:07:05,521 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:07:05,522 - trading_system - INFO - 创建了local数据源
2025-03-09 00:07:05,548 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:07:06,121 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:07:06,123 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:07:06,124 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-09 00:07:06,126 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:07:06,127 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:07:06,129 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:07:06,798 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:07:06,799 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:07:06,800 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:07:06,975 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:08:01,645 - trading_system - INFO - Trading system initializing...
2025-03-09 00:08:01,656 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:08:01,657 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:08:01,658 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:08:01,658 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:08:01,661 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:08:01,662 - trading_system - INFO - 创建了local数据源
2025-03-09 00:08:01,686 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:08:02,260 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:08:02,262 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:08:02,264 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-09 00:08:02,265 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:08:02,266 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:08:02,267 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:08:02,856 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:08:02,857 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:08:02,858 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:08:03,032 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:11:03,904 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-09 00:11:03,906 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-09 00:11:03,973 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 00:11:03,974 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 00:11:03,992 - trading_system - INFO - Initiating system shutdown...
2025-03-09 00:11:04,002 - trading_system - INFO - Shutting down trading system...
2025-03-09 00:11:23,777 - trading_system - INFO - Trading system initializing...
2025-03-09 00:11:23,788 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:11:23,788 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:11:23,789 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:11:23,790 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:11:23,792 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:11:23,792 - trading_system - INFO - 创建了local数据源
2025-03-09 00:11:23,812 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:11:24,409 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:11:24,411 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:11:24,413 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-09 00:11:24,414 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:11:24,419 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:11:24,426 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:11:24,961 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:11:24,962 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:11:24,963 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:11:25,181 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:11:43,821 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-09 00:11:43,823 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-09 00:11:43,829 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 00:11:43,831 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 00:11:43,847 - trading_system - INFO - Initiating system shutdown...
2025-03-09 00:11:43,856 - trading_system - INFO - Shutting down trading system...
2025-03-09 00:12:11,945 - trading_system - INFO - Trading system initializing...
2025-03-09 00:12:11,956 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:12:11,957 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:12:11,957 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:12:11,958 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:12:11,960 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:12:11,960 - trading_system - INFO - 创建了local数据源
2025-03-09 00:12:11,985 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:12:12,522 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:12:12,523 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:12:12,524 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-09 00:12:12,525 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:12:12,526 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:12:12,526 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:12:13,041 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:12:13,042 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:12:13,042 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:12:13,206 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:12:24,495 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-09 00:12:33,143 - trading_system - INFO - Trading system initializing...
2025-03-09 00:12:33,157 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:12:33,157 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:12:33,158 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:12:33,159 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:12:33,162 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:12:33,163 - trading_system - INFO - 创建了local数据源
2025-03-09 00:12:33,190 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:12:33,817 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:12:33,818 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:12:33,821 - trading_system - INFO - ExchangeSource初始化完成，最大请求频率: 20/分钟
2025-03-09 00:12:33,822 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:12:33,823 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:12:33,824 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:12:34,443 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:12:34,444 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:12:34,445 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:12:34,681 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:14:57,551 - trading_system - INFO - Trading system initializing...
2025-03-09 00:14:57,559 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:14:57,560 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:14:57,561 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:14:57,561 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:14:57,563 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:14:57,564 - trading_system - INFO - 创建了local数据源
2025-03-09 00:14:57,586 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:14:58,137 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:14:58,138 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:14:58,140 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:14:58,141 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:14:58,143 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:14:58,144 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:14:58,680 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:14:58,681 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:14:58,682 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:14:58,862 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:15:59,099 - trading_system - INFO - Trading system initializing...
2025-03-09 00:15:59,108 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:15:59,109 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:15:59,110 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:15:59,112 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:15:59,113 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:15:59,114 - trading_system - INFO - 创建了local数据源
2025-03-09 00:15:59,134 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:15:59,661 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:15:59,663 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:15:59,664 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:15:59,665 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:15:59,666 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:15:59,668 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:16:00,178 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:16:00,179 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:16:00,180 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:16:00,324 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:16:14,657 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-09 00:16:16,744 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-09 00:16:21,711 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 00:16:27,774 - trading_system - INFO - Trading system initializing...
2025-03-09 00:16:27,783 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:16:27,784 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:16:27,785 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:16:27,785 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:16:27,787 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:16:27,788 - trading_system - INFO - 创建了local数据源
2025-03-09 00:16:27,810 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:16:28,327 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:16:28,328 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:16:28,329 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:16:28,329 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:16:28,330 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:16:28,330 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:16:28,899 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:16:28,899 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:16:28,900 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:16:29,046 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:17:29,470 - trading_system - INFO - Trading system initializing...
2025-03-09 00:17:29,480 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:17:29,481 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:17:29,482 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:17:29,483 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:17:29,485 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:17:29,486 - trading_system - INFO - 创建了local数据源
2025-03-09 00:17:29,505 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:17:30,077 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:17:30,079 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:17:30,080 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:17:30,081 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:17:30,082 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:17:30,083 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:17:30,602 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:17:30,603 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:17:30,604 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:17:30,752 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:21:49,409 - trading_system - INFO - Trading system initializing...
2025-03-09 00:21:49,420 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:21:49,421 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:21:49,422 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:21:49,422 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:21:49,424 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:21:49,425 - trading_system - INFO - 创建了local数据源
2025-03-09 00:21:49,447 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:21:50,013 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:21:50,015 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:21:50,017 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:21:50,018 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:21:50,020 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:21:50,021 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:21:50,616 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:21:50,616 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:21:50,617 - trading_system - INFO - 从交易所获取历史数据: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:21:50,765 - trading_system - INFO - 将BTC/USDT 1h的数据获取分为1个部分
2025-03-09 00:22:25,907 - trading_system - ERROR - 获取第1部分数据失败: Binance.fetch_ohlcv() takes from 1 to 4 positional arguments but 5 were given
2025-03-09 00:22:25,912 - trading_system - WARNING - 没有获取到BTC/USDT 1h的数据
2025-03-09 00:22:25,924 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 00:22:25,927 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 00:22:26,012 - trading_system - INFO - Initiating system shutdown...
2025-03-09 00:22:26,045 - trading_system - INFO - Shutting down trading system...
2025-03-09 00:38:12,010 - trading_system - INFO - Trading system initializing...
2025-03-09 00:38:12,023 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 00:38:12,024 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 00:38:12,024 - trading_system - INFO - Starting trading pipeline...
2025-03-09 00:38:12,025 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 00:38:12,027 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 00:38:12,027 - trading_system - INFO - 创建了local数据源
2025-03-09 00:38:12,049 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 00:38:12,569 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 00:38:12,570 - trading_system - INFO - Binance接口初始化完成
2025-03-09 00:38:12,570 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 00:38:12,570 - trading_system - INFO - 创建了exchange数据源
2025-03-09 00:38:12,570 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 00:38:12,571 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 00:38:13,145 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 00:38:13,146 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 00:38:13,147 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 00:38:13,335 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 00:38:13,337 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 00:38:13,337 - trading_system - INFO - 将请求分为2个块
2025-03-09 00:38:13,519 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:15,537 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:19,544 - trading_system - ERROR - 第1块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:19,545 - trading_system - ERROR - 获取第1块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:19,547 - trading_system - WARNING - 第2块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:21,557 - trading_system - WARNING - 第2块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:25,586 - trading_system - ERROR - 第2块数据获取失败，已达到最大重试次数: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:25,589 - trading_system - ERROR - 获取第2块数据时出错: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 00:38:25,590 - trading_system - WARNING - 没有获取到任何数据: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 00:38:25,594 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 00:38:25,597 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 00:38:25,599 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 00:38:25,616 - trading_system - INFO - Initiating system shutdown...
2025-03-09 00:38:25,621 - trading_system - ERROR - Error while closing AsyncExecutor: 'AsyncExecutor' object has no attribute '_active_tasks'
2025-03-09 00:38:25,727 - trading_system - INFO - System shutdown completed
2025-03-09 00:38:25,729 - trading_system - INFO - Shutting down trading system...
2025-03-09 01:01:14,723 - trading_system - INFO - Trading system initializing...
2025-03-09 01:01:14,735 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:01:14,736 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:01:14,736 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:01:14,737 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:01:14,739 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:01:14,740 - trading_system - INFO - 创建了local数据源
2025-03-09 01:01:14,764 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 01:01:15,293 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 01:01:15,293 - trading_system - INFO - Binance接口初始化完成
2025-03-09 01:01:15,294 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:01:15,295 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:01:15,295 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:01:15,296 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:01:15,977 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:01:15,978 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:01:15,979 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:01:16,234 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:01:16,235 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:01:16,236 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:01:16,420 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:01:18,437 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:27,731 - trading_system - INFO - Trading system initializing...
2025-03-09 01:29:27,746 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:29:27,746 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:29:27,747 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:29:27,748 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:29:27,750 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:29:27,751 - trading_system - INFO - 创建了local数据源
2025-03-09 01:29:27,776 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 01:29:28,380 - trading_system - INFO - 异步客户端初始化成功, 当前IP地址为: 89.213.179.134
2025-03-09 01:29:28,381 - trading_system - INFO - Binance接口初始化完成
2025-03-09 01:29:28,382 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:29:28,383 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:29:28,384 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:29:28,385 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:29:28,950 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:29:28,951 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:29:28,951 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:29:29,144 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:29:29,146 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:29:29,147 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:29:29,399 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:31,424 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:35,434 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:35,948 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:37,973 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:41,971 - trading_system - ERROR - Chunk 2/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:41,973 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:29:41,975 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 01:29:41,977 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 01:29:41,979 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 01:29:41,993 - trading_system - INFO - Initiating system shutdown...
2025-03-09 01:29:46,980 - trading_system - INFO - Trading system initializing...
2025-03-09 01:29:47,001 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:29:47,002 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:29:47,003 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:29:47,005 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:29:47,008 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:29:47,008 - trading_system - INFO - 创建了local数据源
2025-03-09 01:29:47,038 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:29:47,624 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:29:47,626 - trading_system - INFO - Binance interface initialized
2025-03-09 01:29:47,628 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:29:47,628 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:29:47,630 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:29:47,632 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:29:48,144 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:29:48,145 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:29:48,145 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:29:48,291 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:29:48,292 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:29:48,293 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:29:48,469 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:50,499 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:54,493 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:55,010 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:29:57,037 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:30:01,034 - trading_system - ERROR - Chunk 2/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:30:01,038 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:30:01,040 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 01:30:01,043 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 01:30:01,044 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 01:30:01,063 - trading_system - INFO - Initiating system shutdown...
2025-03-09 01:38:12,931 - trading_system - INFO - Trading system initializing...
2025-03-09 01:38:12,944 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:38:12,945 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:38:12,946 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:38:12,947 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:38:12,949 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:38:12,951 - trading_system - INFO - 创建了local数据源
2025-03-09 01:38:12,981 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:38:13,505 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:38:13,507 - trading_system - INFO - Binance interface initialized
2025-03-09 01:38:13,508 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:38:13,510 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:38:13,511 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:38:13,513 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:38:14,046 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:38:14,046 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:38:14,047 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:38:14,243 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:38:14,244 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:38:14,245 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:38:14,429 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:38:16,446 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:38:20,451 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:38:20,968 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:38:22,993 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:40,952 - trading_system - INFO - Trading system initializing...
2025-03-09 01:39:40,962 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:39:40,963 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:39:40,963 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:39:40,964 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:39:40,965 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:39:40,965 - trading_system - INFO - 创建了local数据源
2025-03-09 01:39:40,982 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:39:41,571 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:39:41,572 - trading_system - INFO - Binance interface initialized
2025-03-09 01:39:41,573 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:39:41,573 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:39:41,575 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:39:41,576 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:39:42,078 - trading_system - INFO - Trading system initializing...
2025-03-09 01:39:42,089 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:39:42,089 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:39:42,090 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:39:42,091 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:39:42,093 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:39:42,094 - trading_system - INFO - 创建了local数据源
2025-03-09 01:39:42,117 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:39:42,186 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:39:42,187 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:39:42,188 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:39:42,349 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:39:42,350 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:39:42,351 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:39:42,537 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:42,646 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:39:42,648 - trading_system - INFO - Binance interface initialized
2025-03-09 01:39:42,650 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:39:42,651 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:39:42,653 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:39:42,654 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:39:43,201 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:39:43,202 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:39:43,204 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:39:43,373 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:39:43,373 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:39:43,374 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:39:43,604 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:44,566 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:45,641 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:48,588 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:49,101 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:49,650 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:50,169 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:51,104 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:52,194 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:55,135 - trading_system - ERROR - Chunk 2/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:55,138 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:39:55,141 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 01:39:55,143 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 01:39:55,145 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 01:39:55,159 - trading_system - INFO - Initiating system shutdown...
2025-03-09 01:39:56,213 - trading_system - ERROR - Chunk 2/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:39:56,215 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:39:56,218 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 01:39:56,221 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 01:39:56,222 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 01:39:56,241 - trading_system - INFO - Initiating system shutdown...
2025-03-09 01:41:10,462 - trading_system - INFO - Trading system initializing...
2025-03-09 01:41:10,475 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:41:10,476 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:41:10,476 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:41:10,477 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:41:10,479 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:41:10,480 - trading_system - INFO - 创建了local数据源
2025-03-09 01:41:10,504 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:41:11,050 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:41:11,052 - trading_system - INFO - Binance interface initialized
2025-03-09 01:41:11,054 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:41:11,055 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:41:11,057 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:41:11,059 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:41:11,584 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:41:11,585 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:41:11,586 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:41:11,739 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:41:11,741 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:41:11,741 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:41:11,931 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:41:13,949 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:41:56,942 - trading_system - INFO - Trading system initializing...
2025-03-09 01:41:56,953 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:41:56,954 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:41:56,954 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:41:56,955 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:41:56,957 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:41:56,958 - trading_system - INFO - 创建了local数据源
2025-03-09 01:41:56,978 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:41:57,460 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:41:57,462 - trading_system - INFO - Binance interface initialized
2025-03-09 01:41:57,463 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:41:57,465 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:41:57,466 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:41:57,468 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:41:57,975 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:41:57,975 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:41:57,976 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:41:58,119 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:41:58,120 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:41:58,120 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:41:58,304 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:00,329 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:04,330 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:04,843 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:06,858 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:10,886 - trading_system - ERROR - Chunk 2/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:10,888 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:42:10,891 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 01:42:10,894 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 01:42:10,896 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 01:42:10,915 - trading_system - INFO - Initiating system shutdown...
2025-03-09 01:42:16,240 - trading_system - INFO - Trading system initializing...
2025-03-09 01:42:16,252 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:42:16,252 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:42:16,253 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:42:16,254 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:42:16,256 - trading_system - INFO - LocalSource初始化完成，数据路径: db/historical/
2025-03-09 01:42:16,257 - trading_system - INFO - 创建了local数据源
2025-03-09 01:42:16,275 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:42:16,820 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:42:16,822 - trading_system - INFO - Binance interface initialized
2025-03-09 01:42:16,823 - trading_system - INFO - ExchangeSource初始化完成, 最大请求频率: 20/分钟
2025-03-09 01:42:16,825 - trading_system - INFO - 创建了exchange数据源
2025-03-09 01:42:16,826 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:42:16,828 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:42:17,333 - trading_system - WARNING - 本地文件未找到或加载失败: BTC_USDT_1h
2025-03-09 01:42:17,333 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:42:17,334 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:42:17,463 - trading_system - INFO - Divided BTC/USDT 1h data fetch into 1 chunks
2025-03-09 01:42:17,465 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:42:17,466 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:42:17,649 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:42:19,672 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:47:44,156 - trading_system - INFO - Trading system initializing...
2025-03-09 01:47:44,167 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:47:44,168 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:47:44,169 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:47:44,170 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:47:44,172 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:47:44,172 - trading_system - INFO - Created local data source
2025-03-09 01:47:50,079 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:47:50,592 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:47:50,594 - trading_system - INFO - Binance interface initialized
2025-03-09 01:47:50,596 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:47:50,606 - trading_system - INFO - Created exchange data source
2025-03-09 01:47:50,607 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:47:50,610 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:47:51,136 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:47:51,137 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:47:51,138 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:47:51,280 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:47:51,281 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:47:51,282 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:47:51,459 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:47:53,482 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:48:59,452 - trading_system - INFO - Trading system initializing...
2025-03-09 01:48:59,472 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:48:59,473 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:48:59,473 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:48:59,474 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:48:59,476 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:48:59,477 - trading_system - INFO - Created local data source
2025-03-09 01:48:59,499 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:49:00,020 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:49:00,021 - trading_system - INFO - Binance interface initialized
2025-03-09 01:49:00,022 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:49:00,023 - trading_system - INFO - Created exchange data source
2025-03-09 01:49:00,023 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:49:00,025 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:49:00,518 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:49:00,519 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:49:00,520 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:49:10,483 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:49:49,802 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:50:21,480 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:50:21,748 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:50:23,766 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:50:27,783 - trading_system - ERROR - Chunk 1/2 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:50:28,298 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:50:30,296 - trading_system - WARNING - Chunk 2/2 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:50:34,121 - trading_system - INFO - Trading system initializing...
2025-03-09 01:50:34,138 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:50:34,139 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:50:34,141 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:50:34,142 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:50:34,145 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:50:34,146 - trading_system - INFO - Created local data source
2025-03-09 01:50:34,168 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:50:34,712 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:50:34,714 - trading_system - INFO - Binance interface initialized
2025-03-09 01:50:34,715 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:50:34,717 - trading_system - INFO - Created exchange data source
2025-03-09 01:50:34,719 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:50:34,720 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:50:35,288 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:50:35,289 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:50:35,290 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:50:58,505 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:50:58,507 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:51:20,488 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:52:04,934 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:52:15,056 - trading_system - INFO - Trading system initializing...
2025-03-09 01:52:15,065 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:52:15,065 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:52:15,067 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:52:15,067 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:52:15,069 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:52:15,070 - trading_system - INFO - Created local data source
2025-03-09 01:52:15,091 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:52:15,628 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:52:15,630 - trading_system - INFO - Binance interface initialized
2025-03-09 01:52:15,632 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:52:15,633 - trading_system - INFO - Created exchange data source
2025-03-09 01:52:15,634 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:52:15,636 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:52:16,148 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:52:16,149 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:52:16,150 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:52:16,288 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:52:16,289 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:52:16,290 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:53:32,710 - trading_system - INFO - Trading system initializing...
2025-03-09 01:53:32,721 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:53:32,721 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:53:32,722 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:53:32,723 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:53:32,725 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:53:32,726 - trading_system - INFO - Created local data source
2025-03-09 01:53:32,745 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:53:33,275 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:53:33,276 - trading_system - INFO - Binance interface initialized
2025-03-09 01:53:33,278 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:53:33,279 - trading_system - INFO - Created exchange data source
2025-03-09 01:53:33,281 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:53:33,282 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:53:33,814 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:53:33,815 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:53:33,815 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:53:33,959 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:53:33,960 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:53:33,961 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:54:33,932 - trading_system - INFO - Trading system initializing...
2025-03-09 01:54:33,944 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:54:33,945 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:54:33,945 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:54:33,946 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:54:33,948 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:54:33,948 - trading_system - INFO - Created local data source
2025-03-09 01:54:33,969 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:54:34,484 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:54:34,486 - trading_system - INFO - Binance interface initialized
2025-03-09 01:54:34,487 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:54:34,488 - trading_system - INFO - Created exchange data source
2025-03-09 01:54:34,489 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:54:34,490 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:54:35,011 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:54:35,012 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:54:35,012 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:54:35,153 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:54:35,154 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:54:35,155 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:55:09,760 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 01:56:12,860 - trading_system - INFO - Trading system initializing...
2025-03-09 01:56:12,872 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 01:56:12,872 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 01:56:12,873 - trading_system - INFO - Starting trading pipeline...
2025-03-09 01:56:12,873 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 01:56:12,876 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 01:56:12,877 - trading_system - INFO - Created local data source
2025-03-09 01:56:12,899 - trading_system - INFO - Sync client API key validation successful
2025-03-09 01:56:13,415 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 01:56:13,417 - trading_system - INFO - Binance interface initialized
2025-03-09 01:56:13,418 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 01:56:13,420 - trading_system - INFO - Created exchange data source
2025-03-09 01:56:13,421 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 01:56:13,422 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 01:56:13,951 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 01:56:13,952 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 01:56:13,952 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 01:56:14,102 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 01:56:14,103 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 01:56:14,104 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 01:56:37,760 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 02:27:56,402 - trading_system - INFO - Trading system initializing...
2025-03-09 02:27:56,413 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 02:27:56,414 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 02:27:56,415 - trading_system - INFO - Starting trading pipeline...
2025-03-09 02:27:56,415 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 02:27:56,417 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 02:27:56,418 - trading_system - INFO - Created local data source
2025-03-09 02:27:56,439 - trading_system - INFO - Sync client API key validation successful
2025-03-09 02:27:57,049 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 02:27:57,050 - trading_system - INFO - Binance interface initialized
2025-03-09 02:27:57,051 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 02:27:57,052 - trading_system - INFO - Created exchange data source
2025-03-09 02:27:57,052 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 02:27:57,053 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 02:27:57,591 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 02:27:57,592 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 02:27:57,593 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 02:27:57,739 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 02:27:57,741 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 02:27:57,741 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 02:28:11,449 - trading_system - WARNING - Chunk 1/2 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 08:57:16,400 - trading_system - INFO - Trading system initializing...
2025-03-09 08:57:16,413 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 08:57:16,413 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 08:57:16,414 - trading_system - INFO - Starting trading pipeline...
2025-03-09 08:57:16,415 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 08:57:16,417 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 08:57:16,418 - trading_system - INFO - Created local data source
2025-03-09 08:57:16,440 - trading_system - INFO - Sync client API key validation successful
2025-03-09 08:57:17,049 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 08:57:17,049 - trading_system - INFO - Binance interface initialized
2025-03-09 08:57:17,058 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 08:57:17,060 - trading_system - INFO - Created exchange data source
2025-03-09 08:57:17,061 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 08:57:17,061 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 08:57:17,997 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 08:57:17,998 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 08:57:17,998 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 08:57:18,322 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 08:57:18,323 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 08:57:18,323 - trading_system - INFO - Request divided into 2 chunks
2025-03-09 09:03:00,701 - trading_system - INFO - Trading system initializing...
2025-03-09 09:03:00,711 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:03:00,711 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:03:00,711 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:03:00,712 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:03:00,713 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:03:00,714 - trading_system - INFO - Created local data source
2025-03-09 09:03:00,732 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:03:01,252 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:03:01,253 - trading_system - INFO - Binance interface initialized
2025-03-09 09:03:01,254 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:03:01,255 - trading_system - INFO - Created exchange data source
2025-03-09 09:03:01,256 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:03:01,258 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:03:01,774 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:03:01,775 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:03:01,776 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:03:01,939 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:03:42,634 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:07:16,008 - trading_system - INFO - Trading system initializing...
2025-03-09 09:07:16,019 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:07:16,020 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:07:16,020 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:07:16,020 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:07:16,021 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:07:16,022 - trading_system - INFO - Created local data source
2025-03-09 09:07:16,042 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:07:16,595 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:07:16,596 - trading_system - INFO - Binance interface initialized
2025-03-09 09:07:16,598 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:07:16,599 - trading_system - INFO - Created exchange data source
2025-03-09 09:07:16,601 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:07:16,602 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:07:17,117 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:07:17,117 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:07:17,118 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:07:17,271 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:07:36,890 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 3600000 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:07:36,894 - trading_system - ERROR - Smart OHLCV fetch failed: cannot access local variable 'ms_per_candle' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 194, in smart_fetch_ohlcv
    chunks = self._calculate_fetch_chunks(start_dt, end_dt, timeframe_ms)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 531, in _calculate_fetch_chunks
    ms_per_candle = 60 * 1000 if ms_per_candle <= 0 else timeframe
                                 ^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'ms_per_candle' where it is not associated with a value

2025-03-09 09:07:36,896 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 09:07:36,896 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:07:36,898 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:07:36,916 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:08:00,002 - trading_system - INFO - Trading system initializing...
2025-03-09 09:08:00,021 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:08:00,022 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:08:00,023 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:08:00,023 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:08:00,026 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:08:00,026 - trading_system - INFO - Created local data source
2025-03-09 09:08:00,049 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:08:00,675 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:08:00,678 - trading_system - INFO - Binance interface initialized
2025-03-09 09:08:00,679 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:08:00,680 - trading_system - INFO - Created exchange data source
2025-03-09 09:08:00,682 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:08:00,683 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:08:01,275 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:08:01,276 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:08:01,276 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:08:01,467 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:08:01,468 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:08:15,981 - trading_system - INFO - Trading system initializing...
2025-03-09 09:08:15,990 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:08:15,990 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:08:15,991 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:08:15,991 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:08:15,992 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:08:15,993 - trading_system - INFO - Created local data source
2025-03-09 09:08:16,012 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:08:16,557 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:08:16,559 - trading_system - INFO - Binance interface initialized
2025-03-09 09:08:16,559 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:08:16,560 - trading_system - INFO - Created exchange data source
2025-03-09 09:08:16,561 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:08:16,562 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:08:17,125 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:08:17,126 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:08:17,126 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:08:17,298 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:08:17,299 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:08:29,506 - trading_system - INFO - Trading system initializing...
2025-03-09 09:08:29,517 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:08:29,517 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:08:29,518 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:08:29,518 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:08:29,520 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:08:29,520 - trading_system - INFO - Created local data source
2025-03-09 09:08:29,541 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:08:30,106 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:08:30,107 - trading_system - INFO - Binance interface initialized
2025-03-09 09:08:30,108 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:08:30,109 - trading_system - INFO - Created exchange data source
2025-03-09 09:08:30,110 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:08:30,111 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:08:30,618 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:08:30,619 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:08:30,619 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:08:30,765 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:08:30,766 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:10:56,479 - trading_system - INFO - Trading system initializing...
2025-03-09 09:10:56,495 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:10:56,495 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:10:56,495 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:10:56,496 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:10:56,497 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:10:56,498 - trading_system - INFO - Created local data source
2025-03-09 09:10:56,518 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:10:57,066 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:10:57,068 - trading_system - INFO - Binance interface initialized
2025-03-09 09:10:57,069 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:10:57,070 - trading_system - INFO - Created exchange data source
2025-03-09 09:10:57,072 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:10:57,074 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:10:57,612 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:10:57,613 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:10:57,614 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:10:57,756 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:10:57,757 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:11:26,561 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:14:51,151 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:15:09,868 - trading_system - INFO - Trading system initializing...
2025-03-09 09:15:09,879 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:15:09,880 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:15:09,880 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:15:09,880 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:15:09,882 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:15:09,882 - trading_system - INFO - Created local data source
2025-03-09 09:15:09,903 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:15:10,573 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:15:10,575 - trading_system - INFO - Binance interface initialized
2025-03-09 09:15:10,576 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:15:10,577 - trading_system - INFO - Created exchange data source
2025-03-09 09:15:10,578 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:15:10,579 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:15:11,100 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:15:11,101 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:15:11,102 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:15:11,262 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:15:11,263 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:15:13,747 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:19:15,245 - trading_system - INFO - Trading system initializing...
2025-03-09 09:19:15,255 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:19:15,255 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:19:15,257 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:19:15,257 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:19:15,259 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:19:15,259 - trading_system - INFO - Created local data source
2025-03-09 09:19:15,278 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:19:15,839 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:19:15,840 - trading_system - INFO - Binance interface initialized
2025-03-09 09:19:15,842 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:19:15,843 - trading_system - INFO - Created exchange data source
2025-03-09 09:19:15,844 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:19:15,845 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:19:16,420 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:19:16,420 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:19:16,422 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:19:16,650 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:19:16,651 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:19:19,661 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:19:25,018 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:20:10,125 - trading_system - INFO - Trading system initializing...
2025-03-09 09:20:10,134 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:20:10,134 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:20:10,135 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:20:10,135 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:20:10,137 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:20:10,137 - trading_system - INFO - Created local data source
2025-03-09 09:20:10,155 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:20:10,687 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:20:10,688 - trading_system - INFO - Binance interface initialized
2025-03-09 09:20:10,688 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:20:10,689 - trading_system - INFO - Created exchange data source
2025-03-09 09:20:10,690 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:20:10,690 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:20:11,191 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:20:11,192 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:20:11,192 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:20:11,366 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:20:11,367 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:20:20,142 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:23:30,972 - trading_system - INFO - Trading system initializing...
2025-03-09 09:23:31,078 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:23:31,079 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:23:31,080 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:23:31,080 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:23:31,083 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:23:31,084 - trading_system - INFO - Created local data source
2025-03-09 09:23:31,104 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:23:31,599 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:23:31,600 - trading_system - INFO - Binance interface initialized
2025-03-09 09:23:31,602 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:23:31,603 - trading_system - INFO - Created exchange data source
2025-03-09 09:23:31,604 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:23:31,604 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:23:32,095 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:23:32,095 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:23:32,096 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:23:32,294 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:23:32,295 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:23:32,296 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:23:43,947 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:23:47,986 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:24:07,948 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:24:43,037 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:24:47,246 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 09:24:47,248 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:24:47,249 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:24:47,265 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:24:56,700 - trading_system - INFO - Trading system initializing...
2025-03-09 09:24:56,715 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:24:56,716 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:24:56,717 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:24:56,718 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:24:56,720 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:24:56,720 - trading_system - INFO - Created local data source
2025-03-09 09:24:56,740 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:24:57,235 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:24:57,235 - trading_system - INFO - Binance interface initialized
2025-03-09 09:24:57,236 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:24:57,236 - trading_system - INFO - Created exchange data source
2025-03-09 09:24:57,237 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:24:57,238 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:24:57,740 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:24:57,741 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:24:57,743 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:24:57,891 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:24:57,893 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:24:57,893 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:25:52,440 - trading_system - INFO - Trading system initializing...
2025-03-09 09:25:52,450 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:25:52,451 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:25:52,452 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:25:52,452 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:25:52,453 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:25:52,454 - trading_system - INFO - Created local data source
2025-03-09 09:25:52,472 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:25:53,042 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:25:53,043 - trading_system - INFO - Binance interface initialized
2025-03-09 09:25:53,044 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:25:53,046 - trading_system - INFO - Created exchange data source
2025-03-09 09:25:53,046 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:25:53,047 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:25:53,555 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:25:53,556 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:25:53,557 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:25:53,706 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:25:53,707 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:25:53,707 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:26:40,108 - trading_system - INFO - Trading system initializing...
2025-03-09 09:26:40,119 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:26:40,119 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:26:40,119 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:26:40,120 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:26:40,122 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:26:40,123 - trading_system - INFO - Created local data source
2025-03-09 09:26:40,142 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:26:40,766 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:26:40,768 - trading_system - INFO - Binance interface initialized
2025-03-09 09:26:40,770 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:26:40,771 - trading_system - INFO - Created exchange data source
2025-03-09 09:26:40,772 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:26:40,774 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:26:41,274 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:26:41,274 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:26:41,275 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:26:41,405 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:26:41,406 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:26:41,406 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:26:43,695 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:27:03,480 - trading_system - INFO - Trading system initializing...
2025-03-09 09:27:03,490 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:27:03,490 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:27:03,492 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:27:03,492 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:27:03,494 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:27:03,494 - trading_system - INFO - Created local data source
2025-03-09 09:27:03,526 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:27:04,038 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:27:04,040 - trading_system - INFO - Binance interface initialized
2025-03-09 09:27:04,042 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:27:04,043 - trading_system - INFO - Created exchange data source
2025-03-09 09:27:04,045 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:27:04,046 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:27:04,548 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:27:04,548 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:27:04,549 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:27:04,677 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:27:04,677 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:27:04,678 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:27:16,564 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:27:26,829 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:27:41,926 - trading_system - INFO - Trading system initializing...
2025-03-09 09:27:41,935 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:27:41,936 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:27:41,936 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:27:41,937 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:27:41,938 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:27:41,938 - trading_system - INFO - Created local data source
2025-03-09 09:27:41,957 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:27:42,515 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:27:42,516 - trading_system - INFO - Binance interface initialized
2025-03-09 09:27:42,517 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:27:42,517 - trading_system - INFO - Created exchange data source
2025-03-09 09:27:42,518 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:27:42,518 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:27:43,014 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:27:43,014 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:27:43,015 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:27:43,147 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:27:43,148 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:27:43,148 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:27:47,878 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:27:56,362 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:28:02,362 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:28:02,363 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:28:02,366 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 09:28:02,367 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:28:02,368 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:28:02,379 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:28:08,405 - trading_system - INFO - Trading system initializing...
2025-03-09 09:28:08,415 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:28:08,415 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:28:08,416 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:28:08,416 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:28:08,417 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:28:08,418 - trading_system - INFO - Created local data source
2025-03-09 09:28:08,435 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:28:08,976 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:28:08,977 - trading_system - INFO - Binance interface initialized
2025-03-09 09:28:08,979 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:28:08,980 - trading_system - INFO - Created exchange data source
2025-03-09 09:28:08,982 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:28:08,983 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:28:09,488 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:28:09,489 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:28:09,489 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:28:09,668 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:28:09,669 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:28:09,670 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:28:11,703 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:28:16,007 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: Binance.fetch_ohlcv() got an unexpected keyword argument 'since'
2025-03-09 09:28:23,671 - trading_system - INFO - Trading system initializing...
2025-03-09 09:28:23,681 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:28:23,681 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:28:23,681 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:28:23,682 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:28:23,683 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:28:23,684 - trading_system - INFO - Created local data source
2025-03-09 09:28:23,702 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:28:24,204 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:28:24,205 - trading_system - INFO - Binance interface initialized
2025-03-09 09:28:24,206 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:28:24,206 - trading_system - INFO - Created exchange data source
2025-03-09 09:28:24,207 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:28:24,207 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:28:24,747 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:28:24,748 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:28:24,749 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:28:24,929 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:28:24,930 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:28:24,930 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:28:57,456 - trading_system - INFO - Trading system initializing...
2025-03-09 09:28:57,466 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:28:57,467 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:28:57,467 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:28:57,468 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:28:57,469 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:28:57,470 - trading_system - INFO - Created local data source
2025-03-09 09:28:57,489 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:28:58,032 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:28:58,032 - trading_system - INFO - Binance interface initialized
2025-03-09 09:28:58,033 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:28:58,033 - trading_system - INFO - Created exchange data source
2025-03-09 09:28:58,033 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:28:58,034 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:28:58,605 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:28:58,605 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:28:58,606 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:28:58,805 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:28:58,806 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:28:58,807 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:29:08,660 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:29:38,268 - trading_system - INFO - Trading system initializing...
2025-03-09 09:29:38,277 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:29:38,278 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:29:38,278 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:29:38,279 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:29:38,280 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:29:38,281 - trading_system - INFO - Created local data source
2025-03-09 09:29:38,300 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:29:38,812 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:29:38,812 - trading_system - INFO - Binance interface initialized
2025-03-09 09:29:38,813 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:29:38,814 - trading_system - INFO - Created exchange data source
2025-03-09 09:29:38,814 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:29:38,814 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:29:39,307 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:29:39,308 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:29:39,309 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:29:39,440 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:29:39,441 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:29:39,442 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:29:44,424 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:30:23,719 - trading_system - INFO - Trading system initializing...
2025-03-09 09:30:23,729 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:30:23,729 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:30:23,730 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:30:23,730 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:30:23,732 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:30:23,732 - trading_system - INFO - Created local data source
2025-03-09 09:30:23,748 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:30:24,406 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:30:24,408 - trading_system - INFO - Binance interface initialized
2025-03-09 09:30:24,410 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:30:24,411 - trading_system - INFO - Created exchange data source
2025-03-09 09:30:24,412 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:30:24,414 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:30:24,908 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:30:24,909 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:30:24,909 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:30:25,048 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:30:25,049 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:30:25,050 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:30:30,580 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:30:43,444 - trading_system - INFO - Trading system initializing...
2025-03-09 09:30:43,453 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:30:43,454 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:30:43,454 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:30:43,455 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:30:43,456 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:30:43,457 - trading_system - INFO - Created local data source
2025-03-09 09:30:43,476 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:30:44,008 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:30:44,011 - trading_system - INFO - Binance interface initialized
2025-03-09 09:30:44,012 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:30:44,013 - trading_system - INFO - Created exchange data source
2025-03-09 09:30:44,014 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:30:44,016 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:30:44,512 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:30:44,512 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:30:44,512 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:30:44,638 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:30:44,638 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:30:44,639 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:30:48,809 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:31:36,823 - trading_system - INFO - Trading system initializing...
2025-03-09 09:31:36,836 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:31:36,836 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:31:36,837 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:31:36,837 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:31:36,839 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:31:36,839 - trading_system - INFO - Created local data source
2025-03-09 09:31:36,858 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:31:37,466 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:31:37,469 - trading_system - INFO - Binance interface initialized
2025-03-09 09:31:37,470 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:31:37,471 - trading_system - INFO - Created exchange data source
2025-03-09 09:31:37,472 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:31:37,474 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:31:37,972 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:31:37,972 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:31:37,973 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:31:38,110 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:31:38,111 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:31:38,112 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:34:21,942 - trading_system - INFO - Trading system initializing...
2025-03-09 09:34:21,959 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:34:21,960 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:34:21,960 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:34:21,961 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:34:21,964 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:34:21,964 - trading_system - INFO - Created local data source
2025-03-09 09:34:21,983 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:34:22,646 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:34:22,647 - trading_system - INFO - Binance interface initialized
2025-03-09 09:34:22,649 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:34:22,652 - trading_system - INFO - Created exchange data source
2025-03-09 09:34:22,654 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:34:22,655 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:34:23,206 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:34:23,207 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:34:23,207 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:34:23,351 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:34:23,352 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:34:23,352 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:34:27,164 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:35:00,631 - trading_system - INFO - Trading system initializing...
2025-03-09 09:35:00,645 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:35:00,646 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:35:00,646 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:35:00,648 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:35:00,650 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:35:00,651 - trading_system - INFO - Created local data source
2025-03-09 09:35:00,671 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:35:01,177 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:35:01,178 - trading_system - INFO - Binance interface initialized
2025-03-09 09:35:01,180 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:35:01,180 - trading_system - INFO - Created exchange data source
2025-03-09 09:35:01,183 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:35:01,184 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:35:01,688 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:35:01,689 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:35:01,689 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:35:01,824 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:35:01,824 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:35:01,826 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:35:10,708 - trading_system - INFO - Trading system initializing...
2025-03-09 09:35:10,716 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:35:10,716 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:35:10,718 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:35:10,718 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:35:10,720 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:35:10,720 - trading_system - INFO - Created local data source
2025-03-09 09:35:10,738 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:35:11,421 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:35:11,422 - trading_system - INFO - Binance interface initialized
2025-03-09 09:35:11,424 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:35:11,426 - trading_system - INFO - Created exchange data source
2025-03-09 09:35:11,427 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:35:11,429 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:35:11,910 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:35:11,910 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:35:11,910 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:35:12,042 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:35:12,043 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:35:12,044 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:39:05,499 - trading_system - INFO - Trading system initializing...
2025-03-09 09:39:05,508 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:39:05,509 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:39:05,509 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:39:05,510 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:39:05,511 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:39:05,512 - trading_system - INFO - Created local data source
2025-03-09 09:39:05,530 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:39:06,074 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:39:06,075 - trading_system - INFO - Binance interface initialized
2025-03-09 09:39:06,076 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:39:06,076 - trading_system - INFO - Created exchange data source
2025-03-09 09:39:06,077 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:39:06,077 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:39:06,777 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:39:06,778 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:39:06,778 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:39:07,073 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:39:07,074 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:39:07,075 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:39:11,952 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:39:28,290 - trading_system - INFO - Trading system initializing...
2025-03-09 09:39:28,300 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:39:28,301 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:39:28,301 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:39:28,302 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:39:28,303 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:39:28,303 - trading_system - INFO - Created local data source
2025-03-09 09:39:28,322 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:39:28,859 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:39:28,860 - trading_system - INFO - Binance interface initialized
2025-03-09 09:39:28,861 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:39:28,862 - trading_system - INFO - Created exchange data source
2025-03-09 09:39:28,862 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:39:28,863 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:39:29,340 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:39:29,341 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:39:29,342 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:40:10,947 - trading_system - INFO - Trading system initializing...
2025-03-09 09:40:10,958 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:40:10,958 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:40:10,959 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:40:10,960 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:40:10,961 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:40:10,962 - trading_system - INFO - Created local data source
2025-03-09 09:40:10,983 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:40:11,583 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:40:11,584 - trading_system - INFO - Binance interface initialized
2025-03-09 09:40:11,585 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:40:11,586 - trading_system - INFO - Created exchange data source
2025-03-09 09:40:11,587 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:40:11,588 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:40:12,079 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:40:12,079 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:40:12,080 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:40:16,883 - trading_system - ERROR - Failed to get OHLCV data (BTC/USDT 1h): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:40:16,890 - trading_system - ERROR - Failed to fetch recent data for BTC/USDT: Expected coroutine, got DataFrame
2025-03-09 09:40:16,895 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:40:16,895 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:40:16,910 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:40:27,459 - trading_system - INFO - Trading system initializing...
2025-03-09 09:40:27,472 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:40:27,472 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:40:27,473 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:40:27,473 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:40:27,476 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:40:27,476 - trading_system - INFO - Created local data source
2025-03-09 09:40:27,504 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:40:28,050 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:40:28,052 - trading_system - INFO - Binance interface initialized
2025-03-09 09:40:28,053 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:40:28,053 - trading_system - INFO - Created exchange data source
2025-03-09 09:40:28,055 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:40:28,056 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:40:28,577 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:40:28,577 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:40:28,578 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:40:31,659 - trading_system - ERROR - Failed to get OHLCV data (BTC/USDT 1h): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:40:31,665 - trading_system - ERROR - Failed to fetch recent data for BTC/USDT: Expected coroutine, got DataFrame
2025-03-09 09:40:31,669 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:40:31,670 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:40:31,680 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:40:37,727 - trading_system - INFO - Trading system initializing...
2025-03-09 09:40:37,742 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:40:37,742 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:40:37,744 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:40:37,744 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:40:37,746 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:40:37,747 - trading_system - INFO - Created local data source
2025-03-09 09:40:37,773 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:40:38,346 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:40:38,347 - trading_system - INFO - Binance interface initialized
2025-03-09 09:40:38,349 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:40:38,350 - trading_system - INFO - Created exchange data source
2025-03-09 09:40:38,352 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:40:38,353 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:40:38,855 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:40:38,856 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:40:38,857 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:41:10,935 - trading_system - ERROR - Failed to get OHLCV data (BTC/USDT 1h): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:41:20,517 - trading_system - ERROR - Failed to fetch recent data for BTC/USDT: Expected coroutine, got DataFrame
2025-03-09 09:41:20,520 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:41:20,522 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:41:20,535 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:41:25,499 - trading_system - INFO - Trading system initializing...
2025-03-09 09:41:25,510 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:41:25,511 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:41:25,511 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:41:25,511 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:41:25,513 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:41:25,513 - trading_system - INFO - Created local data source
2025-03-09 09:41:25,531 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:41:26,146 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:41:26,148 - trading_system - INFO - Binance interface initialized
2025-03-09 09:41:26,150 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:41:26,151 - trading_system - INFO - Created exchange data source
2025-03-09 09:41:26,152 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:41:26,154 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:41:26,644 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:41:26,645 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:41:26,646 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:41:52,236 - trading_system - INFO - Trading system initializing...
2025-03-09 09:41:52,245 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:41:52,245 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:41:52,246 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:41:52,246 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:41:52,248 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:41:52,258 - trading_system - INFO - Created local data source
2025-03-09 09:41:52,276 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:41:52,761 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:41:52,762 - trading_system - INFO - Binance interface initialized
2025-03-09 09:41:52,764 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:41:52,765 - trading_system - INFO - Created exchange data source
2025-03-09 09:41:52,766 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:41:52,766 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:41:53,230 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:41:53,230 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:41:53,232 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:42:28,529 - trading_system - ERROR - Failed to get OHLCV data (BTC/USDT 1h): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:43:28,487 - trading_system - INFO - Trading system initializing...
2025-03-09 09:43:28,497 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:43:28,498 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:43:28,498 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:43:28,499 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:43:28,500 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:43:28,500 - trading_system - INFO - Created local data source
2025-03-09 09:43:28,520 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:43:29,120 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:43:29,121 - trading_system - INFO - Binance interface initialized
2025-03-09 09:43:29,122 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:43:29,123 - trading_system - INFO - Created exchange data source
2025-03-09 09:43:29,124 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:43:29,125 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:43:29,611 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:43:29,611 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:43:29,611 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:44:54,370 - trading_system - ERROR - Failed to get OHLCV data (BTC/USDT 1h): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:44:54,377 - trading_system - ERROR - Failed to fetch recent data for BTC/USDT: Expected coroutine, got DataFrame
2025-03-09 09:44:54,381 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:44:54,381 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:44:54,397 - trading_system - INFO - Initiating system shutdown...
2025-03-09 09:49:05,789 - trading_system - INFO - Trading system initializing...
2025-03-09 09:49:05,798 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:49:05,800 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:49:05,800 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:49:05,800 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:49:05,802 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:49:05,803 - trading_system - INFO - Created local data source
2025-03-09 09:49:05,823 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:49:06,368 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:49:06,370 - trading_system - INFO - Binance interface initialized
2025-03-09 09:49:06,370 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:49:06,370 - trading_system - INFO - Created exchange data source
2025-03-09 09:49:06,372 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:49:06,372 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:49:06,901 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:49:06,902 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:49:06,902 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:49:07,066 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:49:07,067 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:49:07,067 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:50:11,901 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:50:40,555 - trading_system - INFO - Trading system initializing...
2025-03-09 09:50:40,571 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:50:40,571 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:50:40,571 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:50:40,573 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:50:40,575 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:50:40,575 - trading_system - INFO - Created local data source
2025-03-09 09:50:40,594 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:50:41,152 - trading_system - INFO - Async client initialized, current IP: 89.213.179.134
2025-03-09 09:50:41,153 - trading_system - INFO - Binance interface initialized
2025-03-09 09:50:41,155 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:50:41,157 - trading_system - INFO - Created exchange data source
2025-03-09 09:50:41,158 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:50:41,160 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:50:41,689 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:50:41,689 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:50:41,690 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:50:41,843 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:50:41,844 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:50:41,845 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:54:28,769 - trading_system - INFO - Trading system initializing...
2025-03-09 09:54:28,777 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:54:28,777 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:54:28,778 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:54:28,778 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:54:28,781 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:54:28,781 - trading_system - INFO - Created local data source
2025-03-09 09:54:28,815 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:54:28,815 - trading_system - INFO - Async client initialized
2025-03-09 09:54:29,367 - trading_system - INFO - current IP: 89.213.179.134
2025-03-09 09:54:29,369 - trading_system - INFO - Binance interface initialized
2025-03-09 09:54:29,370 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:54:29,371 - trading_system - INFO - Created exchange data source
2025-03-09 09:54:29,372 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:54:29,374 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:54:29,864 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:54:29,865 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:54:29,865 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:54:29,997 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:54:29,998 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:54:29,998 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:57:07,100 - trading_system - INFO - Trading system initializing...
2025-03-09 09:57:07,113 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 09:57:07,114 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 09:57:07,114 - trading_system - INFO - Starting trading pipeline...
2025-03-09 09:57:07,115 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 09:57:07,117 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 09:57:07,117 - trading_system - INFO - Created local data source
2025-03-09 09:57:07,154 - trading_system - INFO - Sync client API key validation successful
2025-03-09 09:57:07,155 - trading_system - INFO - Async client initialized
2025-03-09 09:57:07,704 - trading_system - INFO - current IP: 89.213.179.134
2025-03-09 09:57:07,706 - trading_system - INFO - Binance interface initialized
2025-03-09 09:57:07,708 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 09:57:07,709 - trading_system - INFO - Created exchange data source
2025-03-09 09:57:07,710 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 09:57:07,711 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 09:57:08,209 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 09:57:08,210 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 09:57:08,210 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 09:57:08,352 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 09:57:08,353 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:57:08,353 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 09:57:08,617 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:57:10,633 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:57:14,637 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 09:57:14,639 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 09:57:14,640 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 09:57:14,642 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 09:57:14,643 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 09:57:14,658 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:26:50,522 - trading_system - INFO - Trading system initializing...
2025-03-09 10:26:50,535 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:26:50,535 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:26:50,536 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:26:50,536 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:26:50,537 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:26:50,538 - trading_system - INFO - Created local data source
2025-03-09 10:26:50,576 - trading_system - INFO - Sync client API key validation successful
2025-03-09 10:26:50,577 - trading_system - INFO - Async client initialized
2025-03-09 10:26:51,050 - trading_system - INFO - current IP: 89.213.179.134
2025-03-09 10:26:51,051 - trading_system - INFO - Binance interface initialized
2025-03-09 10:26:51,052 - trading_system - ERROR - Connection test failed: 'Binance' object has no attribute 'load_markets'
2025-03-09 10:26:51,052 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 10:26:51,054 - trading_system - INFO - Created exchange data source
2025-03-09 10:26:51,054 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 10:26:51,055 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:26:51,575 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:26:51,576 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 10:26:51,577 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 10:26:51,724 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 10:26:51,726 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: 'NoneType' object has no attribute 'smart_fetch_ohlcv'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 397, in fetch_historical
    df = await self.exchange.smart_fetch_ohlcv(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'smart_fetch_ohlcv'

2025-03-09 10:26:51,727 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 10:26:51,728 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:26:51,734 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:28:07,771 - trading_system - INFO - Trading system initializing...
2025-03-09 10:28:07,781 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:28:07,781 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:28:07,782 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:28:07,782 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:28:07,783 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:28:07,784 - trading_system - INFO - Created local data source
2025-03-09 10:28:11,816 - trading_system - INFO - Sync client API key validation successful
2025-03-09 10:28:11,817 - trading_system - INFO - Async client initialized
2025-03-09 10:28:12,315 - trading_system - INFO - current IP: 89.213.179.134
2025-03-09 10:28:12,315 - trading_system - INFO - Binance interface initialized
2025-03-09 10:28:12,316 - trading_system - ERROR - Connection test failed: 'Binance' object has no attribute 'load_markets'
2025-03-09 10:35:02,533 - trading_system - INFO - Trading system initializing...
2025-03-09 10:35:02,543 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:35:02,545 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:35:02,546 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:35:02,546 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:35:02,547 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:35:02,548 - trading_system - INFO - Created local data source
2025-03-09 10:35:02,588 - trading_system - INFO - Sync client API key validation successful
2025-03-09 10:35:02,589 - trading_system - INFO - Async client initialized
2025-03-09 10:35:03,220 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 10:35:03,220 - trading_system - INFO - Binance interface initialized
2025-03-09 10:35:03,222 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 10:35:03,224 - trading_system - INFO - Created exchange data source
2025-03-09 10:35:03,226 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 10:35:03,227 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:35:03,758 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:35:03,758 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 10:35:03,758 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 10:35:03,905 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 10:35:03,906 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 10:35:03,907 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 10:35:04,066 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:35:06,090 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:27,344 - trading_system - INFO - Trading system initializing...
2025-03-09 10:37:27,355 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:37:27,355 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:37:27,356 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:37:27,356 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:37:27,358 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:37:27,359 - trading_system - INFO - Created local data source
2025-03-09 10:37:27,395 - trading_system - INFO - Sync client API key validation successful
2025-03-09 10:37:27,395 - trading_system - INFO - Async client initialized
2025-03-09 10:37:27,396 - trading_system - INFO - Loading markets data...
2025-03-09 10:37:27,397 - trading_system - ERROR - Failed to load markets: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:27,398 - trading_system - INFO - Retrying with public API (no authentication)...
2025-03-09 10:37:27,449 - trading_system - ERROR - Public API connection also failed: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:27,963 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 10:37:27,964 - trading_system - INFO - Binance interface initialized
2025-03-09 10:37:27,965 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 10:37:27,966 - trading_system - INFO - Created exchange data source
2025-03-09 10:37:27,966 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 10:37:27,967 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:37:28,598 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:37:28,598 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 10:37:28,599 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 10:37:28,841 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 10:37:28,842 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 10:37:28,842 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 10:37:29,038 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:31,047 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:35,042 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 10:37:35,043 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 10:37:35,044 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 10:37:35,044 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 10:37:35,045 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:37:35,052 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:49:14,518 - trading_system - INFO - Trading system initializing...
2025-03-09 10:49:14,534 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:49:14,535 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:49:14,536 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:49:14,536 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:49:14,540 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:49:14,541 - trading_system - INFO - Created local data source
2025-03-09 10:49:32,961 - trading_system - ERROR - Failed to connect to Binance: unsupported operand type(s) for /: 'NoneType' and 'int'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 112, in _connect_exchange
    data = self.exchange.fetch_ohlcv(symbol=symbol, timeframe=time_interval, since=1701388800000, limit= 10)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\binance.py", line 3281, in fetch_ohlcv
    self.load_markets()
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\base\exchange.py", line 1463, in load_markets
    currencies = self.fetch_currencies()
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\binance.py", line 1880, in fetch_currencies
    response = self.sapiGetCapitalConfigGetall(params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\base\types.py", line 34, in unbound_method
    return _self.request(self.path, self.api, self.method, params, config=self.config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\binance.py", line 8166, in request
    response = self.fetch2(path, api, method, params, headers, body, config)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\base\exchange.py", line 3350, in fetch2
    return self.fetch(request['url'], request['method'], request['headers'], request['body'])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\ccxt\base\exchange.py", line 601, in fetch
    timeout=(self.timeout / 1000),
             ~~~~~~~~~~~~~^~~~~~
TypeError: unsupported operand type(s) for /: 'NoneType' and 'int'

2025-03-09 10:54:58,865 - trading_system - INFO - Trading system initializing...
2025-03-09 10:54:58,875 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:54:58,876 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:54:58,876 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:54:58,876 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:54:58,878 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:54:58,878 - trading_system - INFO - Created local data source
2025-03-09 10:54:58,879 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 10:54:58,882 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 10:54:58,883 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 10:54:58,883 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:54:59,412 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:54:59,412 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:54:59,418 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:56:55,738 - trading_system - INFO - Trading system initializing...
2025-03-09 10:56:55,757 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:56:55,758 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:56:55,759 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:56:55,760 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:56:55,761 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:56:55,762 - trading_system - INFO - Created local data source
2025-03-09 10:57:14,390 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 10:57:14,398 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 10:57:14,400 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 10:57:14,401 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:57:14,917 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:57:14,917 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:57:14,922 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:57:41,838 - trading_system - INFO - Trading system initializing...
2025-03-09 10:57:41,848 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:57:41,848 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:57:41,849 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:57:41,850 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:57:41,851 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:57:41,851 - trading_system - INFO - Created local data source
2025-03-09 10:58:37,376 - trading_system - INFO - Trading system initializing...
2025-03-09 10:58:37,398 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:58:37,399 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:58:37,399 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:58:37,400 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:58:37,401 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:58:37,402 - trading_system - INFO - Created local data source
2025-03-09 10:59:07,400 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 10:59:07,405 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 10:59:07,406 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 10:59:07,407 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:59:08,015 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:59:08,015 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:59:08,022 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:59:16,778 - trading_system - INFO - Trading system initializing...
2025-03-09 10:59:16,786 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:59:16,787 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:59:16,788 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:59:16,789 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:59:16,791 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:59:16,792 - trading_system - INFO - Created local data source
2025-03-09 10:59:26,276 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 10:59:26,284 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 10:59:26,286 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 10:59:26,287 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 10:59:26,837 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 10:59:26,838 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 10:59:26,843 - trading_system - INFO - Initiating system shutdown...
2025-03-09 10:59:54,360 - trading_system - INFO - Trading system initializing...
2025-03-09 10:59:54,378 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 10:59:54,379 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 10:59:54,380 - trading_system - INFO - Starting trading pipeline...
2025-03-09 10:59:54,381 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 10:59:54,383 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 10:59:54,385 - trading_system - INFO - Created local data source
2025-03-09 11:02:24,225 - trading_system - INFO - Trading system initializing...
2025-03-09 11:02:24,235 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:02:24,236 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:02:24,236 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:02:24,236 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:02:24,238 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:02:24,238 - trading_system - INFO - Created local data source
2025-03-09 11:03:06,057 - trading_system - INFO - Trading system initializing...
2025-03-09 11:03:06,066 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:03:06,066 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:03:06,067 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:03:06,067 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:03:06,070 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:03:06,070 - trading_system - INFO - Created local data source
2025-03-09 11:03:08,419 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 11:03:08,428 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 11:03:08,430 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 11:03:08,431 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:03:08,936 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:03:08,937 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:03:08,942 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:03:15,482 - trading_system - INFO - Trading system initializing...
2025-03-09 11:03:15,491 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:03:15,491 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:03:15,492 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:03:15,492 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:03:15,494 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:03:15,495 - trading_system - INFO - Created local data source
2025-03-09 11:03:15,495 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 11:03:15,498 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 11:03:15,499 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 11:03:15,499 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:03:15,969 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:03:15,969 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:03:15,984 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:03:26,691 - trading_system - INFO - Trading system initializing...
2025-03-09 11:03:26,703 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:03:26,703 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:03:26,703 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:03:26,704 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:03:26,705 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:03:26,706 - trading_system - INFO - Created local data source
2025-03-09 11:03:30,229 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 11:03:30,234 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 95, in _connect_exchange
    headers = self.config.get('api', 'headers', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 11:03:30,236 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 11:03:30,237 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:03:30,712 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:03:30,713 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:03:30,720 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:03:35,317 - trading_system - INFO - Trading system initializing...
2025-03-09 11:03:35,328 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:03:35,329 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:03:35,329 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:03:35,330 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:03:35,331 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:03:35,332 - trading_system - INFO - Created local data source
2025-03-09 11:03:40,476 - trading_system - INFO - Trading system initializing...
2025-03-09 11:03:40,486 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:03:40,488 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:03:40,488 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:03:40,489 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:03:40,489 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:03:40,489 - trading_system - INFO - Created local data source
2025-03-09 11:04:11,466 - trading_system - ERROR - Failed to connect to Binance: unhashable type: 'dict'
2025-03-09 11:04:11,476 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 46, in __init__
    self._connect_exchange(load_market, retry_with_no_auth)
  File "D:\jacky\crypto_py\src\utils\error_handling.py", line 85, in sync_wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 100, in _connect_exchange
    proxies = self.config.get('proxies', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 11:04:11,479 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 11:04:11,480 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:04:12,058 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:04:12,058 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:04:12,066 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:11:12,508 - trading_system - INFO - Trading system initializing...
2025-03-09 11:11:12,517 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:11:12,517 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:11:12,518 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:11:12,518 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:11:12,519 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:11:12,520 - trading_system - INFO - Created local data source
2025-03-09 11:11:21,094 - trading_system - INFO - API credentials found in configuration
2025-03-09 11:11:31,155 - trading_system - INFO - Trading system initializing...
2025-03-09 11:11:31,168 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:11:31,168 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:11:31,169 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:11:31,170 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:11:31,172 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:11:31,172 - trading_system - INFO - Created local data source
2025-03-09 11:12:11,453 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:12:11,455 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:12:12,001 - trading_system - INFO - Connection successful. Server time synchronized (diff: 457ms)
2025-03-09 11:12:12,472 - trading_system - INFO - Authentication successful
2025-03-09 11:12:12,954 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:12:12,955 - trading_system - INFO - Binance interface initialized
2025-03-09 11:12:12,957 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:12:12,958 - trading_system - INFO - Created exchange data source
2025-03-09 11:12:12,960 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:12:12,961 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:12:13,482 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:12:13,484 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:12:13,485 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:12:13,624 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:12:13,625 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:12:13,625 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:12:16,800 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741489933627&recvWindow=60000&signature=46234f18e088e834abac021f264d71e4a644a2c0cf6c90d6140e16bbbe66aa51
2025-03-09 11:12:21,885 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741489938875&recvWindow=60000&signature=73350865e6be9a177520a0b7ceffd0a7406a500708738356bdd191ca385f28df
2025-03-09 11:12:28,979 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741489945967&recvWindow=60000&signature=46cc7eb8df6197d9ee1c4042a6066bb9e8aa9ac4ecba28f5122e7b100482c5fb
2025-03-09 11:12:28,983 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:12:28,987 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 11:12:28,992 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 11:12:28,997 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:12:29,042 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:13:05,868 - trading_system - INFO - Trading system initializing...
2025-03-09 11:13:05,879 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:13:05,880 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:13:05,880 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:13:05,881 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:13:05,882 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:13:05,883 - trading_system - INFO - Created local data source
2025-03-09 11:13:05,883 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:13:05,885 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:13:29,230 - trading_system - INFO - Trading system initializing...
2025-03-09 11:13:29,240 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:13:29,240 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:13:29,241 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:13:29,241 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:13:29,243 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:13:29,243 - trading_system - INFO - Created local data source
2025-03-09 11:13:29,243 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:13:29,244 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:13:29,673 - trading_system - INFO - Connection successful. Server time synchronized (diff: 466ms)
2025-03-09 11:14:04,358 - trading_system - INFO - Authentication successful
2025-03-09 11:14:32,598 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:14:32,602 - trading_system - INFO - Binance interface initialized
2025-03-09 11:14:32,604 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:14:32,605 - trading_system - INFO - Created exchange data source
2025-03-09 11:14:32,607 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:14:32,608 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:14:33,119 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:14:33,120 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:14:33,121 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:14:33,242 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:14:33,243 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:14:33,243 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:14:36,415 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490073245&recvWindow=60000&signature=93b10f0b78763d8aae44b31791577c93d120eb5ec472054915ee21ff2663e6cc
2025-03-09 11:14:41,497 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490078479&recvWindow=60000&signature=f3d6fe93d4c52c74373be655ab5b87377b053155f98891fdf0fe86c25f52ccb4
2025-03-09 11:16:02,521 - trading_system - INFO - Trading system initializing...
2025-03-09 11:16:02,533 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:16:02,535 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:16:02,535 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:16:02,535 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:16:02,538 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:16:02,539 - trading_system - INFO - Created local data source
2025-03-09 11:16:02,539 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:16:02,540 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:17:04,559 - trading_system - INFO - Connection successful. Server time synchronized (diff: 463ms)
2025-03-09 11:17:04,935 - trading_system - INFO - Authentication successful
2025-03-09 11:17:05,470 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:17:05,471 - trading_system - INFO - Binance interface initialized
2025-03-09 11:17:05,472 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:17:05,473 - trading_system - INFO - Created exchange data source
2025-03-09 11:17:05,475 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:17:05,476 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:17:05,992 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:17:05,992 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:17:05,993 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:17:06,139 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:17:06,140 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:17:06,141 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:17:09,364 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490226142&recvWindow=60000&signature=3656c3295366f095af3b6c09e9558e8086dacd477bc74ccc85c8a59f5d16ee51
2025-03-09 11:17:14,458 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 2/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490231442&recvWindow=60000&signature=4771cb2685cb00e5f7ca18c797b9fa5345807755bfaa2441816dd782a4fdbfe6
2025-03-09 11:17:21,540 - trading_system - ERROR - Chunk 1/1 fetch failed after max retries: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490238526&recvWindow=60000&signature=a4972954c6494d263ce84402e69595cb4ec7cd92924e9d24e851b1200f2e7a9f
2025-03-09 11:17:21,543 - trading_system - WARNING - No data retrieved for: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:17:21,545 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 11:17:21,547 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 11:17:21,548 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-12-01-2023-12-31
2025-03-09 11:17:21,568 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:17:48,479 - trading_system - INFO - Trading system initializing...
2025-03-09 11:17:48,490 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:17:48,490 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:17:48,491 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:17:48,491 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:17:48,492 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:17:48,493 - trading_system - INFO - Created local data source
2025-03-09 11:17:48,494 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:17:48,494 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:17:48,849 - trading_system - INFO - Connection successful. Server time synchronized (diff: 457ms)
2025-03-09 11:17:49,193 - trading_system - INFO - Authentication successful
2025-03-09 11:17:49,716 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:17:49,717 - trading_system - INFO - Binance interface initialized
2025-03-09 11:17:49,718 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:17:49,719 - trading_system - INFO - Created exchange data source
2025-03-09 11:17:49,721 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:17:49,722 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:17:50,201 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:17:50,201 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:17:50,202 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:17:50,329 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:17:50,330 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:17:50,331 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:18:05,917 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490282750&recvWindow=60000&signature=8f68e1060ffc15560f893056c3a25a09619c657d8551239e8a48cb728f091710
2025-03-09 11:19:15,552 - trading_system - INFO - Trading system initializing...
2025-03-09 11:19:15,559 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:19:15,560 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:19:15,560 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:19:15,562 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:19:15,563 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:19:15,563 - trading_system - INFO - Created local data source
2025-03-09 11:20:56,469 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:20:56,470 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:20:56,811 - trading_system - INFO - Connection successful. Server time synchronized (diff: 459ms)
2025-03-09 11:20:57,124 - trading_system - INFO - Authentication successful
2025-03-09 11:20:57,615 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:20:57,616 - trading_system - INFO - Binance interface initialized
2025-03-09 11:20:57,618 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:20:57,619 - trading_system - INFO - Created exchange data source
2025-03-09 11:20:57,620 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:20:57,620 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:20:58,153 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:20:58,153 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:20:58,153 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:20:58,309 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:20:58,310 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:20:58,310 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:21:58,104 - trading_system - WARNING - Chunk 1/1 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741490514897&recvWindow=60000&signature=3582bce4d15e8cbbd3550ce5d0c2e71318e4dd73f79dd5c82f53778b204db2de
2025-03-09 11:25:54,624 - trading_system - INFO - Trading system initializing...
2025-03-09 11:25:54,634 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:25:54,634 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:25:54,634 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:25:54,635 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:25:54,636 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:25:54,637 - trading_system - INFO - Created local data source
2025-03-09 11:26:28,882 - trading_system - INFO - Trading system initializing...
2025-03-09 11:26:28,892 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:26:28,892 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:26:28,893 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:26:28,893 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:26:28,895 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:26:28,895 - trading_system - INFO - Created local data source
2025-03-09 11:26:28,896 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:26:28,897 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:26:29,278 - trading_system - INFO - Connection successful. Server time synchronized (diff: 464ms)
2025-03-09 11:26:29,643 - trading_system - INFO - Authentication successful
2025-03-09 11:26:30,222 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:26:30,224 - trading_system - INFO - Binance interface initialized
2025-03-09 11:26:30,225 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:26:30,226 - trading_system - INFO - Created exchange data source
2025-03-09 11:26:30,227 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:26:30,229 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:26:30,758 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:26:30,758 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-12-01-2023-12-31，尝试从交易所下载
2025-03-09 11:26:30,759 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-12-01 - 2023-12-31
2025-03-09 11:26:30,897 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-12-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:26:30,898 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-12-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:26:30,898 - trading_system - INFO - Request divided into 1 chunks
2025-03-09 11:27:03,082 - trading_system - INFO - Trading system initializing...
2025-03-09 11:27:03,092 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:27:03,093 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:27:03,093 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:27:03,094 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:27:03,096 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:27:03,096 - trading_system - INFO - Created local data source
2025-03-09 11:36:34,300 - trading_system - INFO - Trading system initializing...
2025-03-09 11:36:34,311 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:36:34,311 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:36:34,312 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:36:34,313 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:36:34,314 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:36:34,315 - trading_system - INFO - Created local data source
2025-03-09 11:36:34,323 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:36:34,325 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:36:34,326 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:36:35,045 - trading_system - INFO - Connection successful. Server time synchronized (diff: 571ms)
2025-03-09 11:36:35,798 - trading_system - INFO - Authentication successful
2025-03-09 11:36:36,298 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:36:36,299 - trading_system - INFO - Binance interface initialized
2025-03-09 11:36:36,300 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:36:36,301 - trading_system - INFO - Created exchange data source
2025-03-09 11:36:36,302 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:36:36,303 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:36:36,849 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: simple
2025-03-09 11:36:36,854 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:36:36,854 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-09 11:38:22,478 - trading_system - INFO - Trading system initializing...
2025-03-09 11:38:22,486 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:38:22,487 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:38:22,488 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:38:22,489 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:38:22,490 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:38:22,491 - trading_system - INFO - Created local data source
2025-03-09 11:38:22,501 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:38:22,501 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:38:22,502 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:38:23,258 - trading_system - INFO - Connection successful. Server time synchronized (diff: 572ms)
2025-03-09 11:38:23,555 - trading_system - INFO - Authentication successful
2025-03-09 11:38:24,032 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:38:24,034 - trading_system - INFO - Binance interface initialized
2025-03-09 11:38:24,036 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:38:24,037 - trading_system - INFO - Created exchange data source
2025-03-09 11:38:24,038 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:38:24,039 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:38:24,566 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: simple
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: simple

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: simple
2025-03-09 11:38:24,570 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:38:24,571 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-09 11:39:27,634 - trading_system - INFO - Trading system initializing...
2025-03-09 11:39:27,645 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:39:27,647 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:39:27,647 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:39:27,649 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:39:27,650 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:39:27,651 - trading_system - INFO - Created local data source
2025-03-09 11:39:27,661 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:39:27,661 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:39:27,662 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:39:28,051 - trading_system - INFO - Connection successful. Server time synchronized (diff: 472ms)
2025-03-09 11:39:28,362 - trading_system - INFO - Authentication successful
2025-03-09 11:39:28,930 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:39:28,932 - trading_system - INFO - Binance interface initialized
2025-03-09 11:39:28,933 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:39:28,934 - trading_system - INFO - Created exchange data source
2025-03-09 11:39:28,936 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:39:28,937 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:39:29,453 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: dualma
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: dualma

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: dualma

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: dualma
2025-03-09 11:39:29,458 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:39:29,458 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-09 11:39:45,855 - trading_system - INFO - Trading system initializing...
2025-03-09 11:39:45,865 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:39:45,866 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:39:45,866 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:39:45,867 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:39:45,868 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:39:45,868 - trading_system - INFO - Created local data source
2025-03-09 11:39:45,877 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:39:45,878 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:39:45,878 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:39:46,233 - trading_system - INFO - Connection successful. Server time synchronized (diff: 470ms)
2025-03-09 11:39:46,621 - trading_system - INFO - Authentication successful
2025-03-09 11:39:47,149 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:39:47,151 - trading_system - INFO - Binance interface initialized
2025-03-09 11:39:47,152 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:39:47,153 - trading_system - INFO - Created exchange data source
2025-03-09 11:39:47,154 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:39:47,155 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:39:47,653 - trading_system - ERROR - Error in trading pipeline: 创建 backtest 失败: 未知策略: dualma
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 146, in _get_concrete_class
    return await self._load_class_from_path(name, BaseStrategy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 303, in _load_class_from_path
    raise ValueError(f"未知类型: {name}")
ValueError: 未知类型: dualma

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 222, in _get_or_create
    await instance.initialize()
  File "D:\jacky\crypto_py\src\mode\backtest_trading_mode.py", line 29, in initialize
    self.strategy = await self.strategy_factory.create(strategy_name, strategy_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 70, in create
    concrete_class = await self._get_concrete_class(name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\strategy\strategy_factory.py", line 152, in _get_concrete_class
    raise ValueError(f"未知策略: {name}")
ValueError: 未知策略: dualma

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\core\core.py", line 65, in run_pipeline
    self.trading_mode = await self.mode_factory.create(self.mode)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 73, in create
    return await self._get_or_create(name, concrete_class, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\abstract_factory.py", line 231, in _get_or_create
    raise ValueError(f"创建 {name} 失败: {e}")
ValueError: 创建 backtest 失败: 未知策略: dualma
2025-03-09 11:39:47,664 - trading_system - INFO - Initiating system shutdown...
2025-03-09 11:39:47,666 - trading_system - WARNING - Trading mode not properly initialized, skipping shutdown
2025-03-09 11:40:26,506 - trading_system - INFO - Trading system initializing...
2025-03-09 11:40:26,514 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:40:26,516 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:40:26,517 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:40:26,517 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:40:26,520 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:40:26,520 - trading_system - INFO - Created local data source
2025-03-09 11:40:26,529 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:40:26,530 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:40:26,530 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:40:26,858 - trading_system - INFO - Connection successful. Server time synchronized (diff: 473ms)
2025-03-09 11:40:27,147 - trading_system - INFO - Authentication successful
2025-03-09 11:40:27,711 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:40:27,712 - trading_system - INFO - Binance interface initialized
2025-03-09 11:40:27,713 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:40:27,714 - trading_system - INFO - Created exchange data source
2025-03-09 11:40:27,716 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:40:27,717 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:40:28,200 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:40:28,200 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2022-01-01-2023-12-31，尝试从交易所下载
2025-03-09 11:40:28,201 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2022-01-01 - 2023-12-31
2025-03-09 11:40:28,361 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2022-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:40:28,361 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2022-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:40:28,362 - trading_system - INFO - Request divided into 9 chunks
2025-03-09 11:40:55,020 - trading_system - WARNING - Chunk 1/9 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741491633777&recvWindow=60000&signature=a79b1ca363e9234262ef2dee29f95f84b80bb0dab277f66d18ce86c5537f5aeb
2025-03-09 11:41:18,164 - trading_system - WARNING - Chunk 1/9 fetch failed, retry 2/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741491657098&recvWindow=60000&signature=c2cb07376d604520c6a89e5f086fb964a7d87cddd78c85acb11f96098a8b9ce6
2025-03-09 11:41:25,910 - trading_system - INFO - Trading system initializing...
2025-03-09 11:41:25,923 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:41:25,924 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:41:25,924 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:41:25,925 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:41:25,926 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:41:25,927 - trading_system - INFO - Created local data source
2025-03-09 11:41:25,936 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:41:25,936 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:41:25,937 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:41:26,324 - trading_system - INFO - Connection successful. Server time synchronized (diff: 477ms)
2025-03-09 11:41:26,745 - trading_system - INFO - Authentication successful
2025-03-09 11:41:27,290 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:41:27,291 - trading_system - INFO - Binance interface initialized
2025-03-09 11:41:27,293 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:41:27,294 - trading_system - INFO - Created exchange data source
2025-03-09 11:41:27,295 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:41:27,297 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:41:27,789 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:41:27,790 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 11:41:27,790 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 11:41:27,926 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:41:27,926 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:41:27,927 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 11:41:49,213 - trading_system - WARNING - Chunk 1/5 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741491687929&recvWindow=60000&signature=5a44171e66c94165e478525a7d1416fa31ccc87213768b02357321d9d1c15dcd
2025-03-09 11:42:12,366 - trading_system - WARNING - Chunk 1/5 fetch failed, retry 2/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741491711319&recvWindow=60000&signature=c36849a61803cf7c17115ddbe077842f3964f75b1c96c185ca9522aa713ee0bf
2025-03-09 11:42:31,744 - trading_system - INFO - Trading system initializing...
2025-03-09 11:42:31,753 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:42:31,754 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:42:31,754 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:42:31,755 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:42:31,756 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:42:31,757 - trading_system - INFO - Created local data source
2025-03-09 11:43:40,440 - trading_system - INFO - Trading system initializing...
2025-03-09 11:43:40,450 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:43:40,450 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:43:40,450 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:43:40,450 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:43:40,452 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:43:40,453 - trading_system - INFO - Created local data source
2025-03-09 11:45:04,562 - trading_system - INFO - Trading system initializing...
2025-03-09 11:45:04,577 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:45:04,577 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:45:04,579 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:45:04,579 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:45:04,580 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:45:04,581 - trading_system - INFO - Created local data source
2025-03-09 11:45:53,981 - trading_system - INFO - Using API credentials from configuration file
2025-03-09 11:45:53,983 - trading_system - INFO - Using proxy configuration from config file
2025-03-09 11:45:53,984 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:45:54,363 - trading_system - INFO - Connection successful. Server time synchronized (diff: 477ms)
2025-03-09 11:45:55,146 - trading_system - INFO - Authentication successful
2025-03-09 11:45:55,655 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:45:55,658 - trading_system - INFO - Binance interface initialized
2025-03-09 11:45:55,660 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:45:55,662 - trading_system - INFO - Created exchange data source
2025-03-09 11:45:55,663 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:45:55,664 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:45:56,184 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:45:56,184 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 11:45:56,185 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 11:45:56,345 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:45:56,346 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:45:56,347 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 11:46:17,644 - trading_system - WARNING - Chunk 1/5 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741491956349&recvWindow=60000&signature=ba887393b1b728cbd7a8ac12129bf290a1aeb343ec74c2edb951b42e73fa6ad5
2025-03-09 11:46:40,097 - trading_system - INFO - Trading system initializing...
2025-03-09 11:46:40,109 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:46:40,110 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:46:40,111 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:46:40,112 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:46:40,114 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:46:40,115 - trading_system - INFO - Created local data source
2025-03-09 11:46:40,115 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:46:40,116 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:46:40,859 - trading_system - INFO - Connection successful. Server time synchronized (diff: 569ms)
2025-03-09 11:46:41,641 - trading_system - INFO - Authentication successful
2025-03-09 11:46:42,241 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:46:42,242 - trading_system - INFO - Binance interface initialized
2025-03-09 11:46:42,244 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:46:42,245 - trading_system - INFO - Created exchange data source
2025-03-09 11:46:42,246 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:46:42,246 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:46:42,772 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:46:42,773 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 11:46:42,773 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 11:46:42,919 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:46:42,920 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:46:42,920 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 11:46:54,809 - trading_system - INFO - Trading system initializing...
2025-03-09 11:46:54,819 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:46:54,820 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:46:54,821 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:46:54,821 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:46:54,823 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:46:54,823 - trading_system - INFO - Created local data source
2025-03-09 11:47:18,888 - trading_system - INFO - Trading system initializing...
2025-03-09 11:47:18,898 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:47:18,898 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:47:18,899 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:47:18,899 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:47:18,901 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:47:18,902 - trading_system - INFO - Created local data source
2025-03-09 11:47:25,326 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:47:25,328 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:47:25,329 - trading_system - INFO - {'timeout': 60000, 'enableRateLimit': True, 'options': {'adjustForTimeDifference': True, 'recvWindow': 60000, 'defaultType': 'spot'}, 'apiKey': 'HbMs2aPHQfPNh097P8SGWl7PpcjyUUk6I4WURcn6SUaTWjJ8SM8jb4tYSZgLFoBX', 'secret': 'vVQe126DGUw9BNwSG4gkt9E2DTz1YtiGnP3KzmVWH8AFZJ1SAEsPdOexbuwT68ck', 'headers': {'Connection': 'close'}, 'proxies': {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}}
2025-03-09 11:57:42,805 - trading_system - INFO - Trading system initializing...
2025-03-09 11:57:42,814 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 11:57:42,815 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 11:57:42,816 - trading_system - INFO - Starting trading pipeline...
2025-03-09 11:57:42,816 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 11:57:42,818 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 11:57:42,818 - trading_system - INFO - Created local data source
2025-03-09 11:57:42,819 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 11:57:42,820 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 11:57:42,820 - trading_system - INFO - {'timeout': 60000, 'enableRateLimit': True, 'options': {'adjustForTimeDifference': True, 'recvWindow': 60000, 'defaultType': 'spot'}, 'apiKey': 'CFTnyAyxA7dKhm51WQk7BWKnkM7WyoX4KuQBzESWwQo73UbH4q3Nbd2bsAkDiWzl', 'secret': '7STNlR595VAzY4OY5Q3irLXNjl7gvpiVpUDibSPTXWgzTiZM10PXdt6yKz1fi3Ol', 'headers': {'Connection': 'close'}, 'proxies': {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}}
2025-03-09 11:57:52,114 - trading_system - INFO - Connection successful. Server time synchronized (diff: 478ms)
2025-03-09 11:57:52,528 - trading_system - INFO - Authentication successful
2025-03-09 11:57:53,015 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 11:57:53,019 - trading_system - INFO - Binance interface initialized
2025-03-09 11:57:53,021 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 11:57:53,024 - trading_system - INFO - Created exchange data source
2025-03-09 11:57:53,026 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 11:57:53,027 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 11:57:53,556 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 11:57:53,556 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 11:57:53,557 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 11:57:53,712 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 11:57:53,712 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 11:57:53,713 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 11:58:20,014 - trading_system - WARNING - Chunk 1/5 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741492678750&recvWindow=60000&signature=cf06bae60e0cb7e161cd2f2d702f8f9d8663af2273d7da55929d0168927214a4
2025-03-09 12:00:04,071 - trading_system - INFO - Trading system initializing...
2025-03-09 12:00:04,080 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:00:04,080 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:00:04,080 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:00:04,081 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:00:04,082 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:00:04,083 - trading_system - INFO - Created local data source
2025-03-09 12:00:04,083 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 12:00:04,084 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 12:00:04,414 - trading_system - INFO - Connection successful. Server time synchronized (diff: 482ms)
2025-03-09 12:00:04,717 - trading_system - INFO - Authentication successful
2025-03-09 12:00:05,231 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 12:00:05,233 - trading_system - INFO - Binance interface initialized
2025-03-09 12:00:05,234 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:00:05,236 - trading_system - INFO - Created exchange data source
2025-03-09 12:00:05,237 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:00:05,238 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:00:05,751 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:00:05,752 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:00:05,752 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:00:05,899 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:00:05,900 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 12:00:05,900 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 12:00:56,548 - trading_system - INFO - Trading system initializing...
2025-03-09 12:00:56,575 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:00:56,576 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:00:56,577 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:00:56,577 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:00:56,581 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:00:56,582 - trading_system - INFO - Created local data source
2025-03-09 12:00:56,582 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 12:00:56,583 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 12:00:56,912 - trading_system - INFO - Connection successful. Server time synchronized (diff: 484ms)
2025-03-09 12:00:57,295 - trading_system - INFO - Authentication successful
2025-03-09 12:00:57,816 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 12:00:57,817 - trading_system - INFO - Binance interface initialized
2025-03-09 12:00:57,819 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:00:57,820 - trading_system - INFO - Created exchange data source
2025-03-09 12:00:57,822 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:00:57,823 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:00:58,373 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:00:58,374 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:00:58,375 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:00:58,536 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:00:58,536 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 12:00:58,537 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 12:01:24,403 - trading_system - WARNING - Chunk 1/5 fetch failed, retry 1/3: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741492863055&recvWindow=60000&signature=358d70c73c1ef6ad2b41a8b2cbcd823c22a0872305879c299e3da0e29dae5f0c
2025-03-09 12:04:20,021 - trading_system - INFO - Trading system initializing...
2025-03-09 12:04:20,033 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:04:20,033 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:04:20,034 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:04:20,034 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:04:20,037 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:04:20,038 - trading_system - INFO - Created local data source
2025-03-09 12:04:20,038 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 12:04:20,039 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 12:04:20,379 - trading_system - INFO - Connection successful. Server time synchronized (diff: 487ms)
2025-03-09 12:04:23,648 - trading_system - INFO - Trading system initializing...
2025-03-09 12:04:23,664 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:04:23,666 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:04:23,666 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:04:23,667 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:04:23,668 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:04:23,670 - trading_system - INFO - Created local data source
2025-03-09 12:04:23,671 - trading_system - INFO - Using proxy configuration: {'http': 'http://127.0.0.1:7890', 'https': 'http://127.0.0.1:7890'}
2025-03-09 12:04:23,672 - trading_system - INFO - Initializing Binance exchange connections
2025-03-09 12:04:24,087 - trading_system - INFO - Connection successful. Server time synchronized (diff: 485ms)
2025-03-09 12:04:24,426 - trading_system - INFO - Authentication successful
2025-03-09 12:04:24,957 - trading_system - INFO - Current IP: 89.213.179.134
2025-03-09 12:04:24,958 - trading_system - INFO - Binance interface initialized
2025-03-09 12:04:24,959 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:04:24,960 - trading_system - INFO - Created exchange data source
2025-03-09 12:04:24,961 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:04:24,962 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:04:25,480 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:04:25,480 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:04:25,481 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:04:25,670 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:04:25,671 - trading_system - INFO - Starting smart OHLCV fetch: BTC/USDT 1h 2023-01-01 08:00:00+08:00 - 2023-12-31 08:00:00+08:00
2025-03-09 12:04:25,672 - trading_system - INFO - Request divided into 5 chunks
2025-03-09 12:04:46,928 - trading_system - ERROR - Error processing chunk 1: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741493065674&recvWindow=60000&signature=1de02c28f7e6e691fead8e934af18da9316c1039baa7594f176feaae7aecf78c
2025-03-09 12:21:40,079 - trading_system - INFO - Trading system initializing...
2025-03-09 12:21:40,088 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:21:40,089 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:21:40,089 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:21:40,090 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:21:40,091 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:21:40,091 - trading_system - INFO - Created local data source
2025-03-09 12:21:40,491 - trading_system - INFO - Connection successful
2025-03-09 12:21:40,493 - trading_system - INFO - Binance interface initialized
2025-03-09 12:21:40,495 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:21:40,497 - trading_system - INFO - Created exchange data source
2025-03-09 12:21:40,498 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:21:40,500 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:21:40,997 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:21:40,997 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:21:40,998 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:21:41,135 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:21:43,531 - trading_system - ERROR - Error processing chunk 1: binance GET https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&startTime=1672531200000&limit=1000&endTime=1679731200000
2025-03-09 12:21:45,688 - trading_system - ERROR - Error processing chunk 2: binance GET https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&startTime=1679731200000&limit=1000&endTime=1686931200000
2025-03-09 12:21:47,855 - trading_system - ERROR - Error processing chunk 3: binance GET https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&startTime=1686931200000&limit=1000&endTime=1694131200000
2025-03-09 12:21:50,037 - trading_system - ERROR - Error processing chunk 4: binance GET https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&startTime=1694131200000&limit=1000&endTime=1701331200000
2025-03-09 12:25:08,766 - trading_system - INFO - Trading system initializing...
2025-03-09 12:25:08,777 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:25:08,778 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:25:08,778 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:25:08,778 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:25:08,779 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:25:08,780 - trading_system - INFO - Created local data source
2025-03-09 12:25:09,189 - trading_system - INFO - Connection successful
2025-03-09 12:25:09,190 - trading_system - INFO - Binance interface initialized
2025-03-09 12:25:09,191 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:25:09,191 - trading_system - INFO - Created exchange data source
2025-03-09 12:25:09,192 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:25:09,193 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:25:09,740 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:25:09,740 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:25:09,741 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:25:09,956 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:25:09,957 - trading_system - INFO - Fetching BTC/USDT 1h data in 5 chunks
2025-03-09 12:25:36,127 - trading_system - WARNING - Error in chunk 1, attempt 1: binance GET https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&startTime=1672531200000&endTime=1679731200000&limit=1000
2025-03-09 12:32:42,622 - trading_system - INFO - Trading system initializing...
2025-03-09 12:32:43,045 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:32:43,046 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:32:43,047 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:32:43,047 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:32:43,049 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:32:43,050 - trading_system - INFO - Created local data source
2025-03-09 12:32:44,558 - trading_system - INFO - Connected to Binance API. Time diff: 609ms
2025-03-09 12:32:44,563 - trading_system - INFO - Binance interface initialized
2025-03-09 12:32:44,565 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:32:44,565 - trading_system - INFO - Created exchange data source
2025-03-09 12:32:44,565 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:32:44,565 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:32:45,087 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:32:45,088 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:32:45,088 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:32:45,248 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:32:45,248 - trading_system - INFO - Fetching BTC/USDT 1h data in 9 chunks
2025-03-09 12:32:46,192 - trading_system - WARNING - Error fetching chunk 1/9: Expected coroutine, got list
2025-03-09 12:32:47,437 - trading_system - WARNING - Error fetching chunk 2/9: Expected coroutine, got list
2025-03-09 12:32:48,659 - trading_system - WARNING - Error fetching chunk 3/9: Expected coroutine, got list
2025-03-09 12:32:49,845 - trading_system - WARNING - Error fetching chunk 4/9: Expected coroutine, got list
2025-03-09 12:32:51,030 - trading_system - WARNING - Error fetching chunk 5/9: Expected coroutine, got list
2025-03-09 12:32:52,273 - trading_system - WARNING - Error fetching chunk 6/9: Expected coroutine, got list
2025-03-09 12:32:53,507 - trading_system - WARNING - Error fetching chunk 7/9: Expected coroutine, got list
2025-03-09 12:32:54,689 - trading_system - WARNING - Error fetching chunk 8/9: Expected coroutine, got list
2025-03-09 12:32:56,002 - trading_system - WARNING - Error fetching chunk 9/9: Expected coroutine, got list
2025-03-09 12:32:56,004 - trading_system - WARNING - No data retrieved for BTC/USDT 1h
2025-03-09 12:32:56,005 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 12:32:56,007 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 12:32:56,008 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 12:32:56,012 - trading_system - INFO - Initiating system shutdown...
2025-03-09 12:40:21,175 - trading_system - INFO - Trading system initializing...
2025-03-09 12:40:21,487 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:40:21,488 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:40:21,489 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:40:21,489 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:40:21,491 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:40:21,491 - trading_system - INFO - Created local data source
2025-03-09 12:40:22,945 - trading_system - INFO - Connected to Binance API. Time difference: 608ms
2025-03-09 12:40:22,946 - trading_system - INFO - Binance interface initialized
2025-03-09 12:40:22,947 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:40:22,947 - trading_system - INFO - Created exchange data source
2025-03-09 12:40:22,947 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:40:22,948 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:40:23,522 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:40:23,523 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:40:23,524 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:40:23,723 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:40:23,724 - trading_system - INFO - Fetching BTCUSDT 1h data in 9 chunks
2025-03-09 12:40:24,686 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 12:40:27,621 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: Expected coroutine, got list
2025-03-09 12:48:20,374 - trading_system - INFO - Trading system initializing...
2025-03-09 12:48:20,667 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:48:20,668 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:48:20,668 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:48:20,669 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:48:20,670 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:48:20,671 - trading_system - INFO - Created local data source
2025-03-09 12:48:21,665 - trading_system - INFO - Connected to Binance API. Time difference: 504ms
2025-03-09 12:48:21,666 - trading_system - INFO - Binance interface initialized
2025-03-09 12:48:21,667 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:48:21,667 - trading_system - INFO - Created exchange data source
2025-03-09 12:48:21,670 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:48:21,671 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:48:22,195 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:48:22,196 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:48:22,196 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:48:22,334 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:48:22,335 - trading_system - INFO - Fetching BTCUSDT 1h data in 9 chunks
2025-03-09 12:48:22,685 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 12:48:25,064 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: Expected coroutine, got list
2025-03-09 12:48:29,421 - trading_system - WARNING - Chunk 1/9 attempt 3 failed: Expected coroutine, got list
2025-03-09 12:48:29,422 - trading_system - ERROR - Failed to fetch chunk 1/9 after 3 attempts
2025-03-09 12:55:31,182 - trading_system - INFO - Trading system initializing...
2025-03-09 12:55:31,518 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 12:55:31,519 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 12:55:31,519 - trading_system - INFO - Starting trading pipeline...
2025-03-09 12:55:31,520 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 12:55:31,522 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 12:55:31,522 - trading_system - INFO - Created local data source
2025-03-09 12:55:32,638 - trading_system - INFO - Connected to Binance API. Time difference: 619ms
2025-03-09 12:55:32,639 - trading_system - INFO - Binance interface initialized
2025-03-09 12:55:32,641 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 12:55:32,641 - trading_system - INFO - Created exchange data source
2025-03-09 12:55:32,642 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 12:55:32,643 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 12:55:33,201 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 12:55:33,201 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 12:55:33,202 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 12:55:33,341 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 08:00:00+08:00 to 2023-12-31 08:00:00+08:00
2025-03-09 12:55:33,341 - trading_system - INFO - Fetching BTCUSDT 1h data in 9 chunks
2025-03-09 12:55:34,251 - trading_system - ERROR - Request execution error: Expected coroutine, got list
2025-03-09 12:55:34,251 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 12:55:37,202 - trading_system - ERROR - Request execution error: Expected coroutine, got list
2025-03-09 12:55:37,204 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: Expected coroutine, got list
2025-03-09 12:55:42,053 - trading_system - ERROR - Request execution error: Expected coroutine, got list
2025-03-09 12:55:42,053 - trading_system - WARNING - Chunk 1/9 attempt 3 failed: Expected coroutine, got list
2025-03-09 12:55:42,054 - trading_system - ERROR - Failed to fetch chunk 1/9 after 3 attempts
2025-03-09 12:55:43,255 - trading_system - ERROR - Request execution error: Expected coroutine, got list
2025-03-09 12:55:43,255 - trading_system - WARNING - Chunk 2/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 13:01:33,175 - trading_system - INFO - Trading system initializing...
2025-03-09 13:01:33,546 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:01:33,546 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:01:33,546 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:01:33,546 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:01:33,549 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:01:33,550 - trading_system - INFO - Created local data source
2025-03-09 13:01:35,073 - trading_system - INFO - Connected to Binance API. Time difference: 628ms
2025-03-09 13:01:35,074 - trading_system - INFO - Binance interface initialized
2025-03-09 13:01:35,075 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 13:01:35,075 - trading_system - INFO - Created exchange data source
2025-03-09 13:01:35,076 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 13:01:35,077 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:01:35,588 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:01:35,588 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 13:01:35,589 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 13:01:35,589 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00 to 2023-12-31 00:00:00
2025-03-09 13:01:35,590 - trading_system - INFO - Fetching BTCUSDT 1h data in 9 chunks
2025-03-09 13:01:36,483 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 13:01:36,485 - trading_system - INFO - Retrying after 2s...
2025-03-09 13:01:39,543 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: Expected coroutine, got list
2025-03-09 13:01:39,545 - trading_system - INFO - Retrying after 4s...
2025-03-09 13:05:38,473 - trading_system - INFO - Trading system initializing...
2025-03-09 13:05:38,485 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:05:38,486 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:05:38,486 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:05:38,486 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:05:38,488 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:05:38,489 - trading_system - INFO - Created local data source
2025-03-09 13:05:38,514 - trading_system - INFO - Binance interface initialized using ccxt
2025-03-09 13:05:38,515 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 13:05:38,516 - trading_system - INFO - Created exchange data source
2025-03-09 13:05:38,516 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 13:05:38,517 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:05:39,057 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:05:39,058 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 13:05:39,058 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 13:05:39,058 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00 to 2023-12-31 00:00:00
2025-03-09 13:05:39,059 - trading_system - INFO - Fetching BTC/USDT 1h data in 9 chunks
2025-03-09 13:05:44,466 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: Expected coroutine, got list
2025-03-09 13:05:46,805 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: Expected coroutine, got list
2025-03-09 13:11:35,922 - trading_system - INFO - Trading system initializing...
2025-03-09 13:11:36,218 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:11:36,218 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:11:36,219 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:11:36,219 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:11:36,221 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:11:36,221 - trading_system - INFO - Created local data source
2025-03-09 13:11:36,222 - trading_system - INFO - Binance interface initialized
2025-03-09 13:11:36,222 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 13:11:36,223 - trading_system - INFO - Created exchange data source
2025-03-09 13:11:36,223 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 13:11:36,223 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:11:36,749 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:11:36,750 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 13:11:36,750 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 13:11:36,751 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00 to 2023-12-31 00:00:00
2025-03-09 13:11:36,751 - trading_system - INFO - Fetching BTC/USDT 1h data in 9 chunks
2025-03-09 13:11:37,780 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: Expected coroutine, got list
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 143, in smart_fetch_ohlcv
    chunk_data = await self.executor.submit(fetch_chunk)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\async_executor.py", line 226, in submit
    raise TypeError(f"Expected coroutine, got {type(coro).__name__}")
TypeError: Expected coroutine, got list

2025-03-09 13:11:37,783 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 13:11:37,784 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 13:11:37,786 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 13:11:37,803 - trading_system - INFO - Initiating system shutdown...
2025-03-09 13:17:54,172 - trading_system - INFO - Trading system initializing...
2025-03-09 13:17:54,181 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:17:54,182 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:17:54,183 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:17:54,183 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:17:54,185 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:17:54,185 - trading_system - INFO - Created local data source
2025-03-09 13:17:54,187 - trading_system - ERROR - Failed to create exchange data source: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'

2025-03-09 13:17:54,188 - trading_system - WARNING - 无法创建备用交易所数据源: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
2025-03-09 13:17:54,189 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:17:54,705 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:17:54,705 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 13:17:54,711 - trading_system - INFO - Initiating system shutdown...
2025-03-09 13:19:57,980 - trading_system - INFO - Trading system initializing...
2025-03-09 13:19:57,989 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:19:57,989 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:19:57,990 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:19:57,990 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:19:57,992 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:19:57,992 - trading_system - INFO - Created local data source
2025-03-09 13:19:58,026 - trading_system - INFO - Binance interface initialized using CCXT
2025-03-09 13:19:58,028 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 13:19:58,028 - trading_system - INFO - Created exchange data source
2025-03-09 13:19:58,029 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 13:19:58,030 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:19:58,644 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:19:58,645 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 13:19:58,646 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 13:19:58,646 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00 to 2023-12-31 00:00:00
2025-03-09 13:19:58,647 - trading_system - INFO - Fetching BTC/USDT 1h data in 9 chunks
2025-03-09 13:20:19,907 - trading_system - WARNING - Chunk 1/9 attempt 1 failed: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741497598649&recvWindow=60000&signature=f200e1ff46eddcc5c647494afe949b56a5e2ca03c247971010d74fab835f41e7
2025-03-09 13:20:43,039 - trading_system - WARNING - Chunk 1/9 attempt 2 failed: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741497621969&recvWindow=60000&signature=6c6732442d1e80f9f6bc0fbaf1584a7e721e5052e387ee633d58774cd8873e7f
2025-03-09 13:21:08,140 - trading_system - WARNING - Chunk 1/9 attempt 3 failed: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741497647071&recvWindow=60000&signature=45642211ab5eefc56a7f362925f929cdafa985c6775fae55f24671761a162d6b
2025-03-09 13:21:08,141 - trading_system - ERROR - Failed to fetch chunk after 3 attempts
2025-03-09 13:39:04,195 - trading_system - INFO - Trading system initializing...
2025-03-09 13:39:04,204 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:39:04,205 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:39:04,205 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:39:04,206 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:39:04,207 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:39:04,208 - trading_system - INFO - Created local data source
2025-03-09 13:39:04,209 - trading_system - ERROR - Failed to create exchange data source: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'

2025-03-09 13:39:04,210 - trading_system - WARNING - 无法创建备用交易所数据源: Binance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
2025-03-09 13:39:04,210 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:39:04,664 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:39:04,665 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 13:39:04,670 - trading_system - INFO - Initiating system shutdown...
2025-03-09 13:43:31,064 - trading_system - INFO - Trading system initializing...
2025-03-09 13:43:31,089 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 13:43:31,090 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 13:43:31,092 - trading_system - INFO - Starting trading pipeline...
2025-03-09 13:43:31,093 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 13:43:31,097 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 13:43:31,099 - trading_system - INFO - Created local data source
2025-03-09 13:43:31,137 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 13:43:31,171 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 13:43:31,172 - trading_system - INFO - Binance接口初始化完成
2025-03-09 13:43:31,173 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 13:43:31,174 - trading_system - INFO - Created exchange data source
2025-03-09 13:43:31,175 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 13:43:31,176 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 13:43:31,675 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 13:43:31,675 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 13:43:31,676 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 13:43:31,676 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00 to 2023-12-31 00:00:00
2025-03-09 13:43:31,676 - trading_system - INFO - 开始智能获取OHLCV数据: BTC/USDT 1h 2023-01-01 00:00:00+00:00 - 2023-12-31 00:00:00+00:00
2025-03-09 13:43:31,677 - trading_system - INFO - 将请求分为18个块
2025-03-09 13:43:31,880 - trading_system - WARNING - 第1块数据获取失败，尝试重试(1/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 13:43:33,908 - trading_system - WARNING - 第1块数据获取失败，尝试重试(2/3): unsupported operand type(s) for /: 'NoneType' and 'int'
2025-03-09 15:03:32,720 - trading_system - INFO - Trading system initializing...
2025-03-09 15:03:32,731 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:03:32,731 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:03:32,731 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:03:32,732 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:03:32,734 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:03:32,735 - trading_system - INFO - Created local data source
2025-03-09 15:03:32,751 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:03:32,769 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:03:32,770 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:03:32,771 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:03:32,772 - trading_system - INFO - Created exchange data source
2025-03-09 15:03:32,772 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:03:32,773 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:03:33,243 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:03:33,243 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:03:33,244 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:03:33,290 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:03:33,291 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:03:33,318 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:04:50,205 - trading_system - INFO - Trading system initializing...
2025-03-09 15:04:50,213 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:04:50,215 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:04:50,215 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:04:50,215 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:04:50,216 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:04:50,216 - trading_system - INFO - Created local data source
2025-03-09 15:04:50,232 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:04:50,249 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:04:50,249 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:04:50,250 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:04:50,250 - trading_system - INFO - Created exchange data source
2025-03-09 15:04:50,251 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:04:50,252 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:04:50,680 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:04:50,680 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:04:50,681 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:04:50,683 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:04:50,683 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:04:50,688 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:05:36,706 - trading_system - INFO - Trading system initializing...
2025-03-09 15:05:36,718 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:05:36,718 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:05:36,718 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:05:36,719 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:05:36,720 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:05:36,720 - trading_system - INFO - Created local data source
2025-03-09 15:05:36,748 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:05:36,782 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:05:36,783 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:05:36,784 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:05:36,785 - trading_system - INFO - Created exchange data source
2025-03-09 15:05:36,785 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:05:36,786 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:05:37,237 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:05:37,237 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:05:37,237 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:05:37,239 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:05:37,240 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:05:37,245 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:06:16,599 - trading_system - INFO - Trading system initializing...
2025-03-09 15:06:16,608 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:06:16,608 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:06:16,608 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:06:16,609 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:06:16,610 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:06:16,610 - trading_system - INFO - Created local data source
2025-03-09 15:06:16,626 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:06:16,641 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:06:16,643 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:06:16,643 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:06:16,644 - trading_system - INFO - Created exchange data source
2025-03-09 15:06:16,644 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:06:16,645 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:06:17,071 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:06:17,071 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:06:29,076 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:06:29,081 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:06:29,082 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:06:29,091 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:06:38,509 - trading_system - INFO - Trading system initializing...
2025-03-09 15:06:38,518 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:06:38,518 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:06:38,518 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:06:38,529 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:06:38,530 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:06:38,532 - trading_system - INFO - Created local data source
2025-03-09 15:06:38,547 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:06:38,567 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:06:38,568 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:06:38,569 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:06:38,571 - trading_system - INFO - Created exchange data source
2025-03-09 15:06:38,571 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:06:38,572 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:06:39,017 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:06:39,017 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:06:41,036 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:06:41,043 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:06:41,044 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:06:41,057 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:06:47,630 - trading_system - INFO - Trading system initializing...
2025-03-09 15:06:47,650 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:06:47,652 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:06:47,654 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:06:47,655 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:06:47,658 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:06:47,659 - trading_system - INFO - Created local data source
2025-03-09 15:06:47,684 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:06:47,707 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:06:47,708 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:06:47,709 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:06:47,709 - trading_system - INFO - Created exchange data source
2025-03-09 15:06:47,712 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:06:47,713 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:06:48,160 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:06:48,161 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:06:52,039 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:06:57,533 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:06:57,535 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:06:57,552 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:07:02,820 - trading_system - INFO - Trading system initializing...
2025-03-09 15:07:02,834 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:07:02,835 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:07:02,836 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:07:02,837 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:07:02,838 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:07:02,840 - trading_system - INFO - Created local data source
2025-03-09 15:07:02,861 - trading_system - INFO - 同步客户端API密钥验证成功
2025-03-09 15:07:02,880 - trading_system - INFO - 异步客户端初始化成功
2025-03-09 15:07:02,880 - trading_system - INFO - Binance接口初始化完成
2025-03-09 15:07:02,882 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:07:02,883 - trading_system - INFO - Created exchange data source
2025-03-09 15:07:02,883 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:07:02,884 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:07:03,332 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:07:03,333 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:24:40,759 - trading_system - INFO - Trading system initializing...
2025-03-09 15:24:40,767 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:24:40,768 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:24:40,768 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:24:40,769 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:24:40,770 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:24:40,770 - trading_system - INFO - Created local data source
2025-03-09 15:24:40,772 - trading_system - ERROR - Failed to create exchange data source: SimpleBinance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config, retry_with_no_auth=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: SimpleBinance.__init__() got an unexpected keyword argument 'retry_with_no_auth'

2025-03-09 15:24:40,773 - trading_system - WARNING - 无法创建备用交易所数据源: SimpleBinance.__init__() got an unexpected keyword argument 'retry_with_no_auth'
2025-03-09 15:24:40,773 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:24:41,241 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:24:41,241 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:24:41,247 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:25:30,192 - trading_system - INFO - Trading system initializing...
2025-03-09 15:25:30,201 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:25:30,201 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:25:30,202 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:25:30,202 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:25:30,203 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:25:30,203 - trading_system - INFO - Created local data source
2025-03-09 15:25:30,205 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 27, in __init__
    self._init_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 43, in _init_exchange
    api_key = self.config.get('api', {}).get('binance', {}).get('apiKey', '')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 15:25:30,205 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 15:25:30,206 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:25:30,667 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:25:30,668 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:25:30,675 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:26:18,946 - trading_system - INFO - Trading system initializing...
2025-03-09 15:26:18,955 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:26:18,956 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:26:18,956 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:26:18,956 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:26:18,958 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:26:18,959 - trading_system - INFO - Created local data source
2025-03-09 15:26:32,395 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 27, in __init__
    self._init_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 60, in _init_exchange
    proxies = self.config.get('proxies', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 15:26:32,397 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 15:26:32,399 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:26:32,855 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:26:32,855 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:26:32,860 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:26:53,895 - trading_system - INFO - Trading system initializing...
2025-03-09 15:26:53,903 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:26:53,904 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:26:53,904 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:26:53,905 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:26:53,906 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:26:53,907 - trading_system - INFO - Created local data source
2025-03-09 15:27:04,979 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 452, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 27, in __init__
    self._init_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 60, in _init_exchange
    proxies = self.config.get('proxies', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 15:27:04,979 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 15:27:04,980 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:27:05,488 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:27:05,489 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:27:05,495 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:27:10,190 - trading_system - INFO - Trading system initializing...
2025-03-09 15:27:10,201 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:27:10,202 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:27:10,202 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:27:10,202 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:27:10,204 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:27:10,204 - trading_system - INFO - Created local data source
2025-03-09 15:29:30,876 - trading_system - INFO - Trading system initializing...
2025-03-09 15:29:30,886 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:29:30,887 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:29:30,887 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:29:30,888 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:29:30,889 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:29:30,890 - trading_system - INFO - Created local data source
2025-03-09 15:29:34,472 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:29:34,472 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:29:34,473 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:29:34,473 - trading_system - INFO - Created exchange data source
2025-03-09 15:29:34,474 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:29:34,474 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:29:34,956 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:29:34,956 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:29:43,644 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:29:43,649 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:29:43,650 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:29:43,657 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:29:48,702 - trading_system - INFO - Trading system initializing...
2025-03-09 15:29:48,710 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:29:48,712 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:29:48,713 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:29:48,714 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:29:48,715 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:29:48,715 - trading_system - INFO - Created local data source
2025-03-09 15:30:04,782 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:30:09,584 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:30:49,481 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:30:59,268 - trading_system - INFO - Created exchange data source
2025-03-09 15:31:04,615 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:31:36,232 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:34:49,838 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:34:49,839 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:34:57,706 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:34:57,710 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:34:57,710 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:35:11,746 - trading_system - INFO - Trading system initializing...
2025-03-09 15:35:11,753 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:35:11,754 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:35:11,755 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:35:11,755 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:35:11,756 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:35:11,757 - trading_system - INFO - Created local data source
2025-03-09 15:36:21,952 - trading_system - INFO - Trading system initializing...
2025-03-09 15:36:22,054 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:36:22,054 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:36:22,055 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:36:22,055 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:36:22,057 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:36:22,057 - trading_system - INFO - Created local data source
2025-03-09 15:39:18,228 - trading_system - INFO - Trading system initializing...
2025-03-09 15:39:18,237 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:39:18,237 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:39:18,239 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:39:18,239 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:39:18,241 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:39:18,241 - trading_system - INFO - Created local data source
2025-03-09 15:39:29,463 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:39:35,837 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:39:53,984 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:40:03,210 - trading_system - INFO - Created exchange data source
2025-03-09 15:40:21,814 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:41:42,437 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:42:18,624 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:42:18,626 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:42:22,229 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:42:25,501 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:42:25,503 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:42:25,521 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:42:31,639 - trading_system - INFO - Trading system initializing...
2025-03-09 15:42:31,650 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:42:31,651 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:42:31,651 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:42:31,651 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:42:31,653 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:42:31,653 - trading_system - INFO - Created local data source
2025-03-09 15:42:42,305 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:42:42,307 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:42:42,310 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:42:42,311 - trading_system - INFO - Created exchange data source
2025-03-09 15:42:42,313 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:42:42,314 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:43:29,036 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:43:35,367 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:43:37,947 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:43:52,586 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:43:52,588 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:43:52,605 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:43:58,974 - trading_system - INFO - Trading system initializing...
2025-03-09 15:43:58,983 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:43:58,983 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:43:58,984 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:43:58,984 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:43:58,986 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:43:58,986 - trading_system - INFO - Created local data source
2025-03-09 15:43:59,004 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:43:59,004 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:43:59,005 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:43:59,006 - trading_system - INFO - Created exchange data source
2025-03-09 15:43:59,006 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:43:59,007 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:44:03,028 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:44:03,029 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:44:08,535 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:44:08,542 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:44:08,545 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:44:08,557 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:44:15,694 - trading_system - INFO - Trading system initializing...
2025-03-09 15:44:15,703 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:44:15,703 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:44:15,704 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:44:15,704 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:44:15,706 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:44:15,706 - trading_system - INFO - Created local data source
2025-03-09 15:44:15,724 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:44:15,724 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:44:15,725 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:44:15,726 - trading_system - INFO - Created exchange data source
2025-03-09 15:44:15,726 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:44:15,727 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:44:18,795 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:44:18,796 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:44:20,799 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:44:20,806 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:44:20,808 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:44:20,823 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:44:25,466 - trading_system - INFO - Trading system initializing...
2025-03-09 15:44:25,474 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:44:25,476 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:44:25,476 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:44:25,477 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:44:25,478 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:44:25,478 - trading_system - INFO - Created local data source
2025-03-09 15:44:25,495 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:44:25,496 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:44:25,496 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:44:25,497 - trading_system - INFO - Created exchange data source
2025-03-09 15:44:25,498 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:44:25,499 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:44:28,363 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:44:28,364 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:44:31,680 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:44:44,212 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:44:44,214 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:44:44,230 - trading_system - INFO - Initiating system shutdown...
2025-03-09 15:44:54,129 - trading_system - INFO - Trading system initializing...
2025-03-09 15:44:54,143 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 15:44:54,143 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 15:44:54,144 - trading_system - INFO - Starting trading pipeline...
2025-03-09 15:44:54,144 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 15:44:54,146 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 15:44:54,147 - trading_system - INFO - Created local data source
2025-03-09 15:44:54,163 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 15:44:54,164 - trading_system - INFO - SimpleBinance initialized
2025-03-09 15:44:54,164 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 15:44:54,165 - trading_system - INFO - Created exchange data source
2025-03-09 15:44:54,165 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 15:44:54,166 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 15:44:54,613 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 15:44:54,613 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 15:44:55,892 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 15:45:13,703 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 15:45:13,704 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 15:45:13,722 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:04:13,363 - trading_system - INFO - Trading system initializing...
2025-03-09 16:04:13,375 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:04:13,376 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:04:13,376 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:04:13,376 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:04:13,378 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:04:13,379 - trading_system - INFO - Created local data source
2025-03-09 16:04:13,398 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:04:13,399 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:04:13,399 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:04:13,399 - trading_system - INFO - Created exchange data source
2025-03-09 16:04:13,400 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:04:13,400 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:04:13,886 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:04:13,887 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:04:17,426 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:04:17,431 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 16:04:17,433 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:04:17,447 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:04:23,178 - trading_system - INFO - Trading system initializing...
2025-03-09 16:04:23,188 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:04:23,189 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:04:23,189 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:04:23,189 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:04:23,191 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:04:23,191 - trading_system - INFO - Created local data source
2025-03-09 16:04:23,207 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:04:23,208 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:04:23,208 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:04:23,209 - trading_system - INFO - Created exchange data source
2025-03-09 16:04:23,209 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:04:23,210 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:04:23,663 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:04:23,663 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:04:31,626 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:06:01,412 - trading_system - INFO - Trading system initializing...
2025-03-09 16:06:01,422 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:06:01,423 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:06:01,423 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:06:01,423 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:06:01,425 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:06:01,425 - trading_system - INFO - Created local data source
2025-03-09 16:06:01,443 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:06:01,443 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:06:01,444 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:06:01,445 - trading_system - INFO - Created exchange data source
2025-03-09 16:06:01,445 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:06:01,446 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:06:01,923 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:06:01,923 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:06:08,606 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:08:11,118 - trading_system - ERROR - 从交易所下载数据失败: cannot access local variable 'datetime' where it is not associated with a value
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\data_manager.py", line 164, in get_historical_data
    exchange_data = await self.fallback_source.fetch_historical(symbol, timeframe, start, end)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 360, in fetch_historical
    start_dt = TimeUtils.parse_timestamp(start) if start else datetime.now() - timedelta(days=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\utils\time_utils.py", line 32, in parse_timestamp
    if isinstance(timestamp, datetime):
                             ^^^^^^^^
UnboundLocalError: cannot access local variable 'datetime' where it is not associated with a value

2025-03-09 16:08:11,119 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:08:11,164 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:11:43,547 - trading_system - INFO - Trading system initializing...
2025-03-09 16:11:43,564 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:11:43,565 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:11:43,566 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:11:43,566 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:11:43,568 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:11:43,569 - trading_system - INFO - Created local data source
2025-03-09 16:11:43,586 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:11:43,587 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:11:43,588 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:11:43,588 - trading_system - INFO - Created exchange data source
2025-03-09 16:11:43,589 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:11:43,589 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:11:44,068 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:11:44,069 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:11:47,165 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:11:59,771 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:12:30,396 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 366, in fetch_historical
    df = await self.exchange.smart_fetch_ohlcv(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 353, in smart_fetch_ohlcv
    return await self.fetch_historical_ohlcv(symbol, timeframe, start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 251, in fetch_historical_ohlcv
    await self._init_async_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 75, in _init_async_exchange
    api_key = self.config.get('api', {}).get('binance', {}).get('apiKey', '')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 16:12:30,401 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:12:30,402 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:12:30,422 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:12:40,999 - trading_system - INFO - Trading system initializing...
2025-03-09 16:12:41,010 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:12:41,010 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:12:41,011 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:12:41,012 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:12:41,013 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:12:41,013 - trading_system - INFO - Created local data source
2025-03-09 16:12:41,030 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:12:41,031 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:12:41,031 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:12:41,032 - trading_system - INFO - Created exchange data source
2025-03-09 16:12:41,032 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:12:41,032 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:12:41,505 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:12:41,506 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:12:46,651 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:12:46,653 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:12:57,975 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 366, in fetch_historical
    df = await self.exchange.smart_fetch_ohlcv(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 353, in smart_fetch_ohlcv
    return await self.fetch_historical_ohlcv(symbol, timeframe, start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 251, in fetch_historical_ohlcv
    await self._init_async_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 75, in _init_async_exchange
    api_key = self.config.get('api', {}).get('binance', {}).get('apiKey', '')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 16:12:57,978 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:12:57,979 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:12:57,990 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:13:10,544 - trading_system - INFO - Trading system initializing...
2025-03-09 16:13:10,557 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:13:10,557 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:13:10,558 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:13:10,559 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:13:10,561 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:13:10,561 - trading_system - INFO - Created local data source
2025-03-09 16:13:10,594 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:13:10,595 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:13:10,597 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:13:10,598 - trading_system - INFO - Created exchange data source
2025-03-09 16:13:10,600 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:13:10,601 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:13:11,042 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:13:11,042 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:13:13,387 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:13:33,634 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:13:56,923 - trading_system - INFO - Trading system initializing...
2025-03-09 16:13:56,932 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:13:56,932 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:13:56,933 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:13:56,933 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:13:56,934 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:13:56,935 - trading_system - INFO - Created local data source
2025-03-09 16:13:56,950 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:13:56,951 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:13:56,952 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:13:56,952 - trading_system - INFO - Created exchange data source
2025-03-09 16:13:56,953 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:13:56,954 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:13:57,393 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:13:57,394 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:13:59,358 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:13:59,361 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:14:33,340 - trading_system - INFO - Trading system initializing...
2025-03-09 16:14:33,349 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:14:33,349 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:14:33,350 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:14:33,350 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:14:33,351 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:14:33,352 - trading_system - INFO - Created local data source
2025-03-09 16:14:33,373 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:14:33,381 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:14:33,382 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:14:33,382 - trading_system - INFO - Created exchange data source
2025-03-09 16:14:33,383 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:14:33,384 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:14:33,834 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:14:33,835 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:14:39,004 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:14:39,006 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:14:40,994 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 366, in fetch_historical
    df = await self.exchange.smart_fetch_ohlcv(symbol, timeframe, start_dt, end_dt)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 353, in smart_fetch_ohlcv
    return await self.fetch_historical_ohlcv(symbol, timeframe, start, end)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 251, in fetch_historical_ohlcv
    await self._init_async_exchange()
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 92, in _init_async_exchange
    proxies = self.config.get('proxies', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 16:14:40,995 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:14:40,996 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:14:41,002 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:15:11,372 - trading_system - INFO - Trading system initializing...
2025-03-09 16:15:11,380 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:15:11,380 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:15:11,380 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:15:11,381 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:15:11,382 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:15:11,382 - trading_system - INFO - Created local data source
2025-03-09 16:15:11,398 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:15:11,399 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:15:11,400 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:15:11,400 - trading_system - INFO - Created exchange data source
2025-03-09 16:15:11,401 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:15:11,401 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:15:11,865 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:15:11,866 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:15:13,956 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:15:13,960 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:16:10,262 - trading_system - INFO - Trading system initializing...
2025-03-09 16:16:10,272 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:16:10,273 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:16:10,274 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:16:10,274 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:16:10,275 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:16:10,276 - trading_system - INFO - Created local data source
2025-03-09 16:16:10,292 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:16:10,293 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:16:10,293 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:16:10,295 - trading_system - INFO - Created exchange data source
2025-03-09 16:16:10,295 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:16:10,296 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:16:10,758 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:16:10,759 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:18:33,639 - trading_system - INFO - Trading system initializing...
2025-03-09 16:18:33,647 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:18:33,647 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:18:33,648 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:18:33,648 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:18:33,649 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:18:33,650 - trading_system - INFO - Created local data source
2025-03-09 16:18:33,666 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:18:33,667 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:18:33,668 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:18:33,668 - trading_system - INFO - Created exchange data source
2025-03-09 16:18:33,669 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:18:33,669 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:18:34,175 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:18:34,175 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:18:36,326 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:18:36,329 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:18:41,013 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:18:41,015 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:18:46,677 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741508324313&recvWindow=60000&signature=11c45e7cc1103454f16eef127b96f8169af682d9c8790533f65b798e853da419
2025-03-09 16:19:08,195 - trading_system - INFO - Trading system initializing...
2025-03-09 16:19:08,206 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:19:08,206 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:19:08,207 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:19:08,207 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:19:08,208 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:19:08,209 - trading_system - INFO - Created local data source
2025-03-09 16:19:08,226 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:19:08,227 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:19:08,228 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:19:08,228 - trading_system - INFO - Created exchange data source
2025-03-09 16:19:08,229 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:19:08,229 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:19:08,660 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:19:08,661 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:19:11,234 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:19:11,237 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:19:26,886 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:19:26,888 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:21:56,649 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741508495907&recvWindow=60000&signature=95f16f78cd4e61024e0a4e5d08a49703ad913d89a6b50b98dc3c972936fc6459
2025-03-09 16:22:20,845 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741508525225&recvWindow=60000&signature=27b4ace31abb39bdef9923f288a0fcbc8741f716415458ecd82b408a4496b0c3
2025-03-09 16:28:53,351 - trading_system - INFO - Trading system initializing...
2025-03-09 16:28:53,360 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:28:53,361 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:28:53,361 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:28:53,361 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:28:53,362 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:28:53,363 - trading_system - INFO - Created local data source
2025-03-09 16:28:53,379 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:28:53,389 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:28:53,389 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:28:53,390 - trading_system - INFO - Created exchange data source
2025-03-09 16:28:53,390 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:28:53,391 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:28:53,998 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:28:53,999 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:28:53,999 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:28:54,000 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:28:54,017 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:28:54,018 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:33:06,399 - trading_system - INFO - Trading system initializing...
2025-03-09 16:33:06,407 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:33:06,407 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:33:06,407 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:33:06,409 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:33:06,410 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:33:06,411 - trading_system - INFO - Created local data source
2025-03-09 16:33:06,426 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:33:06,427 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:33:06,427 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:33:06,428 - trading_system - INFO - Created exchange data source
2025-03-09 16:33:06,428 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:33:06,429 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:33:06,918 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:33:06,919 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:33:06,920 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:33:06,921 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:33:06,945 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:33:06,946 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:33:36,435 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741509195192&recvWindow=60000&signature=41c75c04915f1c2e5d3d8b33f0b143535be3abb4570856f68c625a5f5792c6d6
2025-03-09 16:34:05,562 - trading_system - INFO - Trading system initializing...
2025-03-09 16:34:05,577 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:34:05,578 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:34:05,579 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:34:05,581 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:34:05,584 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:34:05,585 - trading_system - INFO - Created local data source
2025-03-09 16:34:05,611 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:34:05,612 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:34:05,613 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:34:05,613 - trading_system - INFO - Created exchange data source
2025-03-09 16:34:05,614 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:34:05,614 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:34:06,095 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:34:06,095 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:34:06,095 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:34:06,097 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:34:06,113 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:34:06,114 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:34:36,798 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741509255570&recvWindow=60000&signature=d8db94e034975d278fb240c6a67b72cf2e15612df5ea4536a70463c2449ba5d5
2025-03-09 16:34:51,721 - trading_system - INFO - Trading system initializing...
2025-03-09 16:34:51,734 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:34:51,735 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:34:51,735 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:34:51,736 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:34:51,739 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:34:51,739 - trading_system - INFO - Created local data source
2025-03-09 16:34:51,759 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:34:51,760 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:34:51,761 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:34:51,761 - trading_system - INFO - Created exchange data source
2025-03-09 16:34:51,762 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:34:51,762 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:34:52,220 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:34:52,221 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:34:52,221 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:34:52,223 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:34:52,239 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:34:52,239 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:35:03,236 - trading_system - INFO - Downloaded data up to 2023-02-11 23:00:00.001000
2025-03-09 16:39:56,025 - trading_system - INFO - Trading system initializing...
2025-03-09 16:39:56,037 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:39:56,038 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:39:56,038 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:39:56,039 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:39:56,040 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:39:56,041 - trading_system - INFO - Created local data source
2025-03-09 16:39:56,057 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:39:56,057 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:39:56,058 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:39:56,058 - trading_system - INFO - Created exchange data source
2025-03-09 16:39:56,059 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:39:56,059 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:39:56,531 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:39:56,532 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:39:56,532 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:39:56,534 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:39:56,536 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: 'Binance' object has no attribute 'smart_fetch_ohlcv'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 366, in fetch_historical
    df = await self.exchange.smart_fetch_ohlcv(symbol, timeframe, start_dt, end_dt)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Binance' object has no attribute 'smart_fetch_ohlcv'

2025-03-09 16:39:56,537 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:39:56,537 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:39:56,542 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:42:04,005 - trading_system - INFO - Trading system initializing...
2025-03-09 16:42:04,015 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:42:04,016 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:42:04,016 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:42:04,017 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:42:04,018 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:42:04,019 - trading_system - INFO - Created local data source
2025-03-09 16:42:04,036 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:42:04,037 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:42:04,037 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:42:04,038 - trading_system - INFO - Created exchange data source
2025-03-09 16:42:04,038 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:42:04,039 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:42:04,488 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:42:04,488 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:42:04,489 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:42:04,490 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:42:04,506 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:42:04,507 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:42:29,806 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741509728542&recvWindow=60000&signature=0f9e27819d7d8bdad3516647f83d41b9009bba00012043cad6151f69401f0024
2025-03-09 16:43:05,584 - trading_system - INFO - Trading system initializing...
2025-03-09 16:43:05,592 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:43:05,593 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:43:05,593 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:43:05,594 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:43:05,595 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:43:05,595 - trading_system - INFO - Created local data source
2025-03-09 16:43:05,612 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:43:05,613 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:43:05,613 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:43:05,614 - trading_system - INFO - Created exchange data source
2025-03-09 16:43:05,615 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:43:05,615 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:43:06,066 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:43:06,066 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:43:06,066 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:43:06,068 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:43:06,084 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:43:06,085 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:44:12,559 - trading_system - INFO - Trading system initializing...
2025-03-09 16:44:12,569 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:44:12,569 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:44:12,570 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:44:12,570 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:44:12,571 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:44:12,572 - trading_system - INFO - Created local data source
2025-03-09 16:44:12,587 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:44:12,588 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:44:12,588 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:44:12,589 - trading_system - INFO - Created exchange data source
2025-03-09 16:44:12,590 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:44:12,590 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:44:13,037 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:44:13,037 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:44:13,038 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:44:13,039 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:44:13,055 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:44:13,055 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:44:31,220 - trading_system - INFO - Trading system initializing...
2025-03-09 16:44:31,229 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:44:31,229 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:44:31,229 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:44:31,230 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:44:31,231 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:44:31,231 - trading_system - INFO - Created local data source
2025-03-09 16:44:31,248 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:44:31,249 - trading_system - INFO - SimpleBinance initialized
2025-03-09 16:44:31,250 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:44:31,250 - trading_system - INFO - Created exchange data source
2025-03-09 16:44:31,251 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:44:31,251 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:44:31,761 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:44:31,762 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:44:31,762 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:44:31,763 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:44:31,780 - trading_system - INFO - CCXT Async Binance exchange initialized
2025-03-09 16:44:31,781 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:44:36,705 - trading_system - INFO - Downloaded data up to 2023-02-11 23:00:00.001000
2025-03-09 16:44:44,463 - trading_system - INFO - Downloaded data up to 2023-03-25 16:00:00.001000
2025-03-09 16:44:46,652 - trading_system - INFO - Downloaded data up to 2023-05-06 08:00:00.001000
2025-03-09 16:44:47,313 - trading_system - INFO - Downloaded data up to 2023-06-17 00:00:00.001000
2025-03-09 16:44:47,963 - trading_system - INFO - Downloaded data up to 2023-07-28 16:00:00.001000
2025-03-09 16:44:48,621 - trading_system - INFO - Downloaded data up to 2023-09-08 08:00:00.001000
2025-03-09 16:44:49,334 - trading_system - INFO - Downloaded data up to 2023-10-20 00:00:00.001000
2025-03-09 16:44:49,989 - trading_system - INFO - Downloaded data up to 2023-11-30 16:00:00.001000
2025-03-09 16:44:50,703 - trading_system - ERROR - Smart fetch failed for BTC/USDT 1h: Invalid comparison between dtype=datetime64[ns] and datetime
Traceback (most recent call last):
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 536, in _validate_comparison_value
    self._check_compatible_with(other)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimes.py", line 540, in _check_compatible_with
    self._assert_tzawareness_compat(other)
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimes.py", line 782, in _assert_tzawareness_compat
    raise TypeError(
TypeError: Cannot compare tz-naive and tz-aware datetime-like objects.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 983, in _cmp_method
    other = self._validate_comparison_value(other)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 539, in _validate_comparison_value
    raise InvalidComparison(other) from err
pandas.errors.InvalidComparison: 2023-01-01 00:00:00+00:00

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 366, in fetch_historical
    df = await self.exchange.fetch_historical_ohlcv(symbol, timeframe, start_dt, end_dt)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 304, in fetch_historical_ohlcv
    df = df[(df.index >= start_date) & (df.index <= end_date)]
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\indexes\base.py", line 7197, in _cmp_method
    result = op(self._values, other)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\ops\common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arraylike.py", line 60, in __ge__
    return self._cmp_method(other, operator.ge)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\arrays\datetimelike.py", line 985, in _cmp_method
    return invalid_comparison(self, other, op)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jacky\anaconda3\envs\torch\Lib\site-packages\pandas\core\ops\invalid.py", line 40, in invalid_comparison
    raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
TypeError: Invalid comparison between dtype=datetime64[ns] and datetime

2025-03-09 16:44:50,707 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:44:50,708 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:44:50,720 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:49:56,916 - trading_system - INFO - Trading system initializing...
2025-03-09 16:49:56,924 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:49:56,924 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:49:56,924 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:49:56,924 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:49:56,927 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:49:56,928 - trading_system - INFO - Created local data source
2025-03-09 16:49:56,947 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:49:56,948 - trading_system - INFO - Binance interface initialized
2025-03-09 16:49:56,949 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:49:56,949 - trading_system - INFO - Created exchange data source
2025-03-09 16:49:56,950 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:49:56,951 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:49:57,407 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:49:57,408 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:49:57,408 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:49:57,411 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:49:57,411 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:50:00,346 - trading_system - INFO - Downloaded data up to 2023-02-11 23:00:00.001000
2025-03-09 16:50:01,029 - trading_system - INFO - Downloaded data up to 2023-03-25 16:00:00.001000
2025-03-09 16:50:01,832 - trading_system - INFO - Downloaded data up to 2023-05-06 08:00:00.001000
2025-03-09 16:50:02,472 - trading_system - INFO - Downloaded data up to 2023-06-17 00:00:00.001000
2025-03-09 16:50:03,173 - trading_system - INFO - Downloaded data up to 2023-07-28 16:00:00.001000
2025-03-09 16:50:03,915 - trading_system - INFO - Downloaded data up to 2023-09-08 08:00:00.001000
2025-03-09 16:50:04,618 - trading_system - INFO - Downloaded data up to 2023-10-20 00:00:00.001000
2025-03-09 16:50:05,307 - trading_system - INFO - Downloaded data up to 2023-11-30 16:00:00.001000
2025-03-09 16:50:05,982 - trading_system - ERROR - Failed to fetch historical data for BTC/USDT: Invalid comparison between dtype=datetime64[ns] and datetime
2025-03-09 16:50:05,983 - trading_system - WARNING - No data fetched for BTC/USDT 1h
2025-03-09 16:50:05,983 - trading_system - ERROR - 无法从交易所获取 BTC/USDT 1h 数据
2025-03-09 16:50:05,984 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 16:50:05,989 - trading_system - INFO - Initiating system shutdown...
2025-03-09 16:52:22,269 - trading_system - INFO - Trading system initializing...
2025-03-09 16:52:22,277 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 16:52:22,278 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 16:52:22,278 - trading_system - INFO - Starting trading pipeline...
2025-03-09 16:52:22,279 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 16:52:22,280 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 16:52:22,281 - trading_system - INFO - Created local data source
2025-03-09 16:52:22,297 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 16:52:22,298 - trading_system - INFO - Binance interface initialized
2025-03-09 16:52:22,298 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 16:52:22,299 - trading_system - INFO - Created exchange data source
2025-03-09 16:52:22,299 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 16:52:22,299 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 16:52:22,779 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 16:52:22,780 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 16:52:22,780 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 16:52:22,781 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 16:52:22,782 - trading_system - INFO - Fetching historical data for BTC/USDT (attempt 1/3)
2025-03-09 16:52:22,783 - trading_system - INFO - Split data request into 52 chunks
2025-03-09 16:52:22,783 - trading_system - INFO - Fetching chunk 1/52: 2023-01-01 00:00:00+00:00 to 2023-01-08 00:00:00+00:00
2025-03-09 16:52:43,852 - trading_system - ERROR - Error fetching chunk 1: binance GET https://api.binance.com/api/v3/exchangeInfo
2025-03-09 16:52:44,861 - trading_system - INFO - Fetching chunk 2/52: 2023-01-08 00:00:00+00:00 to 2023-01-15 00:00:00+00:00
2025-03-09 16:53:05,891 - trading_system - ERROR - Error fetching chunk 2: binance GET https://api.binance.com/api/v3/exchangeInfo
2025-03-09 16:53:06,904 - trading_system - INFO - Fetching chunk 3/52: 2023-01-15 00:00:00+00:00 to 2023-01-22 00:00:00+00:00
2025-03-09 17:01:53,852 - trading_system - INFO - Trading system initializing...
2025-03-09 17:01:53,866 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:01:53,866 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:01:53,866 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:01:53,868 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:01:53,871 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:01:53,871 - trading_system - INFO - Created local data source
2025-03-09 17:01:53,876 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'list'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 35, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 66, in _build_params
    api_key = self.config_manager.get(['api', 'binance', 'apiKey'])
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'list'

2025-03-09 17:01:53,877 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'list'
2025-03-09 17:01:53,878 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:01:54,346 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:01:54,346 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:01:54,353 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:05:09,634 - trading_system - INFO - Trading system initializing...
2025-03-09 17:05:09,651 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:05:09,652 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:05:09,652 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:05:09,653 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:05:09,655 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:05:09,655 - trading_system - INFO - Created local data source
2025-03-09 17:05:09,659 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 35, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 84, in _build_params
    proxies = self.config_manager.get('proxies', {})
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 17:05:09,660 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 17:05:09,661 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:05:10,200 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:05:10,200 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:05:10,206 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:05:28,927 - trading_system - INFO - Trading system initializing...
2025-03-09 17:05:28,937 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:05:28,937 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:05:28,938 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:05:28,938 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:05:28,940 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:05:28,940 - trading_system - INFO - Created local data source
2025-03-09 17:06:27,757 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'dict'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 35, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 84, in _build_params
    proxies = self.config_manager.get('proxies')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'dict'

2025-03-09 17:06:27,760 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'dict'
2025-03-09 17:06:27,761 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:06:28,225 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:06:28,225 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:06:28,231 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:06:33,743 - trading_system - INFO - Trading system initializing...
2025-03-09 17:06:33,752 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:06:33,752 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:06:33,754 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:06:33,755 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:06:33,755 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:06:33,756 - trading_system - INFO - Created local data source
2025-03-09 17:09:26,712 - trading_system - INFO - Trading system initializing...
2025-03-09 17:09:26,722 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:09:26,722 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:09:26,723 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:09:26,724 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:09:26,725 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:09:26,725 - trading_system - INFO - Created local data source
2025-03-09 17:09:35,955 - trading_system - ERROR - Failed to create exchange data source: unhashable type: 'list'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 43, in __init__
    self.rate_limit = self.config_manager.get(['api', 'rate_limit'], 1200)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\common\config_manager.py", line 302, in get
    if not isinstance(config, dict) or key not in config:
                                       ^^^^^^^^^^^^^^^^^
TypeError: unhashable type: 'list'

2025-03-09 17:09:35,956 - trading_system - WARNING - 无法创建备用交易所数据源: unhashable type: 'list'
2025-03-09 17:09:35,957 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:09:36,506 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:09:36,507 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:09:36,511 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:09:42,650 - trading_system - INFO - Trading system initializing...
2025-03-09 17:09:42,659 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:09:42,660 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:09:42,660 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:09:42,661 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:09:42,661 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:09:42,662 - trading_system - INFO - Created local data source
2025-03-09 17:10:38,076 - trading_system - INFO - Trading system initializing...
2025-03-09 17:10:38,085 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:10:38,085 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:10:38,086 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:10:38,086 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:10:38,088 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:10:38,088 - trading_system - INFO - Created local data source
2025-03-09 17:10:38,091 - trading_system - ERROR - Failed to create exchange data source: 'proxies'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 35, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 86, in _build_params
    params['proxies']['http'] = proxies['http']
    ~~~~~~^^^^^^^^^^^
KeyError: 'proxies'

2025-03-09 17:10:38,091 - trading_system - WARNING - 无法创建备用交易所数据源: 'proxies'
2025-03-09 17:10:38,091 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:10:38,542 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:10:38,543 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:10:38,548 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:15:40,825 - trading_system - INFO - Trading system initializing...
2025-03-09 17:15:40,833 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:15:40,834 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:15:40,834 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:15:40,835 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:15:40,836 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:15:40,837 - trading_system - INFO - Created local data source
2025-03-09 17:15:40,839 - trading_system - ERROR - Failed to create exchange data source: 'proxies'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 31, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 76, in _build_params
    params['proxies']['http'] = proxies['http']
    ~~~~~~^^^^^^^^^^^
KeyError: 'proxies'

2025-03-09 17:15:40,840 - trading_system - WARNING - 无法创建备用交易所数据源: 'proxies'
2025-03-09 17:15:40,840 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:15:41,302 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:15:41,303 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:15:41,308 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:16:13,423 - trading_system - INFO - Trading system initializing...
2025-03-09 17:16:13,431 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:16:13,431 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:16:13,432 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:16:13,432 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:16:13,434 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:16:13,434 - trading_system - INFO - Created local data source
2025-03-09 17:16:58,617 - trading_system - INFO - Trading system initializing...
2025-03-09 17:16:58,628 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:16:58,628 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:16:58,629 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:16:58,629 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:16:58,629 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:16:58,631 - trading_system - INFO - Created local data source
2025-03-09 17:16:58,633 - trading_system - ERROR - Failed to create exchange data source: 'proxies'
Traceback (most recent call last):
  File "D:\jacky\crypto_py\src\data\sources.py", line 450, in create_source
    source = sources[source_type](config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\data\sources.py", line 311, in __init__
    self.exchange = Binance(config)
                    ^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 31, in __init__
    self.params = self._build_params()
                  ^^^^^^^^^^^^^^^^^^^^
  File "D:\jacky\crypto_py\src\exchange\binance.py", line 73, in _build_params
    params['proxies']['http'] = self.config.get('proxies', 'http')
    ~~~~~~^^^^^^^^^^^
KeyError: 'proxies'

2025-03-09 17:16:58,634 - trading_system - WARNING - 无法创建备用交易所数据源: 'proxies'
2025-03-09 17:16:58,634 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:16:59,078 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:16:59,078 - trading_system - WARNING - 无法获取历史数据: BTC/USDT 1h 2023-01-01-2023-12-31
2025-03-09 17:16:59,083 - trading_system - INFO - Initiating system shutdown...
2025-03-09 17:18:23,996 - trading_system - INFO - Trading system initializing...
2025-03-09 17:18:24,004 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:18:24,005 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:18:24,005 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:18:24,006 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:18:24,007 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:18:24,008 - trading_system - INFO - Created local data source
2025-03-09 17:18:24,025 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 17:18:24,026 - trading_system - INFO - Binance interface initialized
2025-03-09 17:18:24,026 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 17:18:24,027 - trading_system - INFO - Created exchange data source
2025-03-09 17:18:24,027 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 17:18:24,028 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:18:24,489 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:18:24,490 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 17:18:24,490 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 17:18:24,492 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:18:24,492 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:18:45,573 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741511904493&recvWindow=60000&signature=5f1888fcf51632f6ed394f6e0d1a1945aa6bfcbe8a2e3c538e76700cf30bc5af
2025-03-09 17:19:08,652 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741511927584&recvWindow=60000&signature=f720f297bcffe14e2b00e3680026178eb600b63b76e231b373eb6644197978cc
2025-03-09 17:23:11,223 - trading_system - INFO - Trading system initializing...
2025-03-09 17:23:11,242 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:23:11,243 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:23:11,245 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:23:11,245 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:23:11,248 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:23:11,248 - trading_system - INFO - Created local data source
2025-03-09 17:23:11,273 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 17:23:11,274 - trading_system - INFO - Binance interface initialized
2025-03-09 17:23:11,275 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 17:23:11,276 - trading_system - INFO - Created exchange data source
2025-03-09 17:23:11,277 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 17:23:11,277 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:23:11,745 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:23:11,745 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 17:23:11,747 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 17:23:11,747 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:23:11,748 - trading_system - INFO - Fetching historical data for BTC/USDT (attempt 1/3)
2025-03-09 17:23:11,749 - trading_system - INFO - Split data request into 52 chunks
2025-03-09 17:23:11,749 - trading_system - INFO - Fetching chunk 1/52: 2023-01-01 00:00:00+00:00 to 2023-01-08 00:00:00+00:00
2025-03-09 17:23:32,824 - trading_system - ERROR - Error fetching chunk 1: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741512191750&recvWindow=60000&signature=806b475e94b6cb5b1a5f7fd423bae9ac4e7c1515e330bae0c3af3b92a9bf28fd
2025-03-09 17:23:33,829 - trading_system - INFO - Fetching chunk 2/52: 2023-01-08 00:00:00+00:00 to 2023-01-15 00:00:00+00:00
2025-03-09 17:24:40,930 - trading_system - INFO - Trading system initializing...
2025-03-09 17:24:40,938 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:24:40,939 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:24:40,939 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:24:40,940 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:24:40,941 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:24:40,941 - trading_system - INFO - Created local data source
2025-03-09 17:24:40,958 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 17:24:40,959 - trading_system - INFO - Binance interface initialized
2025-03-09 17:24:40,960 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 17:24:40,961 - trading_system - INFO - Created exchange data source
2025-03-09 17:24:40,961 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 17:24:40,962 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:24:41,410 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:24:41,411 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 17:24:41,412 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 17:24:41,413 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:24:41,413 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:25:02,485 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741512281414&recvWindow=60000&signature=c2697d28a44ea9517b661de02da00a1ba2a0df3fce1705b06beab511ed769c76
2025-03-09 17:27:11,417 - trading_system - INFO - Trading system initializing...
2025-03-09 17:27:11,425 - trading_system - INFO - Trading core initialized | Mode: backtest | Version: unknown
2025-03-09 17:27:11,426 - trading_system - INFO - Available trading modes: ['backtest', 'paper', 'live', 'custom_mode']
2025-03-09 17:27:11,426 - trading_system - INFO - Starting trading pipeline...
2025-03-09 17:27:11,427 - trading_system - INFO - Starting trading pipeline | Symbols: ['BTC/USDT'] | Timeframe: 1h
2025-03-09 17:27:11,428 - trading_system - INFO - LocalSource initialized, data path: db/historical/
2025-03-09 17:27:11,429 - trading_system - INFO - Created local data source
2025-03-09 17:27:11,445 - trading_system - INFO - CCXT Binance exchange initialized
2025-03-09 17:27:11,446 - trading_system - INFO - Binance interface initialized
2025-03-09 17:27:11,447 - trading_system - INFO - ExchangeSource initialized, max request rate: 20/minute
2025-03-09 17:27:11,448 - trading_system - INFO - Created exchange data source
2025-03-09 17:27:11,448 - trading_system - INFO - 创建了交易所备用数据源用于自动下载缺失数据
2025-03-09 17:27:11,449 - trading_system - INFO - DataManager初始化完成: 数据源=local, 缓存=True, 交易模式=BACKTEST
2025-03-09 17:27:11,904 - trading_system - WARNING - Local file not found or failed to load: BTC_USDT_1h
2025-03-09 17:27:11,904 - trading_system - WARNING - 本地历史数据不存在或不完整: BTC/USDT 1h 2023-01-01-2023-12-31，尝试从交易所下载
2025-03-09 17:27:11,905 - trading_system - INFO - Fetching historical data from exchange: BTC/USDT 1h 2023-01-01 - 2023-12-31
2025-03-09 17:27:11,906 - trading_system - INFO - Using smart fetch for BTC/USDT 1h from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:27:11,906 - trading_system - INFO - Fetching historical data for BTC/USDT from 2023-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00
2025-03-09 17:27:32,971 - trading_system - ERROR - Error fetching historical chunk: binance GET https://api.binance.com/sapi/v1/capital/config/getall?timestamp=1741512431907&recvWindow=60000&signature=4bc9099917b695ffd98d3775d3c06a7a4f2b10de4606bdec57e5fdf9773cb396
